"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[870],{1870:(yl,xe,u)=>{u.r(xe),u.d(xe,{AddManualPaymentDialogComponent:()=>J,CancelOrderDialogComponent:()=>z,CouponCodeSelectorComponent:()=>P,DraftOrderDetailComponent:()=>K,DraftOrderVariantSelectorComponent:()=>Z,FulfillOrderDialogComponent:()=>ee,FulfillmentCardComponent:()=>ne,FulfillmentDetailComponent:()=>Y,FulfillmentStateLabelComponent:()=>te,GET_COUPON_CODE_SELECTOR_PROMOTION_LIST:()=>_l,GET_CUSTOMER_ADDRESSES:()=>bl,GET_ORDER_STATE:()=>Ne,GET_SELLER_ORDERS:()=>we,LineFulfillmentComponent:()=>N,LineRefundsComponent:()=>R,ModificationDetailComponent:()=>re,NODE_HEIGHT:()=>Te,ORDER_DETAIL_QUERY:()=>hl,OrderCustomFieldsCardComponent:()=>Q,OrderDataTableComponent:()=>A,OrderDetailComponent:()=>fe,OrderEditResultType:()=>y,OrderEditorComponent:()=>he,OrderEditsPreviewDialogComponent:()=>_e,OrderGuard:()=>C,OrderHistoryComponent:()=>ue,OrderHistoryEntryHostComponent:()=>me,OrderListComponent:()=>ve,OrderModificationSummaryComponent:()=>B,OrderModule:()=>q,OrderPaymentCardComponent:()=>pe,OrderProcessEdgeComponent:()=>oe,OrderProcessGraphComponent:()=>ie,OrderProcessGraphDialogComponent:()=>ae,OrderProcessNodeComponent:()=>L,OrderStateSelectDialogComponent:()=>W,OrderTableComponent:()=>M,OrderTotalColumnComponent:()=>S,OrderTransitionService:()=>x,PaymentDetailComponent:()=>X,PaymentForRefundSelectorComponent:()=>V,PaymentStateLabelComponent:()=>se,RefundDetailComponent:()=>be,RefundOrderDialogComponent:()=>le,RefundStateLabelComponent:()=>ce,SET_ORDER_CUSTOMER_MUTATION:()=>vl,SelectAddressDialogComponent:()=>j,SelectCustomerDialogComponent:()=>E,SelectShippingMethodDialogComponent:()=>w,SellerOrdersCardComponent:()=>ge,SettleRefundDialogComponent:()=>de,SimpleItemListComponent:()=>k,createRoutes:()=>Ae,getRefundablePayments:()=>Ie});var d=u(6944),_=u(2067),e=u(5703),a=u(1644),O=u(1614),I=u(9015),s=u(6884),g=u(7244),p=u(405),m=u(1533),G=u(3995),Oe=u(487),h=u(4982),T=u(1750),Ye=u(3737),ye=u(5259),Le=u(4303),Ce=u(3889),Re=u(2727),f=u(2201),v=u(7589),Se=u(4383),U=u(2874),Me=u(3320),Ve=u(5099),Xe=u(5761),ke=u(6301);var qe=u(6832),F=u(8636),De=u(8564),Ge=u(3082),Ue=u(5835),He=u(7439),b=u(6088),$e=u(5976),Je=u(3711),ze=u(611),We=u(5287);function Qe(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.add-payment-to-order"))}function Ze(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",7),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",8),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submit())}),e.EFF(4),e.nI1(5,"translate"),e.nI1(6,"localeCurrency"),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,4,"common.cancel")),e.R7$(2),e.Y8G("disabled",t.form.invalid||t.form.pristine),e.R7$(),e.Lme(" ",e.bMT(5,6,"order.add-payment")," (",e.i5U(6,8,t.outstandingAmount,t.currencyCode),") ")}}function Ke(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.cancel-order"))}function et(r,n){if(1&r){const t=e.RV6();e.j41(0,"input",19),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$implicit,c=e.XpG();return e.DH7(c.lineQuantities[l.id],i)||(c.lineQuantities[l.id]=i),e.Njj(i)}),e.bIt("input",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.checkIfAllSelected())}),e.k0s()}if(2&r){const t=e.XpG().$implicit,o=e.XpG();e.R50("ngModel",o.lineQuantities[t.id]),e.Y8G("disabled",o.cancelAll)("max",t.quantity)}}function tt(r,n){if(1&r&&e.EFF(0),2&r){const t=e.XpG().$implicit;e.JRh(t.quantity)}}function nt(r,n){if(1&r&&(e.j41(0,"tr",11)(1,"td",12),e.nrm(2,"img",13),e.nI1(3,"assetPreview"),e.k0s(),e.j41(4,"td",14),e.EFF(5),e.k0s(),e.j41(6,"td",15),e.EFF(7),e.k0s(),e.j41(8,"td",16),e.EFF(9),e.k0s(),e.j41(10,"td",16),e.EFF(11),e.nI1(12,"localeCurrency"),e.k0s(),e.j41(13,"td",17),e.DNE(14,et,1,3,"input",18)(15,tt,1,1,"ng-template",null,0,e.C5r),e.k0s()()),2&r){const t=n.$implicit,o=e.sdS(16),i=e.XpG();e.AVh("is-disabled",i.cancelAll)("is-cancelled",0===t.quantity),e.R7$(2),e.Y8G("src",e.i5U(3,11,t.featuredAsset,"tiny"),e.B4B),e.R7$(3),e.JRh(t.productVariant.name),e.R7$(2),e.JRh(t.productVariant.sku),e.R7$(2),e.JRh(t.quantity),e.R7$(2),e.SpI(" ",e.i5U(12,14,t.unitPriceWithTax,i.order.currencyCode)," "),e.R7$(3),e.Y8G("ngIf",t.quantity>0&&!i.order.active)("ngIfElse",o)}}function rt(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"clr-radio-wrapper")(2,"input",20),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.cancelAll,i)||(l.cancelAll=i),e.Njj(i)}),e.bIt("ngModelChange",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.radioChanged())}),e.k0s(),e.j41(3,"label"),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.j41(6,"clr-radio-wrapper")(7,"input",20),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.cancelAll,i)||(l.cancelAll=i),e.Njj(i)}),e.bIt("ngModelChange",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.radioChanged())}),e.k0s(),e.j41(8,"label"),e.EFF(9),e.nI1(10,"translate"),e.k0s()(),e.bVm()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("value",!0),e.R50("ngModel",t.cancelAll),e.R7$(2),e.JRh(e.bMT(5,6,"order.cancel-entire-order")),e.R7$(3),e.Y8G("value",!1),e.R50("ngModel",t.cancelAll),e.R7$(2),e.JRh(e.bMT(10,8,"order.cancel-specified-items"))}}function ot(r,n){1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.bVm()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.cancel-selected-items")," "))}function it(r,n){1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.bVm()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.cancel-order")," "))}function at(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",22),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.DNE(4,ot,3,3,"ng-container",7)(5,it,3,3,"ng-container",7),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,4,"common.cancel")),e.R7$(2),e.Y8G("disabled",!t.reason||!t.order.active&&0===t.selectionCount),e.R7$(),e.Y8G("ngIf",!t.order.active),e.R7$(),e.Y8G("ngIf",t.order.active)}}function lt(r,n){if(1&r&&(e.j41(0,"div",2)(1,"vdr-chip",3),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&r){const t=n.item;e.R7$(2),e.JRh(t.code),e.R7$(2),e.JRh(t.promotionName)}}function dt(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.select-address"))}function st(r,n){if(1&r&&(e.j41(0,"vdr-radio-card",7),e.nrm(1,"vdr-formatted-address",8),e.k0s()),2&r){const t=n.$implicit;e.Y8G("item",t),e.R7$(),e.Y8G("address",t)}}function ct(r,n){if(1&r){const t=e.RV6();e.j41(0,"clr-tab-content")(1,"vdr-radio-card-fieldset",5),e.bIt("selectItem",function(i){e.eBV(t);const l=e.XpG(3);return e.Njj(l.selectedAddress=i)}),e.DNE(2,st,2,2,"vdr-radio-card",6),e.k0s()()}if(2&r){const t=e.XpG(2).ngIf,o=e.XpG();e.R7$(),e.Y8G("idFn",o.addressIdFn)("selectedItemId",o.selectedAddress&&o.addressIdFn(o.selectedAddress)),e.R7$(),e.Y8G("ngForOf",t)}}function pt(r,n){if(1&r){const t=e.RV6();e.j41(0,"clr-tab")(1,"button",3),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,ct,3,3,"ng-template",4),e.mxI("clrIfActiveChange",function(i){e.eBV(t);const l=e.XpG(2);return e.DH7(l.useExisting,i)||(l.useExisting=i),e.Njj(i)}),e.k0s()}if(2&r){const t=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,2,"order.existing-address")),e.R7$(2),e.R50("clrIfActive",t.useExisting)}}function mt(r,n){if(1&r&&(e.j41(0,"clr-tab-content"),e.nrm(1,"vdr-address-form",9),e.nI1(2,"async"),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("formGroup",t.addressForm)("availableCountries",e.bMT(2,2,t.availableCountries$))}}function ut(r,n){if(1&r){const t=e.RV6();e.j41(0,"clr-tabs"),e.DNE(1,pt,5,4,"clr-tab",1),e.j41(2,"clr-tab")(3,"button",3),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.DNE(6,mt,3,4,"ng-template",4),e.mxI("clrIfActiveChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.createNew,i)||(l.createNew=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=n.ngIf,o=e.XpG();e.R7$(),e.Y8G("ngIf",o.customerId&&t.length),e.R7$(3),e.JRh(e.bMT(5,3,"customer.create-new-address")),e.R7$(2),e.R50("clrIfActive",o.createNew)}}function gt(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.EFF(4),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,3,"common.cancel")),e.R7$(2),e.Y8G("disabled",t.useExisting&&!t.selectedAddress||t.createNew&&t.addressForm.invalid),e.R7$(),e.SpI(" ",e.bMT(5,5,"common.okay")," ")}}function ft(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r){const t=e.XpG();e.JRh(e.bMT(1,1,t.title))}}function _t(r,n){1&r&&e.eu8(0)}function ht(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-form-field",7),e.nI1(1,"translate"),e.j41(2,"textarea",8),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG(2);return e.DH7(l.note,i)||(l.note=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.Y8G("label",e.bMT(1,2,"common.add-note")),e.R7$(2),e.R50("ngModel",t.note)}}function vt(r,n){if(1&r&&(e.qex(0),e.DNE(1,_t,1,0,"ng-container",5)(2,ht,3,4,"vdr-form-field",6),e.bVm()),2&r){const t=e.XpG(),o=e.sdS(4);e.R7$(),e.Y8G("ngTemplateOutlet",o),e.R7$(),e.Y8G("ngIf",t.includeNoteInput)}}function bt(r,n){1&r&&e.eu8(0)}function yt(r,n){if(1&r&&(e.j41(0,"clr-tab-content")(1,"div",12),e.DNE(2,bt,1,0,"ng-container",5),e.k0s()()),2&r){e.XpG(2);const t=e.sdS(4);e.R7$(2),e.Y8G("ngTemplateOutlet",t)}}function Ct(r,n){if(1&r&&(e.j41(0,"clr-tab-content")(1,"form",13)(2,"vdr-form-field",14),e.nI1(3,"translate"),e.nrm(4,"input",15),e.k0s(),e.j41(5,"vdr-form-field",16),e.nI1(6,"translate"),e.nrm(7,"input",17),e.k0s(),e.j41(8,"vdr-form-field",18),e.nI1(9,"translate"),e.nrm(10,"input",19),e.k0s(),e.j41(11,"vdr-form-field",20),e.nI1(12,"translate"),e.nrm(13,"input",21),e.k0s(),e.j41(14,"vdr-form-field",22),e.nI1(15,"translate"),e.nrm(16,"input",23),e.k0s()()()),2&r){const t=e.XpG(3);e.R7$(),e.Y8G("formGroup",t.customerForm),e.R7$(),e.Y8G("label",e.bMT(3,6,"customer.title")),e.R7$(3),e.Y8G("label",e.bMT(6,8,"customer.first-name")),e.R7$(3),e.Y8G("label",e.bMT(9,10,"customer.last-name")),e.R7$(3),e.Y8G("label",e.bMT(12,12,"customer.email-address")),e.R7$(3),e.Y8G("label",e.bMT(15,14,"customer.phone-number"))}}function It(r,n){if(1&r){const t=e.RV6();e.j41(0,"clr-tab")(1,"button",10),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,Ct,17,16,"ng-template",11),e.mxI("clrIfActiveChange",function(i){e.eBV(t);const l=e.XpG(2);return e.DH7(l.createNew,i)||(l.createNew=i),e.Njj(i)}),e.k0s()}if(2&r){const t=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,2,"customer.create-new-customer")),e.R7$(2),e.R50("clrIfActive",t.createNew)}}function Tt(r,n){if(1&r){const t=e.RV6();e.j41(0,"clr-tabs",9)(1,"clr-tab")(2,"button",10),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.DNE(5,yt,3,1,"ng-template",11),e.mxI("clrIfActiveChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.useExisting,i)||(l.useExisting=i),e.Njj(i)}),e.k0s(),e.DNE(6,It,5,4,"clr-tab",2),e.k0s()}if(2&r){const t=e.XpG();e.R7$(3),e.JRh(e.bMT(4,3,"order.existing-customer")),e.R7$(2),e.R50("clrIfActive",t.useExisting),e.R7$(),e.Y8G("ngIf",t.canCreateNew)}}function Ft(r,n){if(1&r&&(e.j41(0,"span",27),e.nrm(1,"clr-icon",28),e.j41(2,"span",29),e.EFF(3),e.k0s(),e.j41(4,"vdr-chip"),e.EFF(5),e.k0s()()),2&r){const t=n.item;e.R7$(3),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(2),e.JRh(t.emailAddress)}}function xt(r,n){if(1&r&&(e.j41(0,"span",27),e.nrm(1,"clr-icon",28),e.j41(2,"span",29),e.EFF(3),e.k0s(),e.j41(4,"vdr-chip"),e.EFF(5),e.k0s()()),2&r){const t=n.item;e.R7$(3),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(2),e.JRh(t.emailAddress)}}function Ot(r,n){if(1&r){const t=e.RV6();e.j41(0,"ng-select",24),e.nI1(1,"async"),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.selectedCustomer,i)||(l.selectedCustomer=i),e.Njj(i)}),e.DNE(2,Ft,6,3,"ng-template",25)(3,xt,6,3,"ng-template",26),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("items",e.bMT(1,9,t.customers$))("addTag",!1)("multiple",!0)("hideSelected",!0)("trackByFn",t.trackByFn)("minTermLength",2)("loading",t.isLoading)("typeahead",t.input$),e.R50("ngModel",t.selectedCustomer)}}function Rt(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",30),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",31),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.EFF(4),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,3,"common.cancel")),e.R7$(2),e.Y8G("disabled",t.useExisting&&0===t.selectedCustomer.length||t.createNew&&t.customerForm.invalid),e.R7$(),e.SpI(" ",e.bMT(5,5,"common.okay")," ")}}function St(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.select-shipping-method"))}function Mt(r,n){if(1&r&&e.nrm(0,"vdr-object-tree",9),2&r){const t=e.XpG().$implicit;e.Y8G("value",t.metadata)}}function kt(r,n){if(1&r&&(e.j41(0,"vdr-radio-card",4)(1,"div",5)(2,"vdr-labeled-data",6),e.nI1(3,"translate"),e.EFF(4),e.k0s(),e.j41(5,"div",7)(6,"vdr-labeled-data",6),e.nI1(7,"translate"),e.EFF(8),e.nI1(9,"localeCurrency"),e.k0s(),e.j41(10,"vdr-labeled-data",6),e.nI1(11,"translate"),e.EFF(12),e.nI1(13,"localeCurrency"),e.k0s()(),e.DNE(14,Mt,1,1,"vdr-object-tree",8),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG();e.Y8G("item",t),e.R7$(2),e.Y8G("label",e.bMT(3,8,"settings.shipping-method")),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.Y8G("label",e.bMT(7,10,"common.price")),e.R7$(2),e.SpI(" ",e.i5U(9,12,t.price,o.currencyCode)," "),e.R7$(2),e.Y8G("label",e.bMT(11,15,"common.price-with-tax")),e.R7$(2),e.SpI(" ",e.i5U(13,17,t.priceWithTax,o.currencyCode)," "),e.R7$(2),e.Y8G("ngIf",t.metadata)}}function Dt(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.EFF(4),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,3,"common.cancel")),e.R7$(2),e.Y8G("disabled",!t.selectedMethod),e.R7$(),e.SpI(" ",e.bMT(5,5,"common.okay")," ")}}const H=r=>({state:r});function Gt(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.select-state"))}function $t(r,n){if(1&r&&(e.j41(0,"option",4),e.EFF(1),e.nI1(2,"stateI18nToken"),e.nI1(3,"translate"),e.k0s()),2&r){const t=n.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",e.bMT(3,4,e.bMT(2,2,t))," ")}}function Pt(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",7),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"common.cancel")," "))}function jt(r,n){if(1&r){const t=e.RV6();e.DNE(0,Pt,3,3,"button",5),e.j41(1,"button",6),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.EFF(2),e.nI1(3,"stateI18nToken"),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("ngIf",t.cancellable),e.R7$(),e.Y8G("disabled",!t.selectedState),e.R7$(),e.SpI(" ",e.i5U(5,7,"order.transition-to-state",e.eq3(10,H,e.bMT(4,5,e.bMT(3,3,t.selectedState))))," ")}}function Et(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.editable=!0)}),e.nrm(1,"clr-icon",10),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"common.edit")," "))}function wt(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onUpdateClick())}),e.nrm(1,"clr-icon",12),e.EFF(2),e.nI1(3,"translate"),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("disabled",t.customFieldForm.pristine||t.customFieldForm.invalid),e.R7$(2),e.SpI(" ",e.bMT(3,2,"common.update")," ")}}function Nt(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onCancelClick())}),e.nrm(1,"clr-icon",13),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"common.cancel")," "))}function At(r,n){if(1&r&&(e.j41(0,"div",1)(1,"div",2),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",3)(5,"div",4),e.nrm(6,"vdr-tabbed-custom-fields",5),e.k0s()(),e.j41(7,"div",6),e.DNE(8,Et,4,3,"button",7)(9,wt,4,4,"button",8)(10,Nt,4,3,"button",7),e.k0s()()),2&r){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,10,"common.custom-fields")," "),e.R7$(3),e.AVh("editable",t.editable),e.R7$(),e.Y8G("customFields",t.customFieldsConfig)("customFieldsFormGroup",t.customFieldForm)("readonly",!t.editable)("compact",!0),e.R7$(2),e.Y8G("ngIf",!t.editable),e.R7$(),e.Y8G("ngIf",t.editable),e.R7$(),e.Y8G("ngIf",t.editable)}}const Yt=(r,n)=>({total:r,count:n}),$=r=>({count:r});function Lt(r,n){1&r&&e.nrm(0,"clr-icon",9)}function Vt(r,n){1&r&&e.nrm(0,"clr-icon",10)}function Xt(r,n){1&r&&e.nrm(0,"clr-icon",11)}function Bt(r,n){1&r&&(e.j41(0,"label",12),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.line-fulfillment-all")," "))}function qt(r,n){if(1&r&&(e.j41(0,"label",12),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",e.i5U(2,1,"order.line-fulfillment-partial",e.l_i(4,Yt,t.line.quantity,t.fulfilledCount))," ")}}function Ut(r,n){1&r&&(e.j41(0,"label",12),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.line-fulfillment-none")," "))}function Ht(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",15),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG().$implicit;e.Y8G("label",e.bMT(1,2,"order.tracking-code")),e.R7$(2),e.SpI(" ",t.fulfillment.trackingCode," ")}}function Jt(r,n){if(1&r&&(e.j41(0,"div",13)(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.nI1(4,"translate"),e.k0s(),e.j41(5,"vdr-labeled-data",15),e.nI1(6,"translate"),e.EFF(7),e.nI1(8,"localeDate"),e.k0s(),e.j41(9,"vdr-labeled-data",15),e.nI1(10,"translate"),e.EFF(11),e.k0s(),e.DNE(12,Ht,3,4,"vdr-labeled-data",16),e.k0s()),2&r){const t=n.$implicit;e.R7$(2),e.E5c(" ",e.bMT(3,8,"order.fulfillment")," #",t.fulfillment.id," (",e.i5U(4,10,"order.item-count",e.eq3(20,$,t.count)),") "),e.R7$(3),e.Y8G("label",e.bMT(6,13,"common.created-at")),e.R7$(2),e.SpI(" ",e.i5U(8,15,t.fulfillment.createdAt,"medium")," "),e.R7$(2),e.Y8G("label",e.bMT(10,18,"order.fulfillment-method")),e.R7$(2),e.SpI(" ",t.fulfillment.method," "),e.R7$(),e.Y8G("ngIf",t.fulfillment.trackingCode)}}function zt(r,n){if(1&r&&(e.j41(0,"vdr-dropdown",1)(1,"button",2),e.DNE(2,Lt,1,0,"clr-icon",3)(3,Vt,1,0,"clr-icon",4)(4,Xt,1,0,"clr-icon",5),e.k0s(),e.j41(5,"vdr-dropdown-menu",6),e.DNE(6,Bt,3,3,"label",7)(7,qt,3,7,"label",7)(8,Ut,3,3,"label",7)(9,Jt,13,22,"div",8),e.k0s()()),2&r){const t=e.XpG();e.R7$(2),e.Y8G("ngIf","full"===t.fulfillmentStatus),e.R7$(),e.Y8G("ngIf","partial"===t.fulfillmentStatus),e.R7$(),e.Y8G("ngIf","none"===t.fulfillmentStatus),e.R7$(2),e.Y8G("ngIf","full"===t.fulfillmentStatus),e.R7$(),e.Y8G("ngIf","partial"===t.fulfillmentStatus),e.R7$(),e.Y8G("ngIf","none"===t.fulfillmentStatus),e.R7$(),e.Y8G("ngForOf",t.fulfillments)}}function Wt(r,n){if(1&r&&(e.j41(0,"span",1),e.nI1(1,"translate"),e.nrm(2,"clr-icon",2),e.k0s()),2&r){const t=e.XpG();e.Y8G("title",e.i5U(1,1,"order.refunded-count",e.eq3(4,$,t.getRefundedCount())))}}const Qt=[[["vdr-bulk-action-menu"]]],Zt=["vdr-bulk-action-menu"],Kt=(r,n,t,o)=>({id:r,itemsPerPage:n,currentPage:t,totalItems:o}),en=r=>({rowItem:r}),tn=(r,n)=>({item:r,index:n});function nn(r,n){if(1&r){const t=e.RV6();e.j41(0,"th",19)(1,"input",20),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onToggleAllClick())}),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(),e.Y8G("checked",null==t.selectionManager?null:t.selectionManager.areAllCurrentItemsSelected())}}function rn(r,n){1&r&&e.nrm(0,"clr-icon",30)}function on(r,n){1&r&&e.nrm(0,"clr-icon",31)}function an(r,n){1&r&&e.nrm(0,"clr-icon",32)}function ln(r,n){if(1&r&&(e.j41(0,"div",33),e.EFF(1),e.k0s()),2&r){const t=e.XpG().ngIf;e.R7$(),e.JRh(t.sortOrder)}}function dn(r,n){if(1&r){const t=e.RV6();e.j41(0,"div",24)(1,"button",25),e.bIt("click",function(){const i=e.eBV(t).ngIf;return e.Njj(i.toggleSortOrder())}),e.DNE(2,rn,1,0,"clr-icon",26)(3,on,1,0,"clr-icon",27)(4,an,1,0,"clr-icon",28),e.k0s(),e.DNE(5,ln,2,1,"div",29),e.k0s()}if(2&r){const t=n.ngIf;e.R7$(),e.AVh("active",t.sortOrder),e.R7$(),e.Y8G("ngIf",!t.sortOrder),e.R7$(),e.Y8G("ngIf","ASC"===t.sortOrder),e.R7$(),e.Y8G("ngIf","DESC"===t.sortOrder),e.R7$(),e.Y8G("ngIf",t.sortOrder)}}function sn(r,n){if(1&r&&(e.j41(0,"th")(1,"div",21)(2,"vdr-ui-extension-point",22)(3,"span"),e.EFF(4),e.k0s()(),e.DNE(5,dn,6,6,"div",23),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG();e.AVh("expand",t.expand),e.R7$(),e.Y8G("ngClass",t.align),e.R7$(),e.Y8G("locationId",o.id)("metadata",t.id)("topPx",-6)("leftPx",-24),e.R7$(2),e.JRh(t.heading),e.R7$(),e.Y8G("ngIf",t.sort)}}function cn(r,n){1&r&&e.eu8(0)}function pn(r,n){1&r&&e.eu8(0)}function mn(r,n){if(1&r&&e.nrm(0,"vdr-data-table-filters",42),2&r){const t=n.$implicit,o=e.XpG(3);e.Y8G("filterWithValue",t)("filters",o.filters)}}function un(r,n){if(1&r&&e.nrm(0,"vdr-data-table-filters",43),2&r){const t=e.XpG(3);e.Y8G("filters",t.filters)}}function gn(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",39),e.DNE(2,mn,1,2,"vdr-data-table-filters",40)(3,un,1,1,"vdr-data-table-filters",41),e.k0s(),e.bVm()),2&r){const t=e.XpG(2);e.R7$(2),e.Y8G("ngForOf",t.filters.activeFilters),e.R7$(),e.Y8G("ngIf",t.filters.length)}}function fn(r,n){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"th",34)(2,"button",35),e.nI1(3,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleSearchFilterRow())}),e.nrm(4,"clr-icon",36),e.k0s(),e.j41(5,"div",37),e.DNE(6,cn,1,0,"ng-container",38)(7,pn,1,0,"ng-container",38)(8,gn,4,2,"ng-container",9),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(),e.AVh("active",t.showSearchFilterRow),e.BMQ("colspan",t.visibleSortedColumns.length+(t.selectionManager?2:1)),e.R7$(),e.AVh("active",t.showSearchFilterRow),e.Y8G("title",e.bMT(3,11,"common.search-and-filter-list")),e.R7$(3),e.AVh("hidden",!t.showSearchFilterRow),e.R7$(),e.Y8G("ngTemplateOutlet",null==t.searchComponent?null:t.searchComponent.template),e.R7$(),e.Y8G("ngTemplateOutlet",t.customSearchTemplate),e.R7$(),e.Y8G("ngIf",t.filters)}}function _n(r,n){if(1&r){const t=e.RV6();e.j41(0,"td",19)(1,"input",46),e.bIt("click",function(i){e.eBV(t);const l=e.XpG().$implicit,c=e.XpG();return e.Njj(c.onRowClick(l,i))}),e.k0s()()}if(2&r){const t=e.XpG(),o=t.$implicit,i=t.index,l=e.XpG();e.AVh("active",l.activeIndex===i),e.R7$(),e.Y8G("checked",null==l.selectionManager?null:l.selectionManager.isSelected(o))}}function hn(r,n){1&r&&e.eu8(0)}function vn(r,n){if(1&r&&(e.qex(0),e.DNE(1,hn,1,0,"ng-container",48),e.bVm()),2&r){const t=n.ngIf,o=e.XpG(2).$implicit;e.R7$(),e.Y8G("ngComponentOutlet",t.config.component)("ngComponentOutletInputs",e.eq3(3,en,o))("ngComponentOutletInjector",t.injector)}}function bn(r,n){1&r&&e.eu8(0)}function yn(r,n){if(1&r&&e.DNE(0,bn,1,0,"ng-container",49),2&r){const t=e.XpG().$implicit,o=e.XpG(),i=o.$implicit,l=o.index;e.Y8G("ngTemplateOutlet",t.template)("ngTemplateOutletContext",e.l_i(2,tn,i,l))}}function Cn(r,n){if(1&r&&(e.j41(0,"td")(1,"div",21),e.DNE(2,vn,2,5,"ng-container",47)(3,yn,1,5,"ng-template",null,0,e.C5r),e.k0s()()),2&r){const t=n.$implicit,o=e.sdS(4),i=e.XpG().index,l=e.XpG();e.AVh("active",l.activeIndex===i),e.R7$(),e.Y8G("ngClass",t.align),e.R7$(),e.Y8G("ngIf",l.customComponents.get(t.id))("ngIfElse",o)}}function In(r,n){if(1&r&&(e.j41(0,"tr"),e.DNE(1,_n,2,3,"td",44)(2,Cn,5,5,"td",45),e.nrm(3,"td"),e.k0s()),2&r){const t=n.index,o=e.XpG();e.R7$(),e.Y8G("ngIf",o.selectionManager),e.R7$(),e.Y8G("ngForOf",o.visibleSortedColumns),e.R7$(),e.AVh("active",o.activeIndex===t)}}function Tn(r,n){if(1&r&&(e.j41(0,"tr")(1,"td"),e.nrm(2,"vdr-empty-placeholder",50),e.nI1(3,"translate"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.BMQ("colspan",t.visibleSortedColumns.length+(t.selectionManager?2:1)),e.R7$(),e.Y8G("emptyStateLabel",e.bMT(3,2,"order.order-is-empty"))}}function Fn(r,n){if(1&r&&(e.j41(0,"tr",51)(1,"td",52),e.EFF(2),e.k0s(),e.j41(3,"td",53),e.EFF(4),e.k0s(),e.nrm(5,"td",54),e.j41(6,"td",55),e.EFF(7),e.nI1(8,"localeCurrency"),e.j41(9,"div",15),e.nI1(10,"translate"),e.EFF(11),e.nI1(12,"localeCurrency"),e.k0s()(),e.nrm(13,"td"),e.k0s()),2&r){const t=n.$implicit,o=e.XpG();e.R7$(2),e.JRh(t.description),e.R7$(2),e.JRh(t.sku),e.R7$(),e.BMQ("colspan",o.visibleSortedColumns.length-4),e.R7$(2),e.SpI(" ",e.i5U(8,6,t.priceWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(10,9,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(12,11,t.price,o.order.currencyCode)," ")}}function xn(r,n){if(1&r&&(e.j41(0,"vdr-chip"),e.EFF(1),e.k0s()),2&r){const t=n.ngIf;e.R7$(),e.JRh(t)}}function On(r,n){if(1&r&&(e.j41(0,"tr",57)(1,"td",3)(2,"a",58),e.EFF(3),e.k0s(),e.DNE(4,xn,2,1,"vdr-chip",9),e.k0s(),e.j41(5,"td",3),e.EFF(6),e.nI1(7,"localeCurrency"),e.j41(8,"div",15),e.nI1(9,"translate"),e.EFF(10),e.nI1(11,"localeCurrency"),e.k0s()(),e.nrm(12,"td"),e.k0s()),2&r){const t=e.XpG().$implicit,o=e.XpG();e.R7$(),e.BMQ("colspan",o.visibleSortedColumns.length-1),e.R7$(),e.Y8G("routerLink",o.getPromotionLink(t)),e.R7$(),e.JRh(t.description),e.R7$(),e.Y8G("ngIf",o.getCouponCodeForAdjustment(o.order,t)),e.R7$(2),e.SpI(" ",e.i5U(7,7,t.amountWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(9,10,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(11,12,t.amount,o.order.currencyCode)," ")}}function Rn(r,n){if(1&r&&(e.qex(0),e.DNE(1,On,13,15,"tr",56),e.bVm()),2&r){const t=n.$implicit;e.R7$(),e.Y8G("ngIf","OTHER"!==t.type)}}function Sn(r,n){if(1&r&&(e.j41(0,"vdr-chip",59),e.EFF(1),e.k0s()),2&r){const t=n.$implicit;e.R7$(),e.SpI(" ",t.shippingMethod.name," ")}}function Mn(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.id," ")}}function kn(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.createdAt,"short")," ")}}function Dn(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.updatedAt,"short")," ")}}function Gn(r,n){if(1&r&&(e.nrm(0,"img",16),e.nI1(1,"assetPreview")),2&r){const t=n.ngIf;e.Y8G("src",e.i5U(1,1,t,"tiny"),e.B4B)}}function $n(r,n){1&r&&(e.j41(0,"div",17),e.nrm(1,"clr-icon",18),e.k0s())}function Pn(r,n){if(1&r&&(e.j41(0,"div",14),e.DNE(1,Gn,2,4,"img",15)(2,$n,2,0,"ng-template",null,0,e.C5r),e.k0s()),2&r){const t=n.item,o=e.sdS(3);e.R7$(),e.Y8G("ngIf",t.featuredAsset)("ngIfElse",o)}}function jn(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.productVariant.name," ")}}function En(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.productVariant.sku," ")}}function wn(r,n){if(1&r&&(e.j41(0,"div",19),e.EFF(1),e.nI1(2,"localeCurrency"),e.j41(3,"div",20),e.nI1(4,"translate"),e.EFF(5),e.nI1(6,"localeCurrency"),e.k0s()()),2&r){const t=n.item,o=e.XpG();e.R7$(),e.SpI(" ",e.i5U(2,3,t.unitPriceWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(4,6,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(6,8,t.unitPrice,o.order.currencyCode)," ")}}function Nn(r,n){if(1&r&&(e.j41(0,"div",26),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG(2).item;e.Y8G("title",e.bMT(1,2,"order.original-quantity-at-checkout")),e.R7$(2),e.SpI(" ",t.orderPlacedQuantity," ")}}function An(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",24),e.DNE(2,Nn,3,4,"div",25),e.j41(3,"div"),e.EFF(4),e.k0s()(),e.bVm()),2&r){const t=e.XpG().item;e.R7$(2),e.Y8G("ngIf",t.orderPlacedQuantity&&t.quantity!==t.orderPlacedQuantity),e.R7$(2),e.JRh(t.quantity)}}function Yn(r,n){if(1&r){const t=e.RV6();e.j41(0,"div",24)(1,"input",27,2),e.bIt("blur",function(){e.eBV(t);const i=e.sdS(2),l=e.XpG().item,c=e.XpG();return e.Njj(c.draftInputBlur(l,i.valueAsNumber))}),e.k0s(),e.j41(3,"button",28),e.bIt("click",function(){e.eBV(t);const i=e.XpG().item,l=e.XpG();return e.Njj(l.remove.emit({lineId:i.id}))}),e.nrm(4,"clr-icon",29),e.k0s()()}if(2&r){const t=e.XpG().item;e.R7$(),e.Y8G("value",t.quantity)}}function Ln(r,n){if(1&r&&(e.DNE(0,An,5,2,"ng-container",21)(1,Yn,5,1,"ng-template",null,1,e.C5r),e.nrm(3,"vdr-line-refunds",22)(4,"vdr-line-fulfillment",23)),2&r){const t=n.item,o=e.sdS(2),i=e.XpG();e.Y8G("ngIf",!i.isDraft)("ngIfElse",o),e.R7$(3),e.Y8G("line",t)("payments",i.order.payments),e.R7$(),e.Y8G("line",t)("orderState",i.order.state)("allOrderFulfillments",i.order.fulfillments)}}function Vn(r,n){if(1&r&&e.nrm(0,"vdr-dt2-custom-field-column",30),2&r){const t=n.$implicit;e.Y8G("customField",t)}}function Xn(r,n){if(1&r&&(e.j41(0,"div",34)(1,"a",35),e.EFF(2),e.k0s(),e.j41(3,"div",36),e.EFF(4),e.nI1(5,"localeCurrency"),e.j41(6,"div",20),e.nI1(7,"translate"),e.EFF(8),e.nI1(9,"localeCurrency"),e.k0s()()()),2&r){const t=n.$implicit,o=e.XpG(4);e.R7$(),e.Y8G("routerLink",o.getPromotionLink(t)),e.R7$(),e.JRh(t.description),e.R7$(2),e.SpI(" ",e.i5U(5,5,t.amountWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(7,8,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(9,10,t.amount,o.order.currencyCode)," ")}}function Bn(r,n){if(1&r&&(e.j41(0,"vdr-dropdown")(1,"div",32),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"vdr-dropdown-menu"),e.DNE(5,Xn,10,13,"div",33),e.k0s()()),2&r){const t=e.XpG().ngIf;e.R7$(2),e.SpI(" ",e.bMT(3,2,"order.promotions-applied")," "),e.R7$(3),e.Y8G("ngForOf",t)}}function qn(r,n){if(1&r&&(e.qex(0),e.DNE(1,Bn,6,4,"vdr-dropdown",31),e.bVm()),2&r){const t=n.ngIf;e.R7$(),e.Y8G("ngIf",t.length)}}function Un(r,n){if(1&r&&(e.j41(0,"div",19),e.EFF(1),e.nI1(2,"localeCurrency"),e.j41(3,"div",20),e.nI1(4,"translate"),e.EFF(5),e.nI1(6,"localeCurrency"),e.k0s()(),e.DNE(7,qn,2,1,"ng-container",31)),2&r){const t=n.item,o=e.XpG();e.R7$(),e.SpI(" ",e.i5U(2,4,t.linePriceWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(4,7,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(6,9,t.linePrice,o.order.currencyCode)," "),e.R7$(2),e.Y8G("ngIf",o.getLineDiscounts(t))}}function Hn(r,n){if(1&r&&(e.j41(0,"div",16),e.nrm(1,"vdr-custom-field-control",17),e.k0s()),2&r){const t=n.$implicit,o=e.XpG(3);e.R7$(),e.Y8G("compact",!0)("readonly",!1)("customField",t)("customFieldsFormGroup",o.customFieldsFormGroup)}}function Jn(r,n){if(1&r&&(e.qex(0),e.DNE(1,Hn,2,4,"div",15),e.bVm()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.orderLineCustomFields)}}function zn(r,n){if(1&r){const t=e.RV6();e.j41(0,"div",1)(1,"div",5),e.nrm(2,"img",6),e.nI1(3,"assetPreview"),e.j41(4,"div",7)(5,"div"),e.EFF(6),e.k0s(),e.j41(7,"div",8),e.EFF(8),e.k0s()(),e.j41(9,"div",9)(10,"div",8),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"div",8),e.EFF(14),e.nI1(15,"translate"),e.k0s()(),e.nrm(16,"div",10),e.j41(17,"div",7)(18,"div"),e.EFF(19),e.nI1(20,"localeCurrency"),e.k0s(),e.j41(21,"div",11),e.nI1(22,"translate"),e.EFF(23),e.nI1(24,"localeCurrency"),e.k0s()(),e.j41(25,"div")(26,"input",12),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.quantity,i)||(l.quantity=i),e.Njj(i)}),e.k0s()(),e.j41(27,"button",13),e.bIt("click",function(){const i=e.eBV(t).ngIf,l=e.XpG();return e.Njj(l.addItemClick(i))}),e.EFF(28),e.nI1(29,"translate"),e.k0s()(),e.DNE(30,Jn,2,1,"ng-container",14),e.k0s()}if(2&r){const t=n.ngIf,o=e.XpG();e.R7$(2),e.Y8G("src",e.i5U(3,15,t.featuredAsset||t.product.featuredAsset,32),e.B4B),e.R7$(4),e.JRh(null==t?null:t.name),e.R7$(2),e.JRh(null==t?null:t.sku),e.R7$(3),e.Lme(" ",e.bMT(12,18,"catalog.stock-on-hand"),": ",t.stockOnHand," "),e.R7$(3),e.Lme(" ",e.bMT(15,20,"catalog.stock-allocated"),": ",t.stockAllocated," "),e.R7$(5),e.JRh(e.i5U(20,22,null==t?null:t.priceWithTax,o.currencyCode)),e.R7$(2),e.Y8G("title",e.bMT(22,25,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(24,27,null==t?null:t.price,o.currencyCode)," "),e.R7$(3),e.Y8G("disabled",!t),e.R50("ngModel",o.quantity),e.R7$(),e.Y8G("disabled",!t),e.R7$(),e.SpI(" ",e.bMT(29,30,"order.add-item-to-order")," "),e.R7$(2),e.Y8G("ngIf",o.orderLineCustomFields.length)}}function Wn(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-action-bar")(1,"vdr-ab-left")(2,"div",1),e.nrm(3,"vdr-order-state-label",2),e.k0s()(),e.j41(4,"vdr-ab-right"),e.nrm(5,"vdr-action-bar-items",3),e.j41(6,"button",4),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.completeOrder())}),e.nrm(7,"clr-icon",5),e.EFF(8),e.nI1(9,"translate"),e.k0s(),e.j41(10,"vdr-action-bar-dropdown-menu",6)(11,"button",7),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.deleteOrder())}),e.nrm(12,"clr-icon",8),e.EFF(13),e.nI1(14,"translate"),e.k0s()()()()}if(2&r){const t=n.ngIf;e.R7$(3),e.Y8G("state",t.state),e.R7$(3),e.Y8G("disabled",!t.customer||!t.lines.length||!t.shippingLines.length),e.R7$(2),e.SpI(" ",e.bMT(9,5,"order.complete-draft-order")," "),e.R7$(2),e.Y8G("alwaysShow",!0),e.R7$(3),e.SpI(" ",e.bMT(14,7,"order.delete-draft-order")," ")}}function Qn(r,n){1&r&&e.nrm(0,"clr-icon",24)}function Zn(r,n){1&r&&e.nrm(0,"clr-icon",25)}function Kn(r,n){if(1&r&&e.DNE(0,Qn,1,0,"clr-icon",22)(1,Zn,1,0,"clr-icon",23),2&r){const t=e.XpG().ngIf;e.Y8G("ngIf",!t.customer),e.R7$(),e.Y8G("ngIf",t.customer)}}function er(r,n){if(1&r&&e.nrm(0,"vdr-customer-label",26),2&r){const t=e.XpG().ngIf;e.Y8G("customer",t.customer)}}function tr(r,n){1&r&&e.nrm(0,"clr-icon",24)}function nr(r,n){1&r&&e.nrm(0,"clr-icon",25)}function rr(r,n){if(1&r&&e.DNE(0,tr,1,0,"clr-icon",22)(1,nr,1,0,"clr-icon",23),2&r){const t=e.XpG().ngIf;e.Y8G("ngIf",!t.billingAddress.streetLine1),e.R7$(),e.Y8G("ngIf",t.billingAddress.streetLine1)}}function or(r,n){if(1&r&&e.nrm(0,"vdr-formatted-address",27),2&r){const t=e.XpG().ngIf;e.Y8G("address",t.billingAddress)}}function ir(r,n){1&r&&e.nrm(0,"clr-icon",24)}function ar(r,n){1&r&&e.nrm(0,"clr-icon",25)}function lr(r,n){if(1&r&&e.DNE(0,ir,1,0,"clr-icon",22)(1,ar,1,0,"clr-icon",23),2&r){const t=e.XpG().ngIf;e.Y8G("ngIf",!t.shippingAddress.streetLine1||!t.shippingLines.length),e.R7$(),e.Y8G("ngIf",t.shippingAddress.streetLine1&&t.shippingLines.length)}}function dr(r,n){if(1&r&&e.nrm(0,"vdr-formatted-address",27),2&r){const t=e.XpG().ngIf;e.Y8G("address",t.shippingAddress)}}function sr(r,n){if(1&r&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&r){const t=n.$implicit;e.R7$(),e.SpI(" ",t.shippingMethod.name," ")}}function cr(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.displayCouponCodeInput=!i.displayCouponCodeInput)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.set-coupon-codes")," "))}function pr(r,n){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"label"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"vdr-coupon-code-selector",28),e.bIt("addCouponCode",function(i){e.eBV(t);const l=e.XpG(2);return e.Njj(l.applyCouponCode(i))})("removeCouponCode",function(i){e.eBV(t);const l=e.XpG(2);return e.Njj(l.removeCouponCode(i))}),e.k0s()()}if(2&r){const t=e.XpG().ngIf;e.R7$(2),e.JRh(e.bMT(3,2,"order.set-coupon-codes")),e.R7$(2),e.Y8G("couponCodes",t.couponCodes)}}function mr(r,n){if(1&r&&e.nrm(0,"vdr-page-entity-info",29),2&r){const t=n.ngIf;e.Y8G("entity",t)}}function ur(r,n){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"percent"),e.k0s(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"localeCurrency"),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"localeCurrency"),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG(2).ngIf;e.R7$(2),e.JRh(t.description),e.R7$(2),e.JRh(e.bMT(5,4,t.taxRate/100)),e.R7$(3),e.JRh(e.i5U(8,6,t.taxBase,o.currencyCode)),e.R7$(3),e.JRh(e.i5U(11,9,t.taxTotal,o.currencyCode))}}function gr(r,n){if(1&r&&(e.qex(0),e.j41(1,"table",30)(2,"thead")(3,"tr")(4,"th"),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"th"),e.EFF(8),e.nI1(9,"translate"),e.k0s(),e.j41(10,"th"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"th"),e.EFF(14),e.nI1(15,"translate"),e.k0s()()(),e.j41(16,"tbody"),e.DNE(17,ur,12,12,"tr",15),e.k0s()(),e.bVm()),2&r){const t=e.XpG().ngIf;e.R7$(5),e.JRh(e.bMT(6,5,"common.description")),e.R7$(3),e.JRh(e.bMT(9,7,"order.tax-rate")),e.R7$(3),e.JRh(e.bMT(12,9,"order.tax-base")),e.R7$(3),e.JRh(e.bMT(15,11,"order.tax-total")),e.R7$(3),e.Y8G("ngForOf",t.taxSummary)}}function fr(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-page-detail-layout")(1,"vdr-page-detail-sidebar")(2,"vdr-card",9),e.nI1(3,"translate"),e.DNE(4,Kn,2,2,"ng-template",10)(5,er,1,1,"vdr-customer-label",11),e.j41(6,"button",12),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.setCustomer())}),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"vdr-card",9),e.nI1(10,"translate"),e.DNE(11,rr,2,2,"ng-template",10)(12,or,1,1,"vdr-formatted-address",13),e.j41(13,"button",12),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.setBillingAddress())}),e.EFF(14),e.nI1(15,"translate"),e.k0s()(),e.j41(16,"vdr-card",9),e.nI1(17,"translate"),e.DNE(18,lr,2,2,"ng-template",10)(19,dr,1,1,"vdr-formatted-address",13),e.j41(20,"button",14),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.setShippingAddress())}),e.EFF(21),e.nI1(22,"translate"),e.k0s(),e.DNE(23,sr,2,1,"div",15),e.j41(24,"button",12),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.setShippingMethod())}),e.EFF(25),e.nI1(26,"translate"),e.k0s()(),e.j41(27,"vdr-card"),e.DNE(28,cr,3,3,"button",16)(29,pr,5,4,"div",0),e.k0s(),e.j41(30,"vdr-card"),e.DNE(31,mr,1,1,"vdr-page-entity-info",17),e.nI1(32,"async"),e.k0s()(),e.j41(33,"vdr-page-block")(34,"vdr-card")(35,"vdr-draft-order-variant-selector",18),e.bIt("addItem",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.addItemToOrder(i))}),e.k0s(),e.j41(36,"vdr-order-table",19),e.bIt("adjust",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.adjustOrderLine(i))})("remove",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.removeOrderLine(i))}),e.k0s()(),e.j41(37,"vdr-card",9),e.nI1(38,"translate"),e.DNE(39,gr,18,13,"ng-container",0),e.k0s(),e.nrm(40,"vdr-custom-detail-component-host",20),e.j41(41,"vdr-order-custom-fields-card",21),e.bIt("updateClick",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.updateCustomFields(i))}),e.k0s()()()}if(2&r){const t=n.ngIf,o=e.XpG();e.R7$(2),e.Y8G("title",e.bMT(3,25,"order.customer")),e.R7$(3),e.Y8G("ngIf",t.customer),e.R7$(2),e.SpI(" ",e.bMT(8,27,"order.set-customer-for-order")," "),e.R7$(2),e.Y8G("title",e.bMT(10,29,"order.billing-address")),e.R7$(3),e.Y8G("ngIf",t.billingAddress),e.R7$(2),e.SpI(" ",e.bMT(15,31,"order.set-billing-address")," "),e.R7$(2),e.Y8G("title",e.bMT(17,33,"order.shipping")),e.R7$(3),e.Y8G("ngIf",t.shippingAddress),e.R7$(2),e.SpI(" ",e.bMT(22,35,"order.set-shipping-address")," "),e.R7$(2),e.Y8G("ngForOf",t.shippingLines),e.R7$(2),e.SpI(" ",e.bMT(26,37,"order.set-shipping-method")," "),e.R7$(3),e.Y8G("ngIf",0===t.couponCodes.length&&!o.displayCouponCodeInput),e.R7$(),e.Y8G("ngIf",t.couponCodes.length||o.displayCouponCodeInput),e.R7$(2),e.Y8G("ngIf",e.bMT(32,39,o.entity$)),e.R7$(4),e.Y8G("orderLineCustomFields",o.orderLineCustomFields)("currencyCode",t.currencyCode),e.R7$(),e.Y8G("order",t)("orderLineCustomFields",o.orderLineCustomFields)("isDraft",!0),e.R7$(),e.Y8G("title",e.bMT(38,41,"order.tax-summary")),e.R7$(2),e.Y8G("ngIf",t.taxSummary.length),e.R7$(),e.Y8G("entity$",o.entity$)("detailForm",o.detailForm),e.R7$(),e.Y8G("customFieldsConfig",o.customFields)("customFieldValues",t.customFields)}}function _r(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.fulfill-order"))}function hr(r,n){if(1&r&&(e.nrm(0,"img",17),e.nI1(1,"assetPreview")),2&r){const t=e.XpG().$implicit;e.Y8G("src",e.i5U(1,1,t.featuredAsset,"tiny"),e.B4B)}}function vr(r,n){if(1&r){const t=e.RV6();e.j41(0,"input",18),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$implicit,c=e.XpG();return e.DH7(c.fulfillmentQuantities[l.id].fulfillCount,i)||(c.fulfillmentQuantities[l.id].fulfillCount=i),e.Njj(i)}),e.k0s()}if(2&r){const t=e.XpG().$implicit,o=e.XpG();e.Y8G("disabled",0===o.getUnfulfilledCount(t)),e.R50("ngModel",o.fulfillmentQuantities[t.id].fulfillCount),e.Y8G("max",o.fulfillmentQuantities[t.id].max)}}function br(r,n){if(1&r&&(e.j41(0,"tr",9)(1,"td",10),e.DNE(2,hr,2,4,"img",11),e.k0s(),e.j41(3,"td",12),e.EFF(4),e.k0s(),e.j41(5,"td",13),e.EFF(6),e.k0s(),e.j41(7,"td",14),e.EFF(8),e.k0s(),e.j41(9,"td",14),e.EFF(10),e.k0s(),e.j41(11,"td",15),e.DNE(12,vr,1,3,"input",16),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG();e.AVh("ignore",0===o.getUnfulfilledCount(t)),e.R7$(2),e.Y8G("ngIf",t.featuredAsset),e.R7$(2),e.JRh(t.productVariant.name),e.R7$(2),e.JRh(t.productVariant.sku),e.R7$(2),e.JRh(o.getUnfulfilledCount(t)),e.R7$(2),e.JRh(t.productVariant.stockOnHand),e.R7$(2),e.Y8G("ngIf",o.fulfillmentQuantities[t.id])}}function yr(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",20),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.EFF(4),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,3,"common.cancel")),e.R7$(2),e.Y8G("disabled",!t.canSubmit()),e.R7$(),e.SpI(" ",e.bMT(5,5,"order.create-fulfillment")," ")}}function Cr(r,n){if(1&r&&(e.j41(0,"div",5),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.quantity)}}function Ir(r,n){1&r&&e.nrm(0,"clr-icon",6)}function Tr(r,n){if(1&r&&(e.j41(0,"li",2),e.DNE(1,Cr,2,1,"div",3)(2,Ir,1,0,"clr-icon",4),e.EFF(3),e.k0s()),2&r){const t=n.$implicit;e.Y8G("title",t.name),e.R7$(),e.Y8G("ngIf",null!=t.quantity),e.R7$(),e.Y8G("ngIf",null!=t.quantity),e.R7$(),e.SpI(" ",t.name," ")}}function Fr(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.tracking-code")),e.R7$(2),e.SpI(" ",null==t.fulfillment?null:t.fulfillment.trackingCode,"\n")}}function xr(r,n){if(1&r&&e.nrm(0,"vdr-custom-field-control",5),2&r){const t=e.XpG().$implicit,o=e.XpG();e.Y8G("readonly",!0)("compact",!0)("customField",t)("customFieldsFormGroup",o.customFieldFormGroup)}}function Or(r,n){if(1&r&&(e.qex(0),e.DNE(1,xr,1,4,"vdr-custom-field-control",4),e.bVm()),2&r){const t=n.$implicit,o=e.XpG();e.R7$(),e.Y8G("ngIf",o.customFieldFormGroup.get(t.name))}}function Rr(r,n){1&r&&e.nrm(0,"clr-icon",2)}function Sr(r,n){if(1&r&&e.nrm(0,"vdr-fulfillment-detail",8),2&r){const t=e.XpG();e.Y8G("fulfillmentId",null==t.fulfillment?null:t.fulfillment.id)("order",t.order)}}function Mr(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"button",15),e.bIt("click",function(){const i=e.eBV(t).ngIf,l=e.XpG(2);return e.Njj(l.transitionState.emit(i))}),e.EFF(2),e.nI1(3,"stateI18nToken"),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s(),e.bVm()}if(2&r){const t=n.ngIf;e.R7$(2),e.SpI(" ",e.i5U(5,5,"order.set-fulfillment-state",e.eq3(8,H,e.bMT(4,3,e.bMT(3,1,t))))," ")}}function kr(r,n){if(1&r&&(e.qex(0),e.nrm(1,"clr-icon",18),e.EFF(2),e.nI1(3,"stateI18nToken"),e.nI1(4,"translate"),e.nI1(5,"translate"),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" ",e.i5U(5,5,"order.transition-to-state",e.eq3(8,H,e.bMT(4,3,e.bMT(3,1,t))))," ")}}function Dr(r,n){1&r&&(e.nrm(0,"clr-icon",19),e.EFF(1),e.nI1(2,"translate")),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.cancel-fulfillment")," "))}function Gr(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"button",16),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.transitionState.emit(i))}),e.DNE(2,kr,6,10,"ng-container",17)(3,Dr,3,3,"ng-template",null,0,e.C5r),e.k0s(),e.bVm()}if(2&r){const t=n.$implicit,o=e.sdS(4);e.R7$(2),e.Y8G("ngIf","Cancelled"!==t)("ngIfElse",o)}}function $r(r,n){if(1&r&&(e.j41(0,"div",9),e.DNE(1,Mr,6,10,"ng-container",10),e.j41(2,"vdr-dropdown")(3,"button",11),e.nrm(4,"clr-icon",12),e.k0s(),e.j41(5,"vdr-dropdown-menu",13),e.DNE(6,Gr,5,2,"ng-container",14),e.k0s()()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.nextSuggestedState()),e.R7$(5),e.Y8G("ngForOf",t.nextOtherStates())}}function Pr(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.note")),e.R7$(2),e.JRh(t.modification.note)}}function jr(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.nI1(3,"localeCurrency"),e.k0s()),2&r){let t;const o=n.$implicit,i=e.XpG();e.Y8G("label",e.bMT(1,3,"order.surcharges")),e.R7$(2),e.Lme(" ",null==(t=i.getSurcharge(o.id))?null:t.description," ",e.i5U(3,5,null==(t=i.getSurcharge(o.id))?null:t.priceWithTax,i.order.currencyCode),"")}}function Er(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.nrm(2,"vdr-simple-item-list",3),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.added-items")),e.R7$(2),e.Y8G("items",t.getAddedItems())}}function wr(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.nrm(2,"vdr-simple-item-list",3),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.removed-items")),e.R7$(2),e.Y8G("items",t.getRemovedItems())}}function Nr(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.nrm(2,"vdr-simple-item-list",3),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.modified-items")),e.R7$(2),e.Y8G("items",t.getModifiedItems())}}function Ar(r,n){if(1&r&&(e.j41(0,"div",3),e.nrm(1,"div",4)(2,"clr-icon",5),e.j41(3,"div",6),e.EFF(4),e.nI1(5,"stateI18nToken"),e.nI1(6,"translate"),e.k0s()()),2&r){const t=e.XpG();e.R7$(4),e.SpI(" ",e.bMT(6,3,e.bMT(5,1,t.cancelledState))," ")}}function Yr(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"vdr-order-process-node",1),e.nI1(2,"async"),e.bIt("mouseenter",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.onMouseOver(i.name))})("mouseleave",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onMouseOut())}),e.k0s(),e.bVm()}if(2&r){const t=n.$implicit,o=n.index,i=e.XpG();e.R7$(),e.Y8G("node",t)("index",o)("active",e.bMT(2,3,i.activeState$)===t.name)}}function Lr(r,n){if(1&r&&(e.qex(0),e.nrm(1,"vdr-order-process-edge",2),e.bVm()),2&r){const t=n.$implicit;e.R7$(),e.Y8G("from",t.from)("to",t.to)("index",t.index)}}function Vr(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.order-state-diagram"))}function Xr(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-select-toggle",6),e.nI1(1,"translate"),e.nI1(2,"translate"),e.mxI("selectedChange",function(i){e.eBV(t);const l=e.XpG().$implicit;return e.DH7(l.selected,i)||(l.selected=i),e.Njj(i)}),e.bIt("selectedChange",function(i){e.eBV(t);const l=e.XpG().$implicit,c=e.XpG();return e.Njj(c.paymentSelected.emit({payment:l,selected:i}))}),e.k0s()}if(2&r){const t=e.XpG().$implicit,o=e.XpG();e.Y8G("title",e.bMT(1,4,"order.refund-this-payment"))("label",e.bMT(2,6,"order.refund-this-payment"))("disabled",1===o.refundablePayments.length),e.R50("selected",t.selected)}}function Br(r,n){if(1&r&&(e.j41(0,"vdr-card",1),e.nI1(1,"translate"),e.DNE(2,Xr,3,8,"ng-template",2),e.j41(3,"div",3)(4,"vdr-labeled-data",4),e.nI1(5,"translate"),e.EFF(6),e.k0s(),e.j41(7,"vdr-labeled-data",4),e.nI1(8,"translate"),e.EFF(9),e.k0s(),e.j41(10,"vdr-labeled-data",4),e.nI1(11,"translate"),e.EFF(12),e.nI1(13,"localeCurrency"),e.k0s(),e.j41(14,"vdr-labeled-data",4),e.nI1(15,"translate"),e.EFF(16),e.nI1(17,"localeCurrency"),e.k0s()(),e.j41(18,"vdr-form-field",4),e.nI1(19,"translate"),e.nrm(20,"vdr-currency-input",5),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG();e.AVh("selected",t.selected)("unselected",!t.selected),e.Y8G("title",e.bMT(1,17,"order.payment")),e.R7$(4),e.Y8G("label",e.bMT(5,19,"order.payment-method")),e.R7$(2),e.SpI(" ",t.method," "),e.R7$(),e.Y8G("label",e.bMT(8,21,"order.transaction-id")),e.R7$(2),e.SpI(" ",t.transactionId," "),e.R7$(),e.Y8G("label",e.bMT(11,23,"order.payment-amount")),e.R7$(2),e.SpI(" ",e.i5U(13,25,t.amount,o.order.currencyCode)," "),e.R7$(2),e.Y8G("label",e.bMT(15,28,"order.refundable-amount")),e.R7$(2),e.SpI(" ",e.i5U(17,30,t.refundableAmount,o.order.currencyCode)," "),e.R7$(2),e.Y8G("label",e.bMT(19,33,"order.refund-amount")),e.R7$(2),e.Y8G("readonly",!t.selected)("currencyCode",o.order.currencyCode)("formControl",t.amountToRefundControl)}}const qr=r=>({amount:r}),Ur=(r,n)=>({min:r,max:n});function Hr(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.refund-and-cancel-order"))}function Jr(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.id," ")}}function zr(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.createdAt,"short")," ")}}function Wr(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.updatedAt,"short")," ")}}function Qr(r,n){if(1&r&&(e.nrm(0,"img",26),e.nI1(1,"assetPreview")),2&r){const t=n.ngIf;e.Y8G("src",e.i5U(1,1,t,"tiny"),e.B4B)}}function Zr(r,n){1&r&&(e.j41(0,"div",27),e.nrm(1,"clr-icon",28),e.k0s())}function Kr(r,n){if(1&r&&(e.j41(0,"div",24),e.DNE(1,Qr,2,4,"img",25)(2,Zr,2,0,"ng-template",null,0,e.C5r),e.k0s()),2&r){const t=n.item,o=e.sdS(3);e.R7$(),e.Y8G("ngIf",t.featuredAsset)("ngIfElse",o)}}function eo(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.productVariant.name," ")}}function to(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.productVariant.sku," ")}}function no(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeCurrency")),2&r){const t=n.item,o=e.XpG();e.SpI(" ",e.i5U(1,1,t.unitPriceWithTax,o.order.currencyCode)," ")}}function ro(r,n){if(1&r&&(e.j41(0,"div",34),e.EFF(1),e.j41(2,"div",35),e.EFF(3),e.nI1(4,"number"),e.nI1(5,"currency"),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG(3).item,i=e.XpG();e.R7$(),e.SpI(" ",t.description," "),e.R7$(2),e.SpI(" ",e.i5U(5,5,e.i5U(4,2,t.amount/100/o.quantity,"1.0-2"),i.order.currencyCode)," ")}}function oo(r,n){if(1&r&&(e.j41(0,"vdr-dropdown")(1,"div",30)(2,"button",31),e.nrm(3,"clr-icon",32),e.k0s()(),e.j41(4,"vdr-dropdown-menu"),e.DNE(5,ro,6,8,"div",33),e.k0s()()),2&r){const t=e.XpG().ngIf;e.R7$(5),e.Y8G("ngForOf",t)}}function io(r,n){if(1&r&&(e.qex(0),e.DNE(1,oo,6,1,"vdr-dropdown",29),e.bVm()),2&r){const t=n.ngIf;e.R7$(),e.Y8G("ngIf",t.length)}}function ao(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeCurrency"),e.DNE(2,io,2,1,"ng-container",29)),2&r){const t=n.item,o=e.XpG();e.SpI(" ",e.i5U(1,2,t.unitPriceWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("ngIf",t.discounts)}}function lo(r,n){if(1&r&&(e.EFF(0),e.nrm(1,"vdr-line-refunds",36)),2&r){const t=n.item,o=e.XpG();e.SpI(" ",t.quantity," "),e.R7$(),e.Y8G("line",t)("payments",o.order.payments)}}function so(r,n){if(1&r){const t=e.RV6();e.j41(0,"input",38),e.bIt("ngModelChange",function(i){e.eBV(t);const l=e.XpG().item,c=e.XpG();return e.Njj(c.onRefundQuantityChange(l.id,i))}),e.k0s()}if(2&r){const t=e.XpG().item,o=e.XpG();e.Y8G("ngModel",o.lineQuantities[t.id].quantity)("max",t.quantity)}}function co(r,n){if(1&r&&e.DNE(0,so,1,2,"input",37),2&r){const t=n.item,o=e.XpG();e.Y8G("ngIf",o.lineCanBeRefundedOrCancelled(t))}}function po(r,n){if(1&r){const t=e.RV6();e.j41(0,"input",43),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG().item,c=e.XpG();return e.DH7(c.lineQuantities[l.id].cancel,i)||(c.lineQuantities[l.id].cancel=i),e.Njj(i)}),e.k0s()}if(2&r){const t=e.XpG().item,o=e.XpG();e.Y8G("disabled",0===o.lineQuantities[t.id].quantity),e.R50("ngModel",o.lineQuantities[t.id].cancel)}}function mo(r,n){if(1&r&&(e.j41(0,"div",39)(1,"label",40),e.DNE(2,po,1,2,"input",41),e.j41(3,"span",42),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()),2&r){const t=n.item,o=e.XpG();e.R7$(2),e.Y8G("ngIf",o.lineCanBeRefundedOrCancelled(t)),e.R7$(2),e.JRh(e.bMT(5,2,"order.return-to-stock"))}}function uo(r,n){if(1&r){const t=e.RV6();e.j41(0,"label",44)(1,"input",45),e.bIt("change",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.toggleShippingRefund(i.id))}),e.k0s(),e.j41(2,"div",42),e.EFF(3),e.nI1(4,"translate"),e.j41(5,"span"),e.EFF(6),e.k0s(),e.j41(7,"span",42),e.EFF(8),e.nI1(9,"localeCurrency"),e.k0s()()()}if(2&r){const t=n.$implicit,o=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,3,"order.refund-shipping")," "),e.R7$(3),e.SpI("",t.shippingMethod.name,":"),e.R7$(2),e.SpI("",e.i5U(9,5,t.discountedPriceWithTax,o.order.currencyCode)," ")}}function go(r,n){if(1&r&&(e.j41(0,"clr-alert",51)(1,"clr-alert-item"),e.EFF(2),e.nI1(3,"currency"),e.nI1(4,"localeCurrency"),e.nI1(5,"translate"),e.k0s()()),2&r){const t=e.XpG(2);e.Y8G("clrAlertType","danger")("clrAlertClosable",!1),e.R7$(2),e.SpI(" ",e.i5U(5,9,"order.refund-total-error",e.l_i(12,Ur,e.i5U(3,3,0,t.order.currencyCode),e.i5U(4,6,t.totalRefundableAmount,t.order.currencyCode)))," ")}}function fo(r,n){1&r&&(e.j41(0,"clr-alert",51)(1,"clr-alert-item"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.Y8G("clrAlertType","danger")("clrAlertClosable",!1),e.R7$(2),e.SpI(" ",e.bMT(3,3,"order.refund-total-warning")," "))}function _o(r,n){1&r&&(e.j41(0,"clr-alert",51)(1,"clr-alert-item"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.Y8G("clrAlertType","danger")("clrAlertClosable",!1),e.R7$(2),e.SpI(" ",e.bMT(3,3,"order.refund-cancellation-reason-required")," "))}function ho(r,n){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"div",46),e.DNE(2,go,6,15,"clr-alert",47)(3,fo,4,5,"clr-alert",47)(4,_o,4,5,"clr-alert",47),e.k0s(),e.j41(5,"div",48)(6,"button",49),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"button",50),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.select())}),e.EFF(10),e.nI1(11,"localeCurrency"),e.nI1(12,"translate"),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.refundTotal<0||t.totalRefundableAmount<t.refundTotal),e.R7$(),e.Y8G("ngIf",t.amountToRefundTotal<t.refundTotal||t.refundTotal<t.amountToRefundTotal),e.R7$(),e.Y8G("ngIf",t.amountToRefundTotal&&!t.reason),e.R7$(3),e.JRh(e.bMT(8,6,"common.cancel")),e.R7$(2),e.Y8G("disabled",!t.canSubmit()),e.R7$(),e.SpI(" ",e.i5U(12,11,"order.refund-with-amount",e.eq3(14,qr,e.i5U(11,8,t.amountToRefundTotal,t.order.currencyCode)))," ")}}const vo=r=>({method:r});function bo(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.settle-refund"))}function yo(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",4),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"button",5),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submit())}),e.EFF(4),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,3,"common.cancel")),e.R7$(2),e.Y8G("disabled",!t.transactionId),e.R7$(),e.SpI(" ",e.bMT(5,5,"order.settle-refund")," ")}}function Co(r,n){1&r&&e.nrm(0,"clr-icon",2)}function Io(r,n){1&r&&e.nrm(0,"clr-icon",2)}function To(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.error-message")),e.R7$(2),e.SpI(" ",t.payment.errorMessage,"\n")}}function Fo(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.transaction-id")),e.R7$(2),e.SpI(" ",t.payment.transactionId,"\n")}}function xo(r,n){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"localeCurrency"),e.bVm()),2&r){const t=e.XpG();e.R7$(),e.JRh(e.i5U(2,1,t.payment.amount,t.currencyCode))}}function Oo(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",14),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG().$implicit;e.Y8G("label",e.bMT(1,2,"order.transaction-id")),e.R7$(2),e.SpI(" ",t.transactionId," ")}}function Ro(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",14),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG().$implicit;e.Y8G("label",e.bMT(1,2,"order.refund-reason")),e.R7$(2),e.SpI(" ",t.reason," ")}}function So(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",14),e.nI1(1,"translate"),e.nrm(2,"vdr-object-tree",16),e.k0s()),2&r){const t=e.XpG().$implicit;e.Y8G("label",e.bMT(1,2,"order.refund-metadata")),e.R7$(2),e.Y8G("value",t.metadata)}}function Mo(r,n){if(1&r){const t=e.RV6();e.j41(0,"div",17)(1,"button",18),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG();return e.Njj(l.settleRefund.emit(i))}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"order.settle-refund")," "))}function ko(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",10)(2,"div",11),e.nrm(3,"clr-icon",12),e.EFF(4),e.nI1(5,"translate"),e.nrm(6,"div",13)(7,"vdr-refund-state-label",5),e.k0s(),e.j41(8,"div",6)(9,"vdr-labeled-data",14),e.nI1(10,"translate"),e.EFF(11),e.nI1(12,"localeDate"),e.k0s(),e.j41(13,"vdr-labeled-data",14),e.nI1(14,"translate"),e.EFF(15),e.nI1(16,"localeCurrency"),e.k0s(),e.DNE(17,Oo,3,4,"vdr-labeled-data",15)(18,Ro,3,4,"vdr-labeled-data",15)(19,So,3,4,"vdr-labeled-data",15),e.k0s(),e.DNE(20,Mo,4,3,"div",9),e.k0s(),e.bVm()),2&r){const t=n.$implicit,o=e.XpG();e.R7$(4),e.Lme(" ",e.bMT(5,11,"order.refund")," #",t.id," "),e.R7$(3),e.Y8G("state",t.state),e.R7$(2),e.Y8G("label",e.bMT(10,13,"common.created-at")),e.R7$(2),e.SpI(" ",e.i5U(12,15,t.createdAt,"medium")," "),e.R7$(2),e.Y8G("label",e.bMT(14,18,"order.refund-total")),e.R7$(2),e.SpI(" ",e.i5U(16,20,t.total,o.currencyCode)," "),e.R7$(2),e.Y8G("ngIf",t.transactionId),e.R7$(),e.Y8G("ngIf",t.reason),e.R7$(),e.Y8G("ngIf",o.refundHasMetadata(t)),e.R7$(),e.Y8G("ngIf","Pending"===t.state)}}function Do(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",18),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.settlePayment.emit(i.payment))}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.settle-payment")," "))}function Go(r,n){if(1&r&&(e.qex(0),e.nrm(1,"clr-icon",25),e.EFF(2),e.nI1(3,"stateI18nToken"),e.nI1(4,"translate"),e.nI1(5,"translate"),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" ",e.i5U(5,5,"order.transition-to-state",e.eq3(8,H,e.bMT(4,3,e.bMT(3,1,t))))," ")}}function $o(r,n){1&r&&(e.nrm(0,"clr-icon",26),e.EFF(1),e.nI1(2,"translate")),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.cancel-payment")," "))}function Po(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"button",23),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.transitionPaymentState.emit({payment:l.payment,state:i}))}),e.DNE(2,Go,6,10,"ng-container",24)(3,$o,3,3,"ng-template",null,0,e.C5r),e.k0s(),e.bVm()}if(2&r){const t=n.$implicit,o=e.sdS(4);e.R7$(2),e.Y8G("ngIf","Cancelled"!==t)("ngIfElse",o)}}function jo(r,n){if(1&r&&(e.j41(0,"div",17),e.DNE(1,Do,3,3,"button",19),e.j41(2,"vdr-dropdown")(3,"button",20),e.nrm(4,"clr-icon",21),e.k0s(),e.j41(5,"vdr-dropdown-menu",22),e.DNE(6,Po,5,2,"ng-container",8),e.k0s()()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.payment.nextStates.includes("Settled")),e.R7$(5),e.Y8G("ngForOf",t.nextOtherStates())}}const Eo=["portal"],Pe=(r,n)=>({from:r,to:n}),je=(r,n,t)=>({from:r,to:n,id:t}),wo=r=>["/marketing","promotions",r],No=r=>({newCustomerName:r}),Ee=r=>["/customer","customers",r];function Ao(r,n){1&r&&(e.j41(0,"span",15),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.note-only-visible-to-administrators")," "))}function Yo(r,n){1&r&&(e.j41(0,"span",16),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.note-visible-to-customer")," "))}function Lo(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-order-history-entry-host",18),e.bIt("expandClick",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.expanded=!i.expanded)}),e.k0s()}if(2&r){const t=e.XpG().$implicit,o=e.XpG();e.Y8G("order",o.order)("entry",t)("expanded",o.expanded)}}function Vo(r,n){1&r&&(e.j41(0,"div",14),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.history-order-fulfilled")," "))}function Xo(r,n){1&r&&(e.j41(0,"div",14),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.history-order-cancelled")," "))}function Bo(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r){const t=e.XpG(3).$implicit;e.SpI(" ",e.i5U(1,1,"order.history-order-transition",e.l_i(4,Pe,t.data.from,t.data.to))," ")}}function qo(r,n){if(1&r&&(e.qex(0),e.DNE(1,Vo,3,3,"div",23)(2,Xo,3,3,"div",23)(3,Bo,2,7,"ng-template",24),e.bVm()),2&r){const t=e.XpG(2).$implicit;e.R7$(),e.Y8G("ngIf","Delivered"===t.data.to),e.R7$(),e.Y8G("ngIf","Cancelled"===t.data.to),e.R7$(),e.Y8G("ngIf","Cancelled"!==t.data.to&&"Delivered"!==t.data.to)}}function Uo(r,n){1&r&&(e.j41(0,"vdr-chip",30),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"order.modification-settled")))}function Ho(r,n){1&r&&(e.j41(0,"vdr-chip",31),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"order.modification-not-settled")))}function Jo(r,n){if(1&r&&(e.j41(0,"div",26),e.EFF(1),e.nI1(2,"translate"),e.j41(3,"strong"),e.EFF(4),e.nI1(5,"localeCurrency"),e.k0s(),e.DNE(6,Uo,3,3,"vdr-chip",27)(7,Ho,3,3,"vdr-chip",28),e.j41(8,"vdr-history-entry-detail"),e.nrm(9,"vdr-modification-detail",29),e.k0s()()),2&r){const t=n.ngIf,o=e.XpG(4);e.R7$(),e.SpI(" ",e.bMT(2,6,"order.modify-order-price-difference"),": "),e.R7$(3),e.JRh(e.i5U(5,8,t.priceChange,o.order.currencyCode)),e.R7$(2),e.Y8G("ngIf",t.isSettled),e.R7$(),e.Y8G("ngIf",!t.isSettled),e.R7$(2),e.Y8G("order",o.order)("modification",t)}}function zo(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,Jo,10,11,"div",25),e.bVm()),2&r){const t=e.XpG(2).$implicit,o=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,2,"order.history-order-modified")," "),e.R7$(2),e.Y8G("ngIf",o.getModification(t.data.modificationId))}}function Wo(r,n){if(1&r&&(e.j41(0,"vdr-chip",35),e.EFF(1),e.nI1(2,"localeCurrency"),e.k0s()),2&r){const t=n.ngIf,o=e.XpG(5);e.R7$(),e.JRh(e.i5U(2,1,t.amount,o.order.currencyCode))}}function Qo(r,n){if(1&r&&(e.j41(0,"vdr-history-entry-detail"),e.nrm(1,"vdr-payment-detail",36),e.k0s()),2&r){const t=n.ngIf,o=e.XpG(5);e.R7$(),e.Y8G("payment",t)("currencyCode",o.order.currencyCode)}}function Zo(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",26),e.DNE(5,Wo,3,4,"vdr-chip",33)(6,Qo,2,2,"vdr-history-entry-detail",34),e.k0s(),e.bVm()),2&r){const t=e.XpG(3).$implicit,o=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,3,"order.history-payment-settled")," "),e.R7$(3),e.Y8G("ngIf",o.getPayment(t)),e.R7$(),e.Y8G("ngIf",o.getPayment(t))}}function Ko(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r){let t;const o=e.XpG(3).$implicit,i=e.XpG();e.SpI(" ",e.i5U(1,1,"order.history-payment-transition",e.sMw(4,je,o.data.from,o.data.to,null==(t=i.getPayment(o))?null:t.transactionId))," ")}}function ei(r,n){if(1&r&&(e.qex(0),e.DNE(1,Zo,7,5,"ng-container",32)(2,Ko,2,8,"ng-template",null,1,e.C5r),e.bVm()),2&r){const t=e.sdS(3),o=e.XpG(2).$implicit;e.R7$(),e.Y8G("ngIf","Settled"===o.data.to)("ngIfElse",t)}}function ti(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",26)(5,"vdr-chip",37),e.EFF(6),e.nI1(7,"localeCurrency"),e.k0s(),e.j41(8,"vdr-history-entry-detail")(9,"vdr-labeled-data",38),e.nI1(10,"translate"),e.EFF(11),e.k0s(),e.j41(12,"vdr-labeled-data",38),e.nI1(13,"translate"),e.nrm(14,"vdr-simple-item-list",39),e.k0s()()(),e.bVm()),2&r){const t=n.ngIf,o=e.XpG(4).$implicit,i=e.XpG();e.R7$(2),e.Lme("",e.bMT(3,7,"order.refund")," #",t.id,""),e.R7$(4),e.JRh(e.i5U(7,9,t.total,i.order.currencyCode)),e.R7$(3),e.Y8G("label",e.bMT(10,12,"order.cancellation-reason")),e.R7$(2),e.SpI(" ",o.data.reason," "),e.R7$(),e.Y8G("label",e.bMT(13,14,"order.contents")),e.R7$(2),e.Y8G("items",i.getCancelledItems(t.lines))}}function ni(r,n){if(1&r&&(e.qex(0),e.DNE(1,ti,15,16,"ng-container",34),e.bVm()),2&r){const t=e.XpG(3).$implicit,o=e.XpG();e.R7$(),e.Y8G("ngIf",o.getRefund(t))}}function ri(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r){const t=e.XpG(3).$implicit;e.SpI(" ",e.i5U(1,1,"order.history-refund-transition",e.sMw(4,je,t.data.from,t.data.to,t.data.refundId))," ")}}function oi(r,n){if(1&r&&(e.qex(0),e.DNE(1,ni,2,1,"ng-container",32)(2,ri,2,8,"ng-template",null,2,e.C5r),e.bVm()),2&r){const t=e.sdS(3),o=e.XpG(2).$implicit;e.R7$(),e.Y8G("ngIf","Settled"===o.data.to)("ngIfElse",t)}}function ii(r,n){if(1&r&&(e.j41(0,"vdr-history-entry-detail")(1,"vdr-labeled-data",38),e.nI1(2,"translate"),e.EFF(3),e.k0s(),e.j41(4,"vdr-labeled-data",38),e.nI1(5,"translate"),e.nrm(6,"vdr-simple-item-list",39),e.k0s(),e.j41(7,"vdr-labeled-data",38),e.nI1(8,"translate"),e.EFF(9),e.k0s()()),2&r){const t=n.ngIf,o=e.XpG(3).$implicit;e.R7$(),e.Y8G("label",e.bMT(2,6,"order.cancellation-reason")),e.R7$(2),e.SpI(" ",o.data.reason," "),e.R7$(),e.Y8G("label",e.bMT(5,8,"order.contents")),e.R7$(2),e.Y8G("items",t),e.R7$(),e.Y8G("label",e.bMT(8,10,"order.shipping-cancelled")),e.R7$(2),e.SpI(" ",o.data.shippingCancelled," ")}}function ai(r,n){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.DNE(3,ii,10,12,"vdr-history-entry-detail",34),e.bVm()),2&r){const t=e.XpG(2).$implicit,o=e.XpG();e.R7$(),e.SpI(" ",e.i5U(2,2,"order.history-items-cancelled",e.eq3(5,$,o.getCancelledQuantity(t)))," "),e.R7$(2),e.Y8G("ngIf",o.getCancelledItems(t.data.lines))}}function li(r,n){if(1&r&&(e.j41(0,"vdr-history-entry-detail"),e.nrm(1,"vdr-fulfillment-detail",40),e.k0s()),2&r){const t=n.ngIf,o=e.XpG(4);e.R7$(),e.Y8G("fulfillmentId",t.id)("order",o.order)}}function di(r,n){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.DNE(3,li,2,2,"vdr-history-entry-detail",34),e.bVm()),2&r){const t=e.XpG(2).$implicit,o=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,2,"order.history-fulfillment-created")," "),e.R7$(2),e.Y8G("ngIf",o.getFulfillment(t))}}function si(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.EFF(4),e.nI1(5,"translate"),e.bVm()),2&r){let t;const o=e.XpG(3).$implicit,i=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,3,"order.history-fulfillment-delivered")," "),e.R7$(2),e.Lme(" ",e.bMT(5,5,"order.tracking-code"),": ",null==(t=i.getFulfillment(o))?null:t.trackingCode," ")}}function ci(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.EFF(4),e.nI1(5,"translate"),e.bVm()),2&r){let t;const o=e.XpG(3).$implicit,i=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,3,"order.history-fulfillment-shipped")," "),e.R7$(2),e.Lme(" ",e.bMT(5,5,"order.tracking-code"),": ",null==(t=i.getFulfillment(o))?null:t.trackingCode," ")}}function pi(r,n){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.bVm()),2&r){const t=e.XpG(3).$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,"order.history-fulfillment-transition",e.l_i(4,Pe,t.data.from,t.data.to))," ")}}function mi(r,n){if(1&r&&(e.j41(0,"vdr-history-entry-detail"),e.nrm(1,"vdr-fulfillment-detail",40),e.k0s()),2&r){const t=n.ngIf,o=e.XpG(4);e.R7$(),e.Y8G("fulfillmentId",t.id)("order",o.order)}}function ui(r,n){if(1&r&&(e.qex(0),e.DNE(1,si,6,7,"ng-container",34)(2,ci,6,7,"ng-container",34)(3,pi,3,7,"ng-container",34)(4,mi,2,2,"vdr-history-entry-detail",34),e.bVm()),2&r){const t=e.XpG(2).$implicit,o=e.XpG();e.R7$(),e.Y8G("ngIf","Delivered"===t.data.to),e.R7$(),e.Y8G("ngIf","Shipped"===t.data.to),e.R7$(),e.Y8G("ngIf","Delivered"!==t.data.to&&"Shipped"!==t.data.to),e.R7$(),e.Y8G("ngIf",o.getFulfillment(t))}}function gi(r,n){1&r&&(e.j41(0,"span",53),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"common.public")))}function fi(r,n){1&r&&(e.j41(0,"span",54),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"common.private")))}function _i(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",41)(2,"div",42),e.DNE(3,gi,3,3,"span",43)(4,fi,3,3,"span",44),e.EFF(5),e.k0s(),e.nrm(6,"div",45),e.j41(7,"vdr-dropdown")(8,"button",46),e.nrm(9,"clr-icon",47),e.k0s(),e.j41(10,"vdr-dropdown-menu",48)(11,"button",49),e.nI1(12,"hasPermission"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG();return e.Njj(l.updateNote.emit(i))}),e.nrm(13,"clr-icon",50),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.nrm(16,"div",51),e.j41(17,"button",49),e.nI1(18,"hasPermission"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG();return e.Njj(l.deleteNote.emit(i))}),e.nrm(19,"clr-icon",52),e.EFF(20),e.nI1(21,"translate"),e.k0s()()()(),e.bVm()}if(2&r){const t=e.XpG(2).$implicit;e.R7$(3),e.Y8G("ngIf",t.isPublic),e.R7$(),e.Y8G("ngIf",!t.isPublic),e.R7$(),e.SpI(" ",t.data.note," "),e.R7$(6),e.Y8G("disabled",!e.bMT(12,7,"UpdateOrder")),e.R7$(3),e.SpI(" ",e.bMT(15,9,"common.edit")," "),e.R7$(3),e.Y8G("disabled",!e.bMT(18,11,"UpdateOrder")),e.R7$(3),e.SpI(" ",e.bMT(21,13,"common.delete")," ")}}function hi(r,n){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.j41(3,"vdr-chip")(4,"a",55),e.EFF(5),e.k0s()(),e.bVm()),2&r){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",e.bMT(2,3,"order.history-coupon-code-applied"),": "),e.R7$(3),e.Y8G("routerLink",e.eq3(5,wo,t.data.promotionId)),e.R7$(),e.JRh(t.data.couponCode)}}function vi(r,n){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.j41(3,"vdr-chip")(4,"span",56),e.EFF(5),e.k0s()(),e.bVm()),2&r){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",e.bMT(2,2,"order.history-coupon-code-removed"),": "),e.R7$(4),e.JRh(t.data.couponCode)}}function bi(r,n){if(1&r&&(e.j41(0,"a",58),e.nrm(1,"clr-icon",59),e.j41(2,"span"),e.EFF(3),e.k0s(),e.nrm(4,"clr-icon",60),e.k0s()),2&r){const t=e.XpG(3).$implicit;e.Y8G("routerLink",e.eq3(2,Ee,t.data.previousCustomerId)),e.R7$(3),e.JRh(t.data.previousCustomerName)}}function yi(r,n){if(1&r&&(e.j41(0,"a",58),e.nrm(1,"clr-icon",59),e.j41(2,"span"),e.EFF(3),e.k0s(),e.nrm(4,"clr-icon",60),e.k0s()),2&r){const t=e.XpG(3).$implicit;e.Y8G("routerLink",e.eq3(2,Ee,t.data.newCustomerId)),e.R7$(3),e.JRh(t.data.newCustomerName)}}function Ci(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",41)(5,"div",42),e.EFF(6),e.k0s(),e.nrm(7,"div",45),e.j41(8,"vdr-history-entry-detail")(9,"vdr-labeled-data",38),e.nI1(10,"translate"),e.DNE(11,bi,5,4,"a",57),e.k0s(),e.j41(12,"vdr-labeled-data",38),e.nI1(13,"translate"),e.DNE(14,yi,5,4,"a",57),e.k0s()()(),e.bVm()),2&r){const t=e.XpG(2).$implicit;e.R7$(2),e.SpI(" ",e.i5U(3,6,"order.history-customer-updated",e.eq3(13,No,t.data.newCustomerName))," "),e.R7$(4),e.SpI(" ",t.data.note," "),e.R7$(3),e.Y8G("label",e.bMT(10,9,"order.previous-customer")),e.R7$(2),e.Y8G("ngIf",t.data.previousCustomerId),e.R7$(),e.Y8G("label",e.bMT(13,11,"order.new-customer")),e.R7$(2),e.Y8G("ngIf",t.data.newCustomerId)}}function Ii(r,n){if(1&r&&(e.j41(0,"vdr-history-entry-detail"),e.nrm(1,"vdr-object-tree",61),e.k0s()),2&r){const t=e.XpG(3).$implicit;e.R7$(),e.Y8G("value",t.data)}}function Ti(r,n){if(1&r&&(e.qex(0),e.j41(1,"div",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,Ii,2,1,"vdr-history-entry-detail",34),e.bVm()),2&r){const t=e.XpG(2).$implicit;e.R7$(2),e.SpI(" ",e.bMT(3,2,t.type)," "),e.R7$(2),e.Y8G("ngIf",t.data)}}function Fi(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-timeline-entry",19),e.bIt("expandClick",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.expanded=!i.expanded)}),e.qex(1,20),e.DNE(2,qo,4,3,"ng-container",21)(3,zo,5,4,"ng-container",21)(4,ei,4,2,"ng-container",21)(5,oi,4,2,"ng-container",21)(6,ai,4,7,"ng-container",21)(7,di,4,4,"ng-container",21)(8,ui,5,4,"ng-container",21)(9,_i,22,15,"ng-container",21)(10,hi,6,7,"ng-container",21)(11,vi,6,4,"ng-container",21)(12,Ci,15,15,"ng-container",21)(13,Ti,5,4,"ng-container",22),e.bVm(),e.k0s()}if(2&r){const t=e.XpG().$implicit,o=e.XpG();e.Y8G("displayType",o.getDisplayType(t))("iconShape",o.getTimelineIcon(t))("createdAt",t.createdAt)("name",o.getName(t))("featured",o.isFeatured(t))("collapsed",!o.expanded&&!o.isFeatured(t)),e.R7$(),e.Y8G("ngSwitch",t.type),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_STATE_TRANSITION),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_MODIFIED),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_PAYMENT_TRANSITION),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_REFUND_TRANSITION),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_CANCELLATION),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_FULFILLMENT),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_FULFILLMENT_TRANSITION),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_NOTE),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_COUPON_APPLIED),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_COUPON_REMOVED),e.R7$(),e.Y8G("ngSwitchCase",o.type.ORDER_CUSTOMER_UPDATED)}}function xi(r,n){if(1&r&&(e.qex(0),e.DNE(1,Lo,1,3,"vdr-order-history-entry-host",17)(2,Fi,14,18,"ng-template",null,0,e.C5r),e.bVm()),2&r){const t=n.$implicit,o=e.sdS(3),i=e.XpG();e.R7$(),e.Y8G("ngIf",i.hasCustomComponent(t.type))("ngIfElse",o)}}const Oi=r=>["seller-orders",r];function Ri(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",5),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=n.ngIf;e.Y8G("label",e.bMT(1,2,"common.seller")),e.R7$(2),e.SpI(" ",t.name," ")}}function Si(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",5),e.nI1(1,"translate"),e.EFF(2),e.nI1(3,"localeCurrency"),e.k0s()),2&r){const t=e.XpG().$implicit;e.Y8G("label",e.bMT(1,2,"order.total")),e.R7$(2),e.SpI(" ",e.i5U(3,4,t.totalWithTax,t.currencyCode)," ")}}function Mi(r,n){if(1&r&&(e.j41(0,"div")(1,"a",3),e.EFF(2),e.nrm(3,"clr-icon",4),e.k0s(),e.j41(4,"vdr-labeled-data",5),e.nI1(5,"translate"),e.nrm(6,"vdr-order-state-label",6),e.k0s(),e.DNE(7,Ri,3,4,"vdr-labeled-data",7)(8,Si,4,7,"vdr-labeled-data",7),e.k0s()),2&r){const t=n.$implicit,o=e.XpG();e.R7$(),e.Y8G("routerLink",e.eq3(8,Oi,t.id)),e.R7$(),e.SpI("",t.code," "),e.R7$(2),e.Y8G("label",e.bMT(5,6,"order.state")),e.R7$(2),e.Y8G("state",t.state),e.R7$(),e.Y8G("ngIf",o.getSeller(t)),e.R7$(),e.Y8G("ngIf",o.getSeller(t))}}const ki=()=>["UpdateOrder","ReadCustomer"];function Di(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG().ngIf,l=e.XpG();return e.Njj(l.addManualPayment(i))}),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"localeCurrency"),e.k0s()}if(2&r){const t=e.XpG().ngIf,o=e.XpG();e.R7$(),e.Lme(" ",e.bMT(2,2,"order.add-payment-to-order")," (",e.i5U(3,4,o.outstandingPaymentAmount(t),t.currencyCode),") ")}}function Gi(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.transitionToState("ArrangingAdditionalPayment"))}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.arrange-additional-payment")," "))}function $i(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.fulfillOrder())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}if(2&r){const t=e.XpG().ngIf,o=e.XpG();e.Y8G("disabled",!o.canAddFulfillment(t)),e.R7$(),e.SpI(" ",e.bMT(2,2,"order.fulfill-order")," ")}}function Pi(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"button",8),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.transitionToModifying())}),e.nrm(2,"clr-icon",12),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.nrm(5,"div",7),e.bVm()}2&r&&(e.R7$(3),e.SpI(" ",e.bMT(4,1,"order.modify-order")," "))}function ji(r,n){1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.bVm()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.refund-and-cancel-order")," "))}function Ei(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.SpI(" ",e.bMT(1,1,"order.cancel-order")," ")}function wi(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){e.eBV(t);const i=e.XpG().ngIf,l=e.XpG();return e.Njj(l.cancelOrRefund(i))}),e.nrm(1,"clr-icon",13),e.DNE(2,ji,3,3,"ng-container",14)(3,Ei,2,3,"ng-template",null,0,e.C5r),e.k0s()}if(2&r){const t=e.sdS(4),o=e.XpG().ngIf,i=e.XpG();e.R7$(2),e.Y8G("ngIf",i.orderHasSettledPayments(o))("ngIfElse",t)}}function Ni(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.transitionToState(i))}),e.nrm(1,"clr-icon",16),e.EFF(2),e.nI1(3,"stateI18nToken"),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s()}if(2&r){const t=n.$implicit;e.R7$(2),e.SpI(" ",e.i5U(5,5,"order.transition-to-state",e.eq3(8,H,e.bMT(4,3,e.bMT(3,1,t))))," ")}}function Ai(r,n){if(1&r&&(e.qex(0),e.nrm(1,"div",7),e.DNE(2,Ni,6,10,"button",15),e.nI1(3,"async"),e.bVm()),2&r){const t=e.XpG(2);e.R7$(2),e.Y8G("ngForOf",e.bMT(3,1,t.nextStates$))}}function Yi(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-action-bar"),e.nrm(1,"vdr-ab-left"),e.j41(2,"vdr-ab-right"),e.nrm(3,"vdr-action-bar-items",2),e.DNE(4,Di,4,7,"button",3)(5,Gi,3,3,"button",3)(6,$i,3,4,"button",4),e.j41(7,"vdr-action-bar-dropdown-menu",5),e.DNE(8,Pi,6,3,"ng-container",1)(9,wi,5,2,"button",6)(10,Ai,4,3,"ng-container",1),e.nI1(11,"async"),e.nrm(12,"div",7),e.j41(13,"button",8),e.bIt("click",function(){const i=e.eBV(t).ngIf,l=e.XpG();return e.Njj(l.manuallyTransitionToState(i))}),e.nrm(14,"clr-icon",9),e.EFF(15),e.nI1(16,"translate"),e.k0s()()()()}if(2&r){let t;const o=n.ngIf,i=e.XpG();e.R7$(4),e.Y8G("ngIf","Aggregate"!==o.type&&("ArrangingPayment"===o.state||"ArrangingAdditionalPayment"===o.state)&&(i.hasUnsettledModifications(o)||0<i.outstandingPaymentAmount(o))),e.R7$(),e.Y8G("ngIf","Aggregate"!==o.type&&!1===o.active&&"ArrangingAdditionalPayment"!==o.state&&"ArrangingPayment"!==o.state&&0<i.outstandingPaymentAmount(o)),e.R7$(),e.Y8G("ngIf","Aggregate"!==o.type),e.R7$(),e.Y8G("alwaysShow",!0),e.R7$(),e.Y8G("ngIf","Aggregate"!==o.type&&o.nextStates.includes("Modifying")),e.R7$(),e.Y8G("ngIf","Aggregate"!==o.type&&o.nextStates.includes("Cancelled")),e.R7$(),e.Y8G("ngIf",null==(t=e.bMT(11,8,i.nextStates$))?null:t.length),e.R7$(5),e.SpI(" ",e.bMT(16,10,"order.manually-transition-to-state")," ")}}function Li(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",33),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openStateDiagram())}),e.nrm(2,"clr-icon",34),e.k0s()}2&r&&e.Y8G("title",e.bMT(1,1,"order.order-state-diagram"))}function Vi(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",33),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.setOrderCustomer())}),e.nrm(2,"clr-icon",36),e.k0s()}2&r&&e.Y8G("title",e.bMT(1,1,"order.assign-order-to-another-customer"))}function Xi(r,n){1&r&&e.DNE(0,Vi,3,3,"button",35),2&r&&e.Y8G("vdrIfPermissions",e.lJ4(1,ki))}function Bi(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",37),e.nI1(1,"translate"),e.nrm(2,"vdr-formatted-address",38),e.k0s()),2&r){const t=e.XpG().ngIf;e.Y8G("label",e.bMT(1,2,"order.shipping-address")),e.R7$(2),e.Y8G("address",t.shippingAddress)}}function qi(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",39),e.nI1(1,"translate"),e.nrm(2,"vdr-formatted-address",38),e.k0s()),2&r){const t=e.XpG().ngIf;e.Y8G("label",e.bMT(1,2,"order.billing-address")),e.R7$(2),e.Y8G("address",t.billingAddress)}}function Ui(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-order-payment-card",41),e.bIt("settlePayment",function(i){e.eBV(t);const l=e.XpG(3);return e.Njj(l.settlePayment(i))})("transitionPaymentState",function(i){e.eBV(t);const l=e.XpG(3);return e.Njj(l.transitionPaymentState(i))})("settleRefund",function(i){e.eBV(t);const l=e.XpG(3);return e.Njj(l.settleRefund(i))}),e.k0s()}if(2&r){const t=n.$implicit,o=e.XpG(2).ngIf;e.Y8G("currencyCode",o.currencyCode)("payment",t)}}function Hi(r,n){if(1&r&&(e.j41(0,"vdr-card",17),e.nI1(1,"translate"),e.DNE(2,Ui,1,2,"vdr-order-payment-card",40),e.k0s()),2&r){const t=e.XpG().ngIf;e.Y8G("title",e.bMT(1,2,"order.payments")),e.R7$(2),e.Y8G("ngForOf",t.payments)}}function Ji(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-fulfillment-card",43),e.bIt("transitionState",function(i){const l=e.eBV(t).$implicit,c=e.XpG(3);return e.Njj(c.transitionFulfillment(l.id,i))}),e.k0s()}if(2&r){const t=n.$implicit,o=e.XpG(2).ngIf;e.Y8G("fulfillment",t)("order",o)}}function zi(r,n){if(1&r&&(e.j41(0,"vdr-card"),e.DNE(1,Ji,1,2,"vdr-fulfillment-card",42),e.k0s()),2&r){const t=e.XpG().ngIf;e.R7$(),e.Y8G("ngForOf",t.fulfillments)}}function Wi(r,n){if(1&r&&e.nrm(0,"vdr-page-entity-info",44),2&r){const t=n.ngIf;e.Y8G("entity",t)}}function Qi(r,n){if(1&r&&e.nrm(0,"vdr-seller-orders-card",45),2&r){const t=e.XpG().ngIf;e.Y8G("orderId",t.id)}}function Zi(r,n){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"percent"),e.k0s(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"localeCurrency"),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"localeCurrency"),e.k0s()()),2&r){const t=n.$implicit,o=e.XpG().ngIf;e.R7$(2),e.JRh(t.description),e.R7$(2),e.JRh(e.i5U(5,4,t.taxRate/100,"0.0-3")),e.R7$(3),e.JRh(e.i5U(8,7,t.taxBase,o.currencyCode)),e.R7$(3),e.JRh(e.i5U(11,10,t.taxTotal,o.currencyCode))}}function Ki(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-card",17),e.nI1(1,"translate"),e.nrm(2,"vdr-tabbed-custom-fields",46),e.nI1(3,"hasPermission"),e.j41(4,"button",47),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.updateCustomFields())}),e.EFF(5),e.nI1(6,"translate"),e.k0s()()}if(2&r){let t;const o=e.XpG(2);e.Y8G("title",e.bMT(1,6,"common.custom-fields")),e.R7$(2),e.Y8G("customFields",o.customFields)("customFieldsFormGroup",o.detailForm.get("customFields"))("readonly",!e.bMT(3,8,"UpdateOrder")),e.R7$(2),e.Y8G("disabled",(null==(t=o.detailForm.get("customFields"))?null:t.pristine)||(null==(t=o.detailForm.get("customFields"))?null:t.invalid)),e.R7$(),e.SpI(" ",e.bMT(6,10,"common.update")," ")}}function ea(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-page-detail-layout")(1,"vdr-page-detail-sidebar")(2,"vdr-card",17),e.nI1(3,"translate"),e.DNE(4,Li,3,3,"ng-template",18),e.nrm(5,"vdr-order-state-label",19),e.k0s(),e.j41(6,"vdr-card",17),e.nI1(7,"translate"),e.DNE(8,Xi,1,2,"ng-template",18),e.nrm(9,"vdr-customer-label",20),e.DNE(10,Bi,3,4,"vdr-labeled-data",21)(11,qi,3,4,"vdr-labeled-data",22),e.k0s(),e.DNE(12,Hi,3,4,"vdr-card",23)(13,zi,2,1,"vdr-card",1),e.j41(14,"vdr-card"),e.DNE(15,Wi,1,1,"vdr-page-entity-info",24),e.nI1(16,"async"),e.k0s()(),e.j41(17,"vdr-page-block"),e.DNE(18,Qi,1,1,"vdr-seller-orders-card",25),e.j41(19,"vdr-card",26),e.nrm(20,"vdr-order-table",27),e.k0s(),e.j41(21,"vdr-card",28),e.nI1(22,"translate"),e.j41(23,"table",29)(24,"thead")(25,"tr")(26,"th"),e.EFF(27),e.nI1(28,"translate"),e.k0s(),e.j41(29,"th"),e.EFF(30),e.nI1(31,"translate"),e.k0s(),e.j41(32,"th"),e.EFF(33),e.nI1(34,"translate"),e.k0s(),e.j41(35,"th"),e.EFF(36),e.nI1(37,"translate"),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Zi,12,13,"tr",30),e.k0s()()(),e.DNE(40,Ki,7,12,"vdr-card",23),e.nrm(41,"vdr-custom-detail-component-host",31),e.j41(42,"vdr-card",17),e.nI1(43,"translate"),e.j41(44,"vdr-order-history",32),e.nI1(45,"async"),e.bIt("addNote",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.addNote(i))})("updateNote",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.updateNote(i))})("deleteNote",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.deleteNote(i))}),e.k0s()()()()}if(2&r){const t=n.ngIf,o=e.XpG();e.R7$(2),e.Y8G("title",e.bMT(3,26,"order.state")),e.R7$(3),e.Y8G("state",t.state),e.R7$(),e.Y8G("title",e.bMT(7,28,"order.customer")),e.R7$(3),e.Y8G("customer",t.customer),e.R7$(),e.Y8G("ngIf",o.getOrderAddressLines(t.shippingAddress).length),e.R7$(),e.Y8G("ngIf",o.getOrderAddressLines(t.billingAddress).length),e.R7$(),e.Y8G("ngIf",null==t.payments?null:t.payments.length),e.R7$(),e.Y8G("ngIf",null==t.fulfillments?null:t.fulfillments.length),e.R7$(2),e.Y8G("ngIf",e.bMT(16,30,o.entity$)),e.R7$(3),e.Y8G("ngIf",t.sellerOrders.length),e.R7$(),e.Y8G("paddingX",!1),e.R7$(),e.Y8G("order",t)("orderLineCustomFields",o.orderLineCustomFields),e.R7$(),e.Y8G("title",e.bMT(22,32,"order.tax-summary"))("paddingX",!1),e.R7$(6),e.JRh(e.bMT(28,34,"common.description")),e.R7$(3),e.JRh(e.bMT(31,36,"order.tax-rate")),e.R7$(3),e.JRh(e.bMT(34,38,"order.tax-base")),e.R7$(3),e.JRh(e.bMT(37,40,"order.tax-total")),e.R7$(3),e.Y8G("ngForOf",t.taxSummary),e.R7$(),e.Y8G("ngIf",o.customFields.length),e.R7$(),e.Y8G("entity$",o.entity$)("detailForm",o.detailForm),e.R7$(),e.Y8G("title",e.bMT(43,42,"order.order-history")),e.R7$(2),e.Y8G("order",t)("history",e.bMT(45,44,o.history$))}}function ta(r,n){if(1&r&&(e.j41(0,"div",4),e.EFF(1),e.k0s()),2&r){const t=n.$implicit;e.R7$(),e.SpI(" ",t," ")}}function na(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.DNE(2,ta,2,1,"div",3),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.i5U(1,2,"order.modification-adjusting-lines",e.eq3(5,$,null==t.modifyOrderInput.adjustOrderLines?null:t.modifyOrderInput.adjustOrderLines.length))),e.R7$(2),e.Y8G("ngForOf",t.adjustedLines)}}function ra(r,n){if(1&r&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&r){const t=n.$implicit;e.R7$(),e.Lme(" ",t.productVariant.name," x ",t.quantity," ")}}function oa(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.DNE(2,ra,2,2,"div",5),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.i5U(1,2,"order.modification-adding-items",e.eq3(5,$,null==t.modifyOrderInput.addItems?null:t.modifyOrderInput.addItems.length))),e.R7$(2),e.Y8G("ngForOf",t.addedLines)}}function ia(r,n){if(1&r&&(e.j41(0,"div",4),e.EFF(1),e.nI1(2,"localeCurrency"),e.k0s()),2&r){const t=n.$implicit,o=e.XpG(2);e.R7$(),e.Lme(" ",t.description,": ",e.i5U(2,2,t.price,o.orderSnapshot.currencyCode)," ")}}function aa(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.DNE(2,ia,3,5,"div",3),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.i5U(1,2,"order.modification-adding-surcharges",e.eq3(5,$,null==t.modifyOrderInput.surcharges?null:t.modifyOrderInput.surcharges.length))),e.R7$(2),e.Y8G("ngForOf",t.modifyOrderInput.surcharges)}}function la(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=n.ngIf;e.Y8G("label",e.bMT(1,2,"order.modification-updating-shipping-address")),e.R7$(2),e.SpI(" ",t,"\n")}}function da(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=n.ngIf;e.Y8G("label",e.bMT(1,2,"order.modification-updating-billing-address")),e.R7$(2),e.SpI(" ",t,"\n")}}function sa(r,n){if(1&r&&(e.j41(0,"div",4),e.EFF(1),e.k0s()),2&r){const t=n.$implicit;e.R7$(),e.JRh(t)}}function ca(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.DNE(2,sa,2,1,"div",3),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.set-coupon-codes")),e.R7$(2),e.Y8G("ngForOf",t.couponCodeChanges)}}function pa(r,n){if(1&r&&(e.j41(0,"div",4),e.EFF(1),e.k0s()),2&r){const t=n.$implicit;e.R7$(),e.JRh(t)}}function ma(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",2),e.nI1(1,"translate"),e.DNE(2,pa,2,1,"div",3),e.k0s()),2&r){const t=e.XpG().ngIf;e.Y8G("label",e.bMT(1,2,"order.shipping-method")),e.R7$(2),e.Y8G("ngForOf",t)}}function ua(r,n){if(1&r&&(e.qex(0),e.DNE(1,ma,3,4,"vdr-labeled-data",0),e.bVm()),2&r){const t=n.ngIf;e.R7$(),e.Y8G("ngIf",t.length)}}function ga(r,n){1&r&&(e.EFF(0),e.nI1(1,"translate")),2&r&&e.JRh(e.bMT(1,1,"order.confirm-modifications"))}function fa(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-payment-for-refund-selector",10),e.bIt("paymentSelected",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.onPaymentSelected(i.payment,i.selected))}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("refundablePayments",t.refundablePayments)("order",t.order)}}function _a(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-form-field",7),e.nI1(1,"translate"),e.j41(2,"textarea",11),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.refundNote,i)||(l.refundNote=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.refund-cancellation-reason")),e.R7$(2),e.R50("ngModel",t.refundNote)}}function ha(r,n){1&r&&(e.j41(0,"clr-alert",18)(1,"clr-alert-item"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.Y8G("clrAlertType","danger")("clrAlertClosable",!1),e.R7$(2),e.SpI(" ",e.bMT(3,3,"order.refund-total-warning")," "))}function va(r,n){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"div",12),e.DNE(2,ha,4,5,"clr-alert",13),e.k0s(),e.j41(3,"div",14)(4,"clr-alert",15)(5,"clr-alert-item"),e.EFF(6),e.nI1(7,"translate"),e.nI1(8,"localeCurrency"),e.k0s()(),e.j41(9,"button",16),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"button",17),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submit())}),e.EFF(13),e.nI1(14,"translate"),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.priceDifference<0&&!t.refundsCoverDifference()),e.R7$(2),e.Y8G("clrAlertType","primary")("clrAlertClosable",!1),e.R7$(2),e.E5c(" ",e.bMT(7,9,"order.modify-order-price-difference")," ",0<t.priceDifference?"+":"","",e.i5U(8,11,t.priceDifference,t.order.currencyCode)," "),e.R7$(4),e.SpI(" ",e.bMT(11,14,"common.cancel")," "),e.R7$(2),e.Y8G("disabled",t.priceDifference<0&&!t.refundsCoverDifference()),e.R7$(),e.SpI(" ",e.bMT(14,16,"common.confirm")," ")}}const ba=r=>({rate:r});function ya(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-action-bar")(1,"vdr-ab-left"),e.nrm(2,"div",2),e.k0s(),e.j41(3,"vdr-ab-right")(4,"button",3),e.bIt("click",function(){const i=e.eBV(t).ngIf,l=e.XpG();return e.Njj(l.transitionToPriorState(i))}),e.EFF(5),e.nI1(6,"translate"),e.k0s()()()}2&r&&(e.R7$(5),e.SpI(" ",e.bMT(6,1,"order.cancel-modification")," "))}function Ca(r,n){1&r&&(e.j41(0,"div",52),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"order.no-modifications-made")," "))}function Ia(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.editingShippingAddress=!i.editingShippingAddress)}),e.nrm(2,"clr-icon",54),e.k0s()}2&r&&e.Y8G("title",e.bMT(1,1,"order.edit-shipping-address"))}function Ta(r,n){if(1&r&&e.nrm(0,"vdr-formatted-address",55),2&r){const t=e.XpG(2);e.Y8G("address",t.shippingAddressForm.value)}}function Fa(r,n){if(1&r&&(e.nrm(0,"vdr-address-form",56),e.nI1(1,"async")),2&r){const t=e.XpG(2);e.Y8G("formGroup",t.shippingAddressForm)("availableCountries",e.bMT(1,3,t.availableCountries$))("customFields",t.addressCustomFields)}}function xa(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.editingBillingAddress=!i.editingBillingAddress)}),e.nrm(2,"clr-icon",54),e.k0s()}2&r&&e.Y8G("title",e.bMT(1,1,"order.edit-billing-address"))}function Oa(r,n){if(1&r&&e.nrm(0,"vdr-formatted-address",55),2&r){const t=e.XpG(2);e.Y8G("address",t.billingAddressForm.value)}}function Ra(r,n){if(1&r&&(e.nrm(0,"vdr-address-form",56),e.nI1(1,"async")),2&r){const t=e.XpG(2);e.Y8G("formGroup",t.billingAddressForm)("availableCountries",e.bMT(1,3,t.availableCountries$))("customFields",t.addressCustomFields)}}function Sa(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.id," ")}}function Ma(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.createdAt,"short")," ")}}function ka(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.updatedAt,"short")," ")}}function Da(r,n){if(1&r&&(e.nrm(0,"img",59),e.nI1(1,"assetPreview")),2&r){const t=n.ngIf;e.Y8G("src",e.i5U(1,1,t,"tiny"),e.B4B)}}function Ga(r,n){1&r&&(e.j41(0,"div",60),e.nrm(1,"clr-icon",61),e.k0s())}function $a(r,n){if(1&r&&(e.j41(0,"div",57),e.DNE(1,Da,2,4,"img",58)(2,Ga,2,0,"ng-template",null,0,e.C5r),e.k0s()),2&r){const t=n.item,o=e.sdS(3);e.R7$(),e.Y8G("ngIf",t.featuredAsset)("ngIfElse",o)}}function Pa(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.productVariant.name," ")}}function ja(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.productVariant.sku," ")}}function Ea(r,n){if(1&r&&(e.j41(0,"div",62)(1,"div"),e.EFF(2),e.nI1(3,"localeCurrency"),e.k0s(),e.j41(4,"div",63),e.nI1(5,"translate"),e.EFF(6),e.nI1(7,"localeCurrency"),e.k0s()()),2&r){const t=n.item,o=e.XpG().ngIf;e.R7$(2),e.JRh(e.i5U(3,3,t.unitPriceWithTax,o.currencyCode)),e.R7$(2),e.Y8G("title",e.bMT(5,6,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(7,8,t.unitPrice,o.currencyCode)," ")}}function wa(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const i=e.XpG().item,l=e.XpG(2);return e.Njj(l.removeAddedItem(i.id))}),e.nrm(1,"clr-icon",69),e.k0s()}}function Na(r,n){if(1&r){const t=e.RV6();e.j41(0,"input",64),e.bIt("input",function(i){const l=e.eBV(t).item,c=e.XpG(2);return e.Njj(c.updateLineQuantity(l,i.target.value))}),e.k0s(),e.DNE(1,wa,2,0,"button",65),e.nrm(2,"vdr-line-refunds",66)(3,"vdr-line-fulfillment",67)}if(2&r){const t=n.item,o=e.XpG().ngIf,i=e.XpG();e.Y8G("value",i.getInitialLineQuantity(t.id)),e.R7$(),e.Y8G("ngIf",i.isAddedLine(t)),e.R7$(),e.Y8G("line",t)("payments",o.payments),e.R7$(),e.Y8G("line",t)("allOrderFulfillments",o.fulfillments)("orderState",o.state)}}function Aa(r,n){if(1&r&&e.nrm(0,"vdr-custom-field-control",71),2&r){const t=n.index,o=e.XpG().$implicit,i=e.XpG(2);e.Y8G("compact",!0)("entityName","OrderLine")("customField",o)("customFieldsFormGroup",i.orderLineCustomFieldsFormArray.at(t))}}function Ya(r,n){if(1&r&&(e.j41(0,"vdr-dt2-column",70),e.nI1(1,"async"),e.nI1(2,"customFieldLabel"),e.DNE(3,Aa,1,4,"ng-template"),e.k0s()),2&r){const t=n.$implicit,o=e.XpG(2);e.Y8G("id",t.name)("heading",e.i5U(2,5,t,e.bMT(1,3,o.uiLanguage$)))("hiddenByDefault",!0)}}function La(r,n){if(1&r&&(e.nrm(0,"img",75),e.nI1(1,"assetPreview")),2&r){const t=n.ngIf;e.Y8G("src",e.i5U(1,1,t,"tiny"),e.B4B)}}function Va(r,n){if(1&r&&(e.j41(0,"div",72),e.DNE(1,La,2,4,"img",73),e.j41(2,"div")(3,"strong",74),e.EFF(4),e.k0s(),e.j41(5,"small"),e.EFF(6),e.k0s(),e.j41(7,"div"),e.EFF(8),e.nI1(9,"localeCurrency"),e.k0s()()()),2&r){const t=e.XpG().ngIf,o=e.XpG();e.R7$(),e.Y8G("ngIf",o.addItemSelectedVariant.productAsset),e.R7$(3),e.JRh(o.addItemSelectedVariant.productVariantName),e.R7$(2),e.JRh(o.addItemSelectedVariant.sku),e.R7$(2),e.SpI(" ",e.i5U(9,4,o.getSelectedItemPrice(o.addItemSelectedVariant),t.currencyCode)," ")}}function Xa(r,n){if(1&r&&(e.qex(0),e.nrm(1,"vdr-custom-field-control",77),e.bVm()),2&r){const t=n.$implicit,o=e.XpG(3);e.R7$(),e.Y8G("readonly",!o.addItemSelectedVariant)("customField",t)("customFieldsFormGroup",o.addItemCustomFieldsForm)("compact",!0)}}function Ba(r,n){if(1&r&&(e.j41(0,"div",37),e.DNE(1,Xa,2,4,"ng-container",76),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.orderLineCustomFields)}}function qa(r,n){if(1&r){const t=e.RV6();e.j41(0,"button",78),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.addItemToOrder(i.addItemSelectedVariant))}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("disabled",!t.addItemSelectedVariant||t.addItemCustomFieldsForm.invalid),e.R7$(),e.SpI(" ",e.bMT(2,2,"order.add-item-to-order")," ")}}function Ua(r,n){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",79),e.EFF(4),e.nI1(5,"localeCurrency"),e.k0s(),e.j41(6,"button",68),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(2);return e.Njj(l.setShippingMethod(i.id))}),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.bVm()}if(2&r){const t=n.ngIf,o=e.XpG(2).ngIf;e.R7$(2),e.SpI("",t.name,":"),e.R7$(2),e.SpI(" ",e.i5U(5,3,t.price,o.currencyCode)," "),e.R7$(3),e.SpI(" ",e.bMT(8,6,"order.set-shipping-method")," ")}}function Ha(r,n){if(1&r&&(e.j41(0,"div",10),e.DNE(1,Ua,9,8,"ng-container",1),e.k0s()),2&r){const t=n.$implicit,o=e.XpG(2);e.R7$(),e.Y8G("ngIf",o.getShippingLineDetails(t))}}function Ja(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-page-detail-layout")(1,"vdr-page-detail-sidebar")(2,"vdr-card",4),e.nI1(3,"translate"),e.nrm(4,"vdr-order-modification-summary",5),e.DNE(5,Ca,3,3,"div",6),e.j41(6,"div",7)(7,"vdr-form-field",8),e.nI1(8,"translate"),e.j41(9,"textarea",9),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.note,i)||(l.note=i),e.Njj(i)}),e.k0s()(),e.j41(10,"label",10)(11,"input",11),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.recalculateShipping,i)||(l.recalculateShipping=i),e.Njj(i)}),e.k0s(),e.j41(12,"div",12),e.EFF(13),e.nI1(14,"translate"),e.k0s()(),e.j41(15,"button",13),e.bIt("click",function(){const i=e.eBV(t).ngIf,l=e.XpG();return e.Njj(l.previewAndModify(i))}),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"vdr-card",4),e.nI1(19,"translate"),e.nrm(20,"vdr-coupon-code-selector",14),e.k0s(),e.j41(21,"vdr-card",4),e.nI1(22,"translate"),e.DNE(23,Ia,3,3,"ng-template",15)(24,Ta,1,1,"vdr-formatted-address",16)(25,Fa,2,5,"vdr-address-form",17),e.k0s(),e.j41(26,"vdr-card",4),e.nI1(27,"translate"),e.DNE(28,xa,3,3,"ng-template",15)(29,Oa,1,1,"vdr-formatted-address",16)(30,Ra,2,5,"vdr-address-form",17),e.k0s()(),e.j41(31,"vdr-page-block")(32,"vdr-card",18)(33,"vdr-data-table-2",19)(34,"vdr-dt2-column",20),e.nI1(35,"translate"),e.DNE(36,Sa,1,1,"ng-template"),e.k0s(),e.j41(37,"vdr-dt2-column",21),e.nI1(38,"translate"),e.DNE(39,Ma,2,4,"ng-template"),e.k0s(),e.j41(40,"vdr-dt2-column",22),e.nI1(41,"translate"),e.DNE(42,ka,2,4,"ng-template"),e.k0s(),e.j41(43,"vdr-dt2-column",23),e.nI1(44,"translate"),e.DNE(45,$a,4,2,"ng-template"),e.k0s(),e.j41(46,"vdr-dt2-column",24),e.nI1(47,"translate"),e.DNE(48,Pa,1,1,"ng-template"),e.k0s(),e.j41(49,"vdr-dt2-column",25),e.nI1(50,"translate"),e.DNE(51,ja,1,1,"ng-template"),e.k0s(),e.j41(52,"vdr-dt2-column",26),e.nI1(53,"translate"),e.DNE(54,Ea,8,11,"ng-template"),e.k0s(),e.j41(55,"vdr-dt2-column",27),e.nI1(56,"translate"),e.DNE(57,Na,4,7,"ng-template"),e.k0s(),e.DNE(58,Ya,4,8,"vdr-dt2-column",28),e.k0s()(),e.j41(59,"vdr-card",4),e.nI1(60,"translate"),e.j41(61,"vdr-product-variant-selector",29),e.bIt("productSelected",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.addItemSelectedVariant=i)}),e.k0s(),e.j41(62,"div",30)(63,"div"),e.DNE(64,Va,10,7,"div",31)(65,Ba,2,1,"div",32),e.k0s(),e.nrm(66,"div",33),e.j41(67,"div"),e.DNE(68,qa,3,4,"button",34),e.k0s()()(),e.j41(69,"vdr-card",4),e.nI1(70,"translate"),e.DNE(71,Ha,2,1,"div",35),e.k0s(),e.j41(72,"vdr-card",4),e.nI1(73,"translate"),e.j41(74,"form",36),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addSurcharge(i.surchargeForm.value))}),e.j41(75,"div",37)(76,"vdr-form-field",38),e.nI1(77,"translate"),e.nrm(78,"input",39),e.k0s(),e.j41(79,"vdr-form-field",40),e.nI1(80,"translate"),e.nrm(81,"input",41),e.k0s(),e.j41(82,"vdr-form-field",42),e.nI1(83,"translate"),e.nrm(84,"vdr-currency-input",43),e.k0s(),e.j41(85,"vdr-form-field",44),e.nI1(86,"translate"),e.nrm(87,"input",45),e.k0s(),e.j41(88,"vdr-form-field",46),e.nI1(89,"translate"),e.j41(90,"vdr-affixed-input",47),e.nrm(91,"input",48),e.k0s()(),e.j41(92,"vdr-form-field",49),e.nI1(93,"translate"),e.nrm(94,"input",50),e.k0s()(),e.j41(95,"button",51),e.EFF(96),e.nI1(97,"translate"),e.k0s()()()()()}if(2&r){let t,o;const i=n.ngIf,l=e.XpG();e.R7$(2),e.Y8G("title",e.bMT(3,58,"order.modification-summary")),e.R7$(2),e.Y8G("orderSnapshot",l.orderSnapshot)("modifyOrderInput",l.modifyOrderInput)("addedLines",l.addedLines)("shippingAddressForm",l.shippingAddressForm)("billingAddressForm",l.billingAddressForm)("couponCodesControl",l.couponCodesControl)("updatedShippingMethods",l.updatedShippingMethods),e.R7$(),e.Y8G("ngIf",!l.hasModifications()),e.R7$(2),e.Y8G("label",e.bMT(8,60,"order.note")),e.R7$(2),e.R50("ngModel",l.note),e.Y8G("disabled",!l.hasModifications()),e.R7$(2),e.R50("ngModel",l.recalculateShipping),e.Y8G("disabled",!l.hasModifications()),e.R7$(2),e.JRh(e.bMT(14,62,"order.modification-recalculate-shipping")),e.R7$(2),e.Y8G("disabled",!l.hasModifications()),e.R7$(),e.SpI(" ",e.bMT(17,64,"order.preview-changes")," "),e.R7$(2),e.Y8G("title",e.bMT(19,66,"order.set-coupon-codes")),e.R7$(2),e.Y8G("control",l.couponCodesControl),e.R7$(),e.Y8G("title",e.bMT(22,68,"order.shipping-address")),e.R7$(3),e.Y8G("ngIf",!l.editingShippingAddress),e.R7$(),e.Y8G("ngIf",l.editingShippingAddress),e.R7$(),e.Y8G("title",e.bMT(27,70,"order.billing-address")),e.R7$(3),e.Y8G("ngIf",!l.editingBillingAddress),e.R7$(),e.Y8G("ngIf",l.editingBillingAddress),e.R7$(2),e.Y8G("paddingX",!1),e.R7$(),e.Y8G("items",i.lines.concat(l.addedLines)),e.R7$(),e.Y8G("heading",e.bMT(35,72,"common.id"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(38,74,"common.created-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(41,76,"common.updated-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(44,78,"common.image")),e.R7$(3),e.Y8G("heading",e.bMT(47,80,"order.product-name"))("optional",!1),e.R7$(3),e.Y8G("heading",e.bMT(50,82,"order.product-sku")),e.R7$(3),e.Y8G("heading",e.bMT(53,84,"order.unit-price")),e.R7$(3),e.Y8G("heading",e.bMT(56,86,"order.quantity"))("optional",!1),e.R7$(3),e.Y8G("ngForOf",l.orderLineCustomFields),e.R7$(),e.Y8G("title",e.bMT(60,88,"order.add-item-to-order")),e.R7$(5),e.Y8G("ngIf",l.addItemSelectedVariant),e.R7$(),e.Y8G("ngIf",l.addItemSelectedVariant),e.R7$(3),e.Y8G("ngIf",l.addItemSelectedVariant),e.R7$(),e.Y8G("title",e.bMT(70,90,"order.shipping")),e.R7$(2),e.Y8G("ngForOf",i.shippingLines),e.R7$(),e.Y8G("title",e.bMT(73,92,"order.add-surcharge")),e.R7$(2),e.Y8G("formGroup",l.surchargeForm),e.R7$(2),e.Y8G("label",e.bMT(77,94,"common.description")),e.R7$(3),e.Y8G("label",e.bMT(80,96,"order.product-sku")),e.R7$(3),e.Y8G("label",e.bMT(83,98,"common.price")),e.R7$(2),e.Y8G("currencyCode",i.currencyCode),e.R7$(),e.Y8G("label",e.i5U(86,100,"catalog.price-includes-tax-at",e.eq3(109,ba,null!==(t=null==(t=l.surchargeForm.get("taxRate"))?null:t.value)&&void 0!==t?t:0))),e.R7$(3),e.Y8G("label",e.bMT(89,103,"order.tax-rate")),e.R7$(4),e.Y8G("label",e.bMT(93,105,"order.tax-description")),e.R7$(3),e.Y8G("disabled",l.surchargeForm.invalid||l.surchargeForm.pristine||0===(null==(o=l.surchargeForm.get("price"))?null:o.value)||!(null!=(o=l.surchargeForm.get("description"))&&o.value)),e.R7$(),e.SpI(" ",e.bMT(97,107,"order.add-surcharge")," ")}}const za=()=>["CreateOrder"],Wa=()=>["./draft/create"],Qa=r=>["./draft",r],Za=r=>["./",r];function Ka(r,n){1&r&&(e.j41(0,"a",17),e.nrm(1,"clr-icon",18),e.EFF(2),e.nI1(3,"translate"),e.k0s()),2&r&&(e.Y8G("routerLink",e.lJ4(4,Wa)),e.R7$(2),e.SpI(" ",e.bMT(3,2,"catalog.create-draft-order")," "))}function el(r,n){1&r&&(e.qex(0),e.DNE(1,Ka,4,5,"a",16),e.bVm()),2&r&&(e.R7$(),e.Y8G("vdrIfPermissions",e.lJ4(1,za)))}function tl(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item;e.SpI(" ",t.id," ")}}function nl(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.createdAt,"short")," ")}}function rl(r,n){if(1&r&&(e.j41(0,"a",19)(1,"span"),e.EFF(2),e.k0s(),e.nrm(3,"clr-icon",20),e.k0s()),2&r){const t=n.item;e.Y8G("routerLink","Draft"===t.state?e.eq3(2,Qa,t.id):e.eq3(4,Za,t.id)),e.R7$(2),e.JRh(t.code)}}function ol(r,n){if(1&r){const t=e.RV6();e.j41(0,"vdr-customer-label",21),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())}),e.k0s()}if(2&r){const t=n.item;e.Y8G("customer",t.customer)}}function il(r,n){1&r&&(e.j41(0,"vdr-chip"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"order.order-type-regular")))}function al(r,n){1&r&&(e.j41(0,"vdr-chip"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"order.order-type-aggregate")))}function ll(r,n){1&r&&(e.j41(0,"vdr-chip"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r&&(e.R7$(),e.JRh(e.bMT(2,1,"order.order-type-seller")))}function dl(r,n){if(1&r&&e.DNE(0,il,3,3,"vdr-chip",1)(1,al,3,3,"vdr-chip",1)(2,ll,3,3,"vdr-chip",1),2&r){const t=n.item,o=e.XpG();e.Y8G("ngIf",t.type===o.OrderType.Regular),e.R7$(),e.Y8G("ngIf",t.type===o.OrderType.Aggregate),e.R7$(),e.Y8G("ngIf",t.type===o.OrderType.Seller)}}function sl(r,n){if(1&r&&e.nrm(0,"vdr-order-state-label",22),2&r){const t=n.item;e.Y8G("state",t.state)}}function cl(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeCurrency")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.totalWithTax,t.currencyCode)," ")}}function pl(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"timeAgo")),2&r){const t=n.item;e.SpI(" ",e.bMT(1,1,t.updatedAt)," ")}}function ml(r,n){if(1&r&&(e.EFF(0),e.nI1(1,"localeDate")),2&r){const t=n.item;e.SpI(" ",e.i5U(1,1,t.orderPlacedAt,"short")," ")}}function ul(r,n){if(1&r&&e.EFF(0),2&r){const t=n.item,o=e.XpG();e.SpI(" ",o.getShippingNames(t)," ")}}function gl(r,n){if(1&r&&e.nrm(0,"vdr-dt2-custom-field-column",23),2&r){const t=n.$implicit,o=e.XpG();e.Y8G("customField",t)("sorts",o.sorts)}}function fl(r,n){if(1&r&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.Y8G("label",e.bMT(1,2,"order.transaction-id")),e.R7$(2),e.SpI(" ",t.refund.transactionId,"\n")}}function Ie(r){return(r||[]).filter(t=>"Settled"===t.state).map((t,o)=>{const i=t.amount-(0,_.summate)(t.refunds.filter(l=>"Failed"!==l.state),"total");return{...t,refundableAmount:i,amountToRefundControl:new d.MJ(0,{nonNullable:!0,validators:[d.k0.min(0),d.k0.max(i)]}),selected:0===o}})}O.J1`
    query GetAddManualPaymentMethodList($options: PaymentMethodListOptions!) {
        paymentMethods(options: $options) {
            items {
                id
                createdAt
                updatedAt
                name
                code
                description
                enabled
            }
            totalItems
        }
    }
`;class J{constructor(n){this.dataService=n,this.form=new d.J3({method:new d.hs("",d.k0.required),transactionId:new d.hs("",d.k0.required)})}ngOnInit(){this.paymentMethods$=this.dataService.query(a.CRK,{options:{take:999}}).mapSingle(n=>n.paymentMethods.items)}submit(){const n=this.form.value;this.resolveWith({method:n.method,transactionId:n.transactionId})}cancel(){this.resolveWith()}static{this.\u0275fac=function(t){return new(t||J)(e.rXU(a.uSP))}}static{this.\u0275cmp=e.VBU({type:J,selectors:[["vdr-add-manual-payment-dialog"]],decls:10,vars:11,consts:[["vdrDialogTitle",""],[3,"formGroup"],["for","method",3,"label"],["bindLabel","code","appendTo","body","autofocus","","bindValue","code","formControlName","method",3,"items","addTag"],["for","transactionId",3,"label"],["id","transactionId","type","text","formControlName","transactionId"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.DNE(0,Qe,2,3,"ng-template",0),e.j41(1,"form",1)(2,"vdr-form-field",2),e.nI1(3,"translate"),e.nrm(4,"ng-select",3),e.nI1(5,"async"),e.k0s(),e.j41(6,"vdr-form-field",4),e.nI1(7,"translate"),e.nrm(8,"input",5),e.k0s()(),e.DNE(9,Ze,7,11,"ng-template",6)),2&t&&(e.R7$(),e.Y8G("formGroup",o.form),e.R7$(),e.Y8G("label",e.bMT(3,5,"order.payment-method")),e.R7$(2),e.Y8G("items",e.bMT(5,7,o.paymentMethods$))("addTag",!0),e.R7$(2),e.Y8G("label",e.bMT(7,9,"order.transaction-id")))},dependencies:[d.qT,d.me,d.BC,d.cb,d.j4,d.JD,I.vr,a.KSf,a.Vr5,a.bc3,a.MCd,s.Jj,g.D9,a.uc0],styles:[".ng-select[_ngcontent-%COMP%]{min-width:100%}"],changeDetection:0})}}class z{get selectionCount(){return Object.values(this.lineQuantities).reduce((n,t)=>n+t,0)}constructor(n){this.i18nService=n,this.cancelAll=!0,this.lineQuantities={},this.reasons=(0,a.WEc)().cancellationReasons??[(0,p.x)("order.cancel-reason-customer-request"),(0,p.x)("order.cancel-reason-not-available")],this.reasons=this.reasons.map(t=>this.i18nService.translate(t))}ngOnInit(){this.lineQuantities=this.order.lines.reduce((n,t)=>({...n,[t.id]:t.quantity}),{})}radioChanged(){if(this.cancelAll)for(const n of this.order.lines)this.lineQuantities[n.id]=n.quantity;else for(const n of this.order.lines)this.lineQuantities[n.id]=0}checkIfAllSelected(){for(const[n,t]of Object.entries(this.lineQuantities)){const o=this.order.lines.find(i=>i.id===n)?.quantity;if(o&&t<o)return}this.cancelAll=!0}select(){this.resolveWith({orderId:this.order.id,lines:this.getLineInputs(),reason:this.reason,cancelShipping:this.cancelAll})}cancel(){this.resolveWith()}getLineInputs(){if(!this.order.active)return Object.entries(this.lineQuantities).map(([n,t])=>({orderLineId:n,quantity:t})).filter(n=>0<n.quantity)}static{this.\u0275fac=function(t){return new(t||z)(e.rXU(a.W40))}}static{this.\u0275cmp=e.VBU({type:z,selectors:[["vdr-cancel-order-dialog"]],decls:30,vars:23,consts:[["nonEditable",""],["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-lines"],[1,"table"],["class","order-line",3,"is-disabled","is-cancelled",4,"ngFor","ngForOf"],[1,"cancellation-details"],[4,"ngIf"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"ngModelChange","items","addTag","ngModel"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"ngModel","disabled","max","ngModelChange","input",4,"ngIf","ngIfElse"],["type","number","min","0",3,"ngModelChange","input","ngModel","disabled","max"],["type","radio","clrRadio","","name","options",3,"ngModelChange","value","ngModel"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.DNE(0,Ke,2,3,"ng-template",1),e.j41(1,"div",2)(2,"div",3)(3,"table",4)(4,"thead")(5,"tr"),e.nrm(6,"th"),e.j41(7,"th"),e.EFF(8),e.nI1(9,"translate"),e.k0s(),e.j41(10,"th"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"th"),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"th"),e.EFF(17),e.nI1(18,"translate"),e.k0s(),e.j41(19,"th"),e.EFF(20),e.nI1(21,"translate"),e.k0s()()(),e.DNE(22,nt,17,17,"tr",5),e.k0s()(),e.j41(23,"div",6),e.DNE(24,rt,11,10,"ng-container",7),e.j41(25,"label",8),e.EFF(26),e.nI1(27,"translate"),e.k0s(),e.j41(28,"ng-select",9),e.mxI("ngModelChange",function(l){return e.DH7(o.reason,l)||(o.reason=l),l}),e.k0s()()(),e.DNE(29,at,6,6,"ng-template",10)),2&t&&(e.R7$(8),e.JRh(e.bMT(9,11,"order.product-name")),e.R7$(3),e.JRh(e.bMT(12,13,"order.product-sku")),e.R7$(3),e.JRh(e.bMT(15,15,"order.quantity")),e.R7$(3),e.JRh(e.bMT(18,17,"order.unit-price")),e.R7$(3),e.JRh(e.bMT(21,19,"order.cancel")),e.R7$(2),e.Y8G("ngForOf",o.order.lines),e.R7$(2),e.Y8G("ngIf",!0!==o.order.active),e.R7$(2),e.JRh(e.bMT(27,21,"order.cancellation-reason")),e.R7$(2),e.Y8G("items",o.reasons)("addTag",!0),e.R50("ngModel",o.reason))},dependencies:[m.aZZ,m.fkp,m.cIb,s.Sq,s.bT,d.me,d.Q0,d.Fm,d.BC,d.VZ,d.zX,d.vS,I.vr,a.Vr5,a.bc3,a.MCd,g.D9,a.HlS,a.uc0],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]   .cancellation-details[_ngcontent-%COMP%]{margin-top:0;margin-inline-start:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}.fulfillment-wrapper[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}.fulfillment-wrapper[_ngcontent-%COMP%]   .is-disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .fulfillment-wrapper[_ngcontent-%COMP%]   .is-disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"],changeDetection:0})}}const _l=O.J1`
    query GetCouponCodeSelectorPromotionList($options: PromotionListOptions) {
        promotions(options: $options) {
            items {
                id
                name
                couponCode
            }
            totalItems
        }
    }
`;class P{constructor(n){this.dataService=n,this.addCouponCode=new e.bkB,this.removeCouponCode=new e.bkB,this.couponCodeInput$=new G.B}ngOnInit(){this.availableCouponCodes$=(0,Oe.x)(this.couponCodeInput$.pipe((0,Ce.B)(200),(0,Re.F)(),(0,f.n)(n=>this.dataService.query(a.d7T,{options:{take:10,skip:0,filter:{couponCode:{contains:n}}}}).single$),(0,v.T)(({promotions:n})=>n.items.map(t=>({code:t.couponCode,promotionName:t.name}))),(0,Se.Z)([]))),this.control||(this.control=new d.hs(this.couponCodes??[]))}remove(n){this.removeCouponCode.emit(n)}static{this.\u0275fac=function(t){return new(t||P)(e.rXU(a.uSP))}}static{this.\u0275cmp=e.VBU({type:P,selectors:[["vdr-coupon-code-selector"]],inputs:{couponCodes:"couponCodes",control:"control"},outputs:{addCouponCode:"addCouponCode",removeCouponCode:"removeCouponCode"},decls:3,vars:9,consts:[["appendTo","body","bindLabel","code","bindValue","code","typeToSearchText","",3,"add","remove","items","addTag","multiple","hideSelected","minTermLength","typeahead","formControl"],["ng-option-tmp",""],[1,"flex","items-center"],[1,"mr-1"]],template:function(t,o){1&t&&(e.j41(0,"ng-select",0),e.nI1(1,"async"),e.bIt("add",function(l){return o.addCouponCode.emit(l.code)})("remove",function(l){return o.remove(l.code)}),e.DNE(2,lt,5,2,"ng-template",1),e.k0s()),2&t&&e.Y8G("items",e.bMT(1,7,o.availableCouponCodes$))("addTag",!1)("multiple",!0)("hideSelected",!0)("minTermLength",2)("typeahead",o.couponCodeInput$)("formControl",o.control)},dependencies:[d.BC,d.l_,I.vr,I.Uq,a.wux,s.Jj],changeDetection:0})}}class j{constructor(n,t){this.dataService=n,this.formBuilder=t,this.useExisting=!0,this.createNew=!1}ngOnInit(){this.addressForm=this.formBuilder.group({fullName:[this.currentAddress?.fullName??""],company:[this.currentAddress?.company??""],streetLine1:[this.currentAddress?.streetLine1??"",d.k0.required],streetLine2:[this.currentAddress?.streetLine2??""],city:[this.currentAddress?.city??"",d.k0.required],province:[this.currentAddress?.province??""],postalCode:[this.currentAddress?.postalCode??"",d.k0.required],countryCode:[this.currentAddress?.countryCode??"",d.k0.required],phoneNumber:[this.currentAddress?.phoneNumber??""]}),this.useExisting=!!this.customerId,this.addresses$=this.customerId?this.dataService.query(a.uWB,{customerId:this.customerId}).mapSingle(({customer:n})=>n?.addresses??[]).pipe((0,U.M)(n=>{this.currentAddress&&(this.selectedAddress=n.find(t=>t.streetLine1===this.currentAddress?.streetLine1&&t.postalCode===this.currentAddress?.postalCode)),0===n.length&&(this.createNew=!0,this.useExisting=!1)})):(0,h.of)([]),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(({countries:n})=>n.items)}trackByFn(n){return n.id}addressIdFn(n){return n.streetLine1+n.postalCode}cancel(){this.resolveWith()}select(){if(this.useExisting&&this.selectedAddress&&this.resolveWith({...(0,He.U)(this.selectedAddress,["fullName","company","streetLine1","streetLine2","city","province","phoneNumber","postalCode"]),countryCode:this.selectedAddress.country.code}),this.createNew&&this.addressForm.valid){const n=this.addressForm.value;this.resolveWith(n)}}static{this.\u0275fac=function(t){return new(t||j)(e.rXU(a.uSP),e.rXU(d.ze))}}static{this.\u0275cmp=e.VBU({type:j,selectors:[["vdr-select-address-dialog"]],decls:4,vars:3,consts:[["vdrDialogTitle",""],[4,"ngIf"],["vdrDialogButtons",""],["clrTabLink",""],[3,"clrIfActiveChange","clrIfActive"],[1,"block","mt-4",3,"selectItem","idFn","selectedItemId"],[3,"item",4,"ngFor","ngForOf"],[3,"item"],[3,"address"],[3,"formGroup","availableCountries"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.DNE(0,dt,2,3,"ng-template",0)(1,ut,7,5,"clr-tabs",1),e.nI1(2,"async"),e.DNE(3,gt,6,7,"ng-template",2)),2&t&&(e.R7$(),e.Y8G("ngIf",e.bMT(2,1,o.addresses$)))},dependencies:[m.fnt,m.SE,m.NvB,m._yY,m.BXK,m.ZMF,m.Ak8,s.Sq,s.bT,d.cb,d.j4,a.bc3,a.MCd,a.W2r,a.O6k,a.b3l,a.N0N,s.Jj,g.D9],changeDetection:0})}}class E{constructor(n,t){this.dataService=n,this.formBuilder=t,this.canCreateNew=!0,this.includeNoteInput=!1,this.title=(0,p.x)("order.set-customer-for-order"),this.isLoading=!1,this.input$=new G.B,this.selectedCustomer=[],this.useExisting=!0,this.createNew=!1,this.note="",this.customerForm=this.formBuilder.group({title:"",firstName:["",d.k0.required],lastName:["",d.k0.required],phoneNumber:"",emailAddress:["",[d.k0.required,d.k0.email]]})}ngOnInit(){this.customers$=(0,Oe.x)((0,h.of)([]),this.input$.pipe((0,Ce.B)(200),(0,Re.F)(),(0,U.M)(()=>this.isLoading=!0),(0,f.n)(n=>this.dataService.customer.getCustomerList(10,0,n).mapStream(({customers:t})=>t.items).pipe((0,Me.W)(()=>(0,h.of)([])),(0,U.M)(()=>this.isLoading=!1)))))}trackByFn(n){return n.id}cancel(){this.resolveWith()}select(){if(this.useExisting&&1===this.selectedCustomer.length)this.resolveWith({...this.selectedCustomer[0],note:this.note});else if(this.createNew&&this.customerForm.valid){const n=this.customerForm.value;this.resolveWith({...n,note:this.note})}}static{this.\u0275fac=function(t){return new(t||E)(e.rXU(a.uSP),e.rXU(d.ze))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["vdr-select-customer-dialog"]],decls:6,vars:2,consts:[["customerSelect",""],["vdrDialogTitle",""],[4,"ngIf"],["class","pt-1",4,"ngIf"],["vdrDialogButtons",""],[4,"ngTemplateOutlet"],["class","mt-4",3,"label",4,"ngIf"],[1,"mt-4",3,"label"],[3,"ngModelChange","ngModel"],[1,"pt-1"],["clrTabLink",""],[3,"clrIfActiveChange","clrIfActive"],[1,"mt-4"],[3,"formGroup"],["for","title",3,"label"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label"],["id","lastName","type","text","formControlName","lastName"],["for","emailAddress",3,"label"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","phoneNumber",3,"label"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["appendTo","body","bindLabel","name",3,"ngModelChange","items","addTag","multiple","hideSelected","trackByFn","minTermLength","loading","typeahead","ngModel"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"item-row"],["shape","user",1,"is-solid"],[1,"mx-1"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&e.DNE(0,ft,2,3,"ng-template",1)(1,vt,3,2,"ng-container",2)(2,Tt,7,5,"clr-tabs",3)(3,Ot,4,11,"ng-template",null,0,e.C5r)(5,Rt,6,7,"ng-template",4),2&t&&(e.R7$(),e.Y8G("ngIf",!o.canCreateNew),e.R7$(),e.Y8G("ngIf",o.canCreateNew))},dependencies:[m.U4n,m.fnt,m.SE,m.NvB,m._yY,m.BXK,m.ZMF,m.Ak8,s.bT,s.T3,d.qT,d.me,d.BC,d.cb,d.vS,d.j4,d.JD,I.vr,I.Uq,I.ZZ,a.wux,a.KSf,a.Vr5,a.bc3,a.MCd,s.Jj,g.D9],styles:[".item-row[_ngcontent-%COMP%]{display:flex;align-items:center}clr-tabs[_ngcontent-%COMP%]{display:block}"],changeDetection:0})}}class w{ngOnInit(){this.currentSelectionId&&(this.selectedMethod=this.eligibleShippingMethods.find(n=>n.id===this.currentSelectionId))}methodIdFn(n){return n.id}cancel(){this.resolveWith()}select(){this.selectedMethod&&this.resolveWith(this.selectedMethod.id)}static{this.\u0275fac=function(t){return new(t||w)}}static{this.\u0275cmp=e.VBU({type:w,selectors:[["vdr-select-shipping-method-dialog"]],decls:4,vars:3,consts:[["vdrDialogTitle",""],[3,"selectItem","idFn","selectedItemId"],[3,"item",4,"ngFor","ngForOf"],["vdrDialogButtons",""],[3,"item"],[1,"result-details"],[3,"label"],[1,"price-row"],[3,"value",4,"ngIf"],[3,"value"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.DNE(0,St,2,3,"ng-template",0),e.j41(1,"vdr-radio-card-fieldset",1),e.bIt("selectItem",function(l){return o.selectedMethod=l}),e.DNE(2,kt,15,20,"vdr-radio-card",2),e.k0s(),e.DNE(3,Dt,6,7,"ng-template",3)),2&t&&(e.R7$(),e.Y8G("idFn",o.methodIdFn)("selectedItemId",null==o.selectedMethod?null:o.selectedMethod.id),e.R7$(),e.Y8G("ngForOf",o.eligibleShippingMethods))},dependencies:[s.Sq,s.bT,a.bc3,a.MCd,a.BPu,a.TJf,a.b3l,a.N0N,g.D9,a.uc0],changeDetection:0})}}class W{constructor(){this.nextStates=[],this.message="",this.selectedState=""}select(){this.selectedState&&this.resolveWith(this.selectedState)}cancel(){this.resolveWith()}static{this.\u0275fac=function(t){return new(t||W)}}static{this.\u0275cmp=e.VBU({type:W,selectors:[["vdr-order-state-select-dialog"]],decls:8,vars:5,consts:[["vdrDialogTitle",""],["name","state",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["vdrDialogButtons",""],[3,"value"],["type","submit","class","btn btn-secondary",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],["type","submit",1,"btn","btn-secondary",3,"click"]],template:function(t,o){1&t&&(e.DNE(0,Gt,2,3,"ng-template",0),e.j41(1,"p"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"vdr-form-field")(5,"select",1),e.mxI("ngModelChange",function(l){return e.DH7(o.selectedState,l)||(o.selectedState=l),l}),e.DNE(6,$t,4,6,"option",2),e.k0s()(),e.DNE(7,jt,6,12,"ng-template",3)),2&t&&(e.R7$(2),e.JRh(e.bMT(3,3,o.message)),e.R7$(3),e.R50("ngModel",o.selectedState),e.R7$(),e.Y8G("ngForOf",o.nextStates))},dependencies:[s.Sq,s.bT,d.xH,d.y7,d.wz,d.BC,d.vS,a.KSf,a.Vr5,a.bc3,a.MCd,g.D9,a.pzI],changeDetection:0})}}class x{constructor(n,t,o,i){this.dataService=n,this.modalService=t,this.notificationService=o,this.i18nService=i}transitionToPreModifyingState(n,t){return this.getPreModifyingState(n).pipe((0,f.n)(o=>{const i={orderId:n,nextStates:t,message:this.i18nService.translate((0,p.x)("order.unable-to-transition-to-state-try-another"),{state:o}),cancellable:!1,retry:10};return o?this.transitionToStateOrThrow(n,o).pipe((0,Me.W)(l=>this.manuallyTransitionToState(i))):this.manuallyTransitionToState(i)}))}manuallyTransitionToState(n){return this.modalService.fromComponent(W,{locals:{nextStates:n.nextStates,cancellable:n.cancellable,message:n.message},closable:!1,size:"md"}).pipe((0,f.n)(t=>{if(t)return this.transitionToStateOrThrow(n.orderId,t);if(n.cancellable)return T.w;throw new Error("An order state must be selected")}),function Be(r){return(0,Xe.N)((n,t)=>{let o,l,i=!1;const c=()=>{o=n.subscribe((0,ke._)(t,void 0,void 0,D=>{l||(l=new G.B,(0,Ve.Tg)(r(l)).subscribe((0,ke._)(t,()=>o?c():i=!0))),l&&l.next(D)})),i&&(o.unsubscribe(),o=null,i=!1,c())};c()})}(t=>t.pipe((0,qe.c)(2e3),(0,F.s)(n.retry))))}getPreModifyingState(n){return this.dataService.order.getOrderHistory(n,{filter:{type:{eq:a.Htj.ORDER_STATE_TRANSITION}},sort:{createdAt:a.xBQ.DESC}}).mapSingle(t=>t.order).pipe((0,v.T)(t=>{const o=t?.history.items.find(i=>"Modifying"===i.data.to);if(o)return o.data.from}))}transitionToStateOrThrow(n,t){return this.dataService.order.transitionToState(n,t).pipe((0,v.T)(({transitionOrderToState:o})=>{switch(o?.__typename){case"Order":return o?.state;case"OrderStateTransitionError":throw this.notificationService.error(o?.transitionError),new Error(o?.transitionError)}}))}static{this.\u0275fac=function(t){return new(t||x)(e.KVO(a.uSP),e.KVO(a.Bg8),e.KVO(a.JEu),e.KVO(a.W40))}}static{this.\u0275prov=e.jDH({token:x,factory:x.\u0275fac,providedIn:"root"})}}class Q{constructor(n,t){this.formBuilder=n,this.modalService=t,this.customFieldsConfig=[],this.customFieldValues={},this.updateClick=new e.bkB,this.editable=!1}ngOnInit(){this.customFieldForm=this.formBuilder.group({});for(const n of this.customFieldsConfig)this.customFieldForm.addControl(n.name,this.formBuilder.control(this.customFieldValues[n.name]))}onUpdateClick(){this.updateClick.emit(this.customFieldForm.value),this.customFieldForm.markAsPristine(),this.editable=!1}onCancelClick(){this.customFieldForm.dirty?this.modalService.dialog({title:(0,p.x)("catalog.confirm-cancel"),buttons:[{type:"secondary",label:(0,p.x)("common.keep-editing")},{type:"danger",label:(0,p.x)("common.discard-changes"),returnValue:!0}]}).subscribe(n=>{n&&(this.customFieldForm.reset(),this.customFieldForm.markAsPristine(),this.editable=!1)}):this.editable=!1}static{this.\u0275fac=function(t){return new(t||Q)(e.rXU(d.ze),e.rXU(a.Bg8))}}static{this.\u0275cmp=e.VBU({type:Q,selectors:[["vdr-order-custom-fields-card"]],inputs:{customFieldsConfig:"customFieldsConfig",customFieldValues:"customFieldValues"},outputs:{updateClick:"updateClick"},decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text","custom-field-form"],["entityName","Order",3,"customFields","customFieldsFormGroup","readonly","compact"],[1,"card-footer"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","pencil"],[1,"btn","btn-sm","btn-primary",3,"click","disabled"],["shape","check"],["shape","times"]],template:function(t,o){1&t&&e.DNE(0,At,11,12,"div",0),2&t&&e.Y8G("ngIf",o.customFieldsConfig.length)},dependencies:[m.U4n,s.bT,a.W4C,g.D9],styles:["vdr-custom-field-control[_ngcontent-%COMP%]{margin-bottom:6px;display:block}.custom-field-form[_ngcontent-%COMP%]     .clr-control-label{color:var(--color-grey-400)}.custom-field-form.editable[_ngcontent-%COMP%]     .clr-control-label{color:inherit}"],changeDetection:0})}}class N{constructor(){this.fulfilledCount=0,this.fulfillments=[]}ngOnChanges(n){this.line&&(this.fulfilledCount=this.getDeliveredCount(this.line),this.fulfillmentStatus=this.getFulfillmentStatus(this.fulfilledCount,this.line.quantity),this.fulfillments=this.getFulfillments(this.line))}getDeliveredCount(n){return n.fulfillmentLines?.reduce((t,o)=>t+o.quantity,0)??0}getFulfillmentStatus(n,t){return n===t?"full":0<n&&n<t?"partial":"none"}getFulfillments(n){return n.fulfillmentLines?.map(t=>{const o=this.allOrderFulfillments?.find(i=>i.id===t.fulfillmentId);if(o)return{count:t.quantity,fulfillment:o}}).filter(_.notNullOrUndefined)??[]}static{this.\u0275fac=function(t){return new(t||N)}}static{this.\u0275cmp=e.VBU({type:N,selectors:[["vdr-line-fulfillment"]],inputs:{line:"line",allOrderFulfillments:"allOrderFulfillments",orderState:"orderState"},features:[e.OA$],decls:1,vars:1,consts:[["class","search-settings-menu",4,"ngIf"],[1,"search-settings-menu"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["class","item-fulfilled","shape","check-circle",4,"ngIf"],["class","item-partially-fulfilled","shape","check-circle",4,"ngIf"],["class","item-not-fulfilled","shape","exclamation-circle",4,"ngIf"],["vdrPosition","bottom-right"],["class","dropdown-header",4,"ngIf"],["class","fulfillment-detail",4,"ngFor","ngForOf"],["shape","check-circle",1,"item-fulfilled"],["shape","check-circle",1,"item-partially-fulfilled"],["shape","exclamation-circle",1,"item-not-fulfilled"],[1,"dropdown-header"],[1,"fulfillment-detail"],[1,"fulfillment-title"],[3,"label"],[3,"label",4,"ngIf"]],template:function(t,o){1&t&&e.DNE(0,zt,10,7,"vdr-dropdown",0),2&t&&e.Y8G("ngIf",o.fulfilledCount||"PartiallyDelivered"===o.orderState)},dependencies:[m.U4n,m.aZZ,s.Sq,s.bT,a.PsF,a.qLY,a.j$H,a.BPu,g.D9,a.PU$],styles:[".item-fulfilled[_ngcontent-%COMP%]{color:var(--color-success-700)}.item-partially-fulfilled[_ngcontent-%COMP%]{color:var(--color-warning-700)}.item-not-fulfilled[_ngcontent-%COMP%]{color:var(--color-error-700)}.fulfillment-detail[_ngcontent-%COMP%]{margin:6px 12px}.fulfillment-detail[_ngcontent-%COMP%]:not(:last-of-type){border-bottom:1px dashed var(--color-component-border-200)}"],changeDetection:0})}}class R{getRefundedCount(){return(this.payments?.reduce((t,o)=>[...t,...o.refunds],[]).filter(t=>"Failed"!==t.state).reduce((t,o)=>[...t,...o.lines],[])??[]).filter(t=>t.orderLineId===this.line.id).reduce((t,o)=>t+o.quantity,0)}static{this.\u0275fac=function(t){return new(t||R)}}static{this.\u0275cmp=e.VBU({type:R,selectors:[["vdr-line-refunds"]],inputs:{line:"line",payments:"payments"},decls:1,vars:1,consts:[[3,"title",4,"ngIf"],[3,"title"],["shape","redo","dir","down",1,"is-solid"]],template:function(t,o){1&t&&e.DNE(0,Wt,3,6,"span",0),2&t&&e.Y8G("ngIf",o.getRefundedCount())},dependencies:[m.U4n,s.bT,$e.ig,g.D9],styles:["[_nghost-%COMP%]{color:var(--color-error-500)}"],changeDetection:0})}}class S extends a.Y9G{constructor(){super(...arguments),this.orderable=!1}static{this.\u0275fac=(()=>{let n;return function(o){return(n||(n=e.xGo(S)))(o||S)}})()}static{this.\u0275cmp=e.VBU({type:S,selectors:[["vdr-order-total-column"]],exportAs:["row"],features:[e.Vt3],decls:0,vars:0,template:function(t,o){},encapsulation:2})}}class A extends a.IMU{get allColumns(){return[...this.columns??[],...this.customFieldColumns??[],...this.totalColumns??[]]}getPromotionLink(n){return["/marketing","promotions",n.adjustmentSource.split(":")[1]]}getCouponCodeForAdjustment(n,t){const o=t.adjustmentSource.split(":")[1],i=n.promotions.find(l=>l.id===o);if(i)return i.couponCode||void 0}getShippingNames(n){return n.shippingLines.length?n.shippingLines.map(t=>t.shippingMethod.name).join(", "):""}static{this.\u0275fac=(()=>{let n;return function(o){return(n||(n=e.xGo(A)))(o||A)}})()}static{this.\u0275cmp=e.VBU({type:A,selectors:[["vdr-order-data-table"]],contentQueries:function(t,o,i){if(1&t&&e.wni(i,S,4),2&t){let l;e.mGM(l=e.lsd())&&(o.totalColumns=l)}},inputs:{order:"order"},features:[e.Vt3],ngContentSelectors:Zt,decls:60,vars:70,consts:[["defaultComponent",""],[1,"bulk-actions"],[1,"table-wrapper"],[1,""],[1,"heading-row"],["class","selection-col",4,"ngIf"],[3,"expand",4,"ngFor","ngForOf"],[1,"column-picker"],[3,"reorder","resetColumns","uiLanguage","columns"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","surcharge",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"sub-total"],[1,"clr-align-middle"],[1,"net-price",3,"title"],[1,"shipping"],["class","shipping-method-name",4,"ngFor","ngForOf"],[1,"total"],[1,"selection-col"],["type","checkbox","clrCheckbox","",3,"change","checked"],[1,"cell-content",3,"ngClass"],["api","dataTable","display","block",3,"locationId","metadata","topPx","leftPx"],["class","sort-toggle",4,"ngIf"],[1,"sort-toggle"],[3,"click"],["shape","two-way-arrows left",4,"ngIf"],["shape","arrow up",4,"ngIf"],["shape","arrow down",4,"ngIf"],["class","sort-label",4,"ngIf"],["shape","two-way-arrows left"],["shape","arrow up"],["shape","arrow down"],[1,"sort-label"],[1,"filter-row"],[1,"button-ghost","toggle-search-filter-row",3,"click","title"],["shape","search"],[1,"filter-row-wrapper"],[4,"ngTemplateOutlet"],[1,"filters"],["class","mt-1",3,"filterWithValue","filters",4,"ngFor","ngForOf"],["class","mt-1",3,"filters",4,"ngIf"],[1,"mt-1",3,"filterWithValue","filters"],[1,"mt-1",3,"filters"],["class","selection-col",3,"active",4,"ngIf"],[3,"active",4,"ngFor","ngForOf"],["type","checkbox","clrCheckbox","",3,"click","checked"],[4,"ngIf","ngIfElse"],[4,"ngComponentOutlet","ngComponentOutletInputs","ngComponentOutletInjector"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"emptyStateLabel"],[1,"surcharge"],["colspan","2",1,"align-middle","name","left"],[1,"align-middle","sku"],[1,"align-middle"],[1,"align-middle","total"],["class","order-adjustment",4,"ngIf"],[1,"order-adjustment"],[3,"routerLink"],[1,"shipping-method-name"]],template:function(t,o){1&t&&(e.NAR(Qt),e.j41(0,"div",1),e.SdG(1),e.k0s(),e.j41(2,"div",2)(3,"table",3)(4,"thead")(5,"tr",4),e.DNE(6,nn,2,1,"th",5)(7,sn,6,9,"th",6),e.j41(8,"th")(9,"div",7)(10,"vdr-data-table-colum-picker",8),e.nI1(11,"async"),e.bIt("reorder",function(l){return o.onColumnReorder(l)})("resetColumns",function(){return o.onColumnsReset()}),e.k0s()()()(),e.DNE(12,fn,9,13,"tr",9),e.k0s(),e.j41(13,"tbody"),e.DNE(14,In,4,4,"tr",10),e.nI1(15,"paginate"),e.qex(16),e.DNE(17,Tn,4,4,"tr",9),e.bVm(),e.DNE(18,Fn,14,14,"tr",11)(19,Rn,2,1,"ng-container",12),e.j41(20,"tr",13)(21,"td",3),e.EFF(22),e.nI1(23,"translate"),e.k0s(),e.nrm(24,"td"),e.j41(25,"td",14),e.EFF(26),e.nI1(27,"localeCurrency"),e.j41(28,"div",15),e.nI1(29,"translate"),e.EFF(30),e.nI1(31,"localeCurrency"),e.k0s()(),e.nrm(32,"td"),e.k0s(),e.j41(33,"tr",16)(34,"td",3),e.EFF(35),e.nI1(36,"translate"),e.k0s(),e.j41(37,"td"),e.DNE(38,Sn,2,1,"vdr-chip",17),e.k0s(),e.j41(39,"td",14),e.EFF(40),e.nI1(41,"localeCurrency"),e.j41(42,"div",15),e.nI1(43,"translate"),e.EFF(44),e.nI1(45,"localeCurrency"),e.k0s()(),e.nrm(46,"td"),e.k0s(),e.j41(47,"tr",18)(48,"td",3),e.EFF(49),e.nI1(50,"translate"),e.k0s(),e.nrm(51,"td"),e.j41(52,"td",14),e.EFF(53),e.nI1(54,"localeCurrency"),e.j41(55,"div",15),e.nI1(56,"translate"),e.EFF(57),e.nI1(58,"localeCurrency"),e.k0s()(),e.nrm(59,"td"),e.k0s()()()()),2&t&&(e.R7$(3),e.AVh("no-select",o.disableSelect),e.R7$(),e.AVh("items-selected",null==o.selectionManager?null:o.selectionManager.selection.length),e.R7$(2),e.Y8G("ngIf",o.selectionManager),e.R7$(),e.Y8G("ngForOf",o.visibleSortedColumns),e.R7$(3),e.Y8G("uiLanguage",e.bMT(11,30,o.uiLanguage$))("columns",o.sortedColumns),e.R7$(2),e.Y8G("ngIf",o.searchComponent||o.customSearchTemplate||(null==o.filters?null:o.filters.length)),e.R7$(2),e.Y8G("ngForOf",e.i5U(15,32,o.items,e.ziG(65,Kt,o.id,o.itemsPerPage,o.currentPage,o.totalItems)))("ngForTrackBy",o.trackByFn),e.R7$(3),e.Y8G("ngIf",!(null!=o.items&&o.items.length)),e.R7$(),e.Y8G("ngForOf",o.order.surcharges),e.R7$(),e.Y8G("ngForOf",o.order.discounts),e.R7$(3),e.JRh(e.bMT(23,35,"order.sub-total")),e.R7$(2),e.BMQ("colspan",o.visibleSortedColumns.length-2),e.R7$(2),e.SpI(" ",e.i5U(27,37,o.order.subTotalWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(29,40,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(31,42,o.order.subTotal,o.order.currencyCode)," "),e.R7$(5),e.JRh(e.bMT(36,45,"order.shipping")),e.R7$(2),e.BMQ("colspan",o.visibleSortedColumns.length-2),e.R7$(),e.Y8G("ngForOf",o.order.shippingLines),e.R7$(2),e.SpI(" ",e.i5U(41,47,o.order.shippingWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(43,50,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(45,52,o.order.shipping,o.order.currencyCode)," "),e.R7$(5),e.JRh(e.bMT(50,55,"order.total")),e.R7$(2),e.BMQ("colspan",o.visibleSortedColumns.length-2),e.R7$(2),e.SpI(" ",e.i5U(54,57,o.order.totalWithTax,o.order.currencyCode)," "),e.R7$(2),e.Y8G("title",e.bMT(56,60,"order.net-price")),e.R7$(2),e.SpI(" ",e.i5U(58,62,o.order.total,o.order.currencyCode)," "))},dependencies:[m.U4n,m.Jej,s.YU,s.OI,s.Sq,s.bT,s.T3,b.Wk,a.wux,a.Vr5,a.ONL,a.b7e,a.$Bu,a.wOo,s.Jj,Je.kf,g.D9,a.uc0],styles:["[_nghost-%COMP%]{display:block;max-width:100%;position:relative;margin-bottom:calc(var(--space-unit) * 4);container-type:inline-size}th[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-header-border);color:var(--color-weight-700);font-size:var(--font-size-xs);font-weight:600;text-transform:uppercase;position:relative;white-space:nowrap;background-color:transparent}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:calc(var(--space-unit) * 1.5) calc(var(--space-unit) * 1);color:var(--color-text-100)}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{text-align:center}@media screen and (min-width: 992px){tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{padding-inline-start:var(--surface-margin-left);text-align:start}}th[_ngcontent-%COMP%]:last-of-type, td[_ngcontent-%COMP%]:last-of-type{border-inline-end:1px solid var(--color-table-header-border)}tr[_ngcontent-%COMP%]:first-of-type   th[_ngcontent-%COMP%]:last-of-type{border-image:linear-gradient(0deg,var(--color-table-header-border),transparent) 1}tr[_ngcontent-%COMP%]:last-of-type   td[_ngcontent-%COMP%]:last-of-type{border-image:linear-gradient(180deg,var(--color-table-header-border),transparent) 1}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-row-separator)}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--color-table-row-hover-bg)}.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 5);background-color:var(--color-surface-bg);z-index:10;display:flex;position:absolute;top:5px;height:40px}@media screen and (min-width: 992px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 8.5)}}@media screen and (min-width: 1280px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 10.5)}}.table-wrapper[_ngcontent-%COMP%]{display:block;overflow-y:hidden;overflow-x:auto;position:relative;width:100%;max-width:var(--surface-width)}table[_ngcontent-%COMP%]{width:100%}table.no-select[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.column-picker[_ngcontent-%COMP%]{width:24px}.sort-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;margin-inline-start:calc(var(--space-unit) * .5)}.sort-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;border-radius:var(--border-radius-lg);color:var(--color-weight-500);padding:0 2px;cursor:pointer;background-color:transparent}.sort-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:var(--color-primary-700)}.sort-toggle[_ngcontent-%COMP%]   .sort-label[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * .5);font-size:10px;color:var(--color-primary-600);font-weight:400}.toggle-search-filter-row[_ngcontent-%COMP%]{position:absolute;top:-12px;left:4px}@media screen and (min-width: 1280px){.toggle-search-filter-row[_ngcontent-%COMP%]{left:8px}}.toggle-search-filter-row.active[_ngcontent-%COMP%]{background-color:var(--color-primary-700);color:var(--color-primary-100);border-color:var(--color-primary-700)}th.filter-row[_ngcontent-%COMP%]{position:relative;font-size:var(--font-size-base);font-weight:400;background-color:var(--color-weight-100);box-shadow:var(--data-table-filter-box-shadow);border-left-width:0;border-right-width:0;text-align:initial;padding:0}th.filter-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}th.filter-row.active[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-header-border)}th.filter-row[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{margin-top:calc(var(--space-unit) * 1);display:flex;flex-wrap:wrap;gap:calc(var(--space-unit) * .5)}.filter-row-wrapper[_ngcontent-%COMP%]{padding:calc(var(--space-unit) * 4);padding-inline-start:0;max-height:150px;transition:max-height .2s,padding .2s,opacity .2s}.filter-row-wrapper.hidden[_ngcontent-%COMP%]{max-height:0px;padding-top:0;padding-bottom:0;overflow:hidden;opacity:0}.cell-link[_ngcontent-%COMP%]{display:block;width:100%;height:100%}td.active[_ngcontent-%COMP%]{background-color:var(--color-table-row-active-bg)}.cell-content[_ngcontent-%COMP%]{display:flex;align-items:center;line-height:var(--font-size-sm);color:var(--color-weight-700)}.cell-content.left[_ngcontent-%COMP%]{justify-content:flex-start}.cell-content.center[_ngcontent-%COMP%]{justify-content:center}.cell-content.right[_ngcontent-%COMP%]{justify-content:flex-end}.selection-col[_ngcontent-%COMP%]{width:calc(var(--space-unit) * 8)}vdr-empty-placeholder[_ngcontent-%COMP%]{width:100%}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;margin-top:var(--space-unit);margin-inline-start:var(--surface-margin-left);margin-inline-end:var(--space-unit)}.total-items-count[_ngcontent-%COMP%]{font-size:var(--font-size-xs)}@container (max-width: 500px){.total-items-count[_ngcontent-%COMP%]{display:none}}","[_nghost-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}[_nghost-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}[_nghost-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}[_nghost-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}[_nghost-%COMP%]   .promotions-label[_ngcontent-%COMP%]{text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}[_nghost-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}[_nghost-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}"],changeDetection:0})}}class M{constructor(){this.isDraft=!1,this.adjust=new e.bkB,this.remove=new e.bkB,this.orderLineCustomFieldsVisible=!1,this.customFieldsForLine={}}get visibleOrderLineCustomFields(){return this.orderLineCustomFieldsVisible?this.orderLineCustomFields:[]}get showElided(){return!this.orderLineCustomFieldsVisible&&0<this.orderLineCustomFields.length}ngOnInit(){this.orderLineCustomFieldsVisible=this.orderLineCustomFields.length<2,this.getLineCustomFields()}draftInputBlur(n,t){n.quantity!==t&&this.adjust.emit({lineId:n.id,quantity:t})}toggleOrderLineCustomFields(){this.orderLineCustomFieldsVisible=!this.orderLineCustomFieldsVisible}getLineDiscounts(n){return n.discounts.filter(t=>t.type===a.mni.PROMOTION)}getLineCustomFields(){for(const n of this.order.lines){const t=new d.J3({}),o=this.orderLineCustomFields.map(i=>{const l=n.customFields[i.name];return t.addControl(i.name,new d.hs(l)),{config:i,formGroup:t,value:l}}).filter(i=>!!this.orderLineCustomFieldsVisible||null!=i.value);this.customFieldsForLine[n.id]=o}}getPromotionLink(n){return["/marketing","promotions",n.adjustmentSource.split(":")[1]]}getCouponCodeForAdjustment(n,t){const o=t.adjustmentSource.split(":")[1],i=n.promotions.find(l=>l.id===o);if(i)return i.couponCode||void 0}getShippingNames(n){return n.shippingLines.length?n.shippingLines.map(t=>t.shippingMethod.name).join(", "):""}static{this.\u0275fac=function(t){return new(t||M)}}static{this.\u0275cmp=e.VBU({type:M,selectors:[["vdr-order-table"]],inputs:{order:"order",orderLineCustomFields:"orderLineCustomFields",isDraft:"isDraft"},outputs:{adjust:"adjust",remove:"remove"},decls:29,vars:36,consts:[["imagePlaceholder",""],["draft",""],["qtyInput",""],["id","order-detail-list",3,"items","order"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","image",3,"heading"],["id","product-name",3,"heading"],["id","product-sku",3,"heading","optional"],["id","unit-price",3,"heading"],["id","quantity",3,"heading","optional"],[3,"customField",4,"ngFor","ngForOf"],["id","total",3,"heading","optional"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],[3,"src"],[1,"placeholder"],["shape","image","size","48"],[1,"unit-price"],[1,"net-price",3,"title"],[4,"ngIf","ngIfElse"],[3,"line","payments"],[3,"line","orderState","allOrderFulfillments"],[1,"flex"],["class","order-placed-quantity",3,"title",4,"ngIf"],[1,"order-placed-quantity",3,"title"],["type","number","min","0",1,"draft-qty",3,"blur","value"],[1,"icon-button",3,"click"],["shape","trash"],[3,"customField"],[4,"ngIf"],["vdrDropdownTrigger","",1,"promotions-label"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-name",3,"routerLink"],[1,"promotion-amount"]],template:function(t,o){1&t&&(e.j41(0,"vdr-order-data-table",3)(1,"vdr-dt2-column",4),e.nI1(2,"translate"),e.DNE(3,Mn,1,1,"ng-template"),e.k0s(),e.j41(4,"vdr-dt2-column",5),e.nI1(5,"translate"),e.DNE(6,kn,2,4,"ng-template"),e.k0s(),e.j41(7,"vdr-dt2-column",6),e.nI1(8,"translate"),e.DNE(9,Dn,2,4,"ng-template"),e.k0s(),e.j41(10,"vdr-dt2-column",7),e.nI1(11,"translate"),e.DNE(12,Pn,4,2,"ng-template"),e.k0s(),e.j41(13,"vdr-dt2-column",8),e.nI1(14,"translate"),e.DNE(15,jn,1,1,"ng-template"),e.k0s(),e.j41(16,"vdr-dt2-column",9),e.nI1(17,"translate"),e.DNE(18,En,1,1,"ng-template"),e.k0s(),e.j41(19,"vdr-dt2-column",10),e.nI1(20,"translate"),e.DNE(21,wn,7,11,"ng-template"),e.k0s(),e.j41(22,"vdr-dt2-column",11),e.nI1(23,"translate"),e.DNE(24,Ln,5,7,"ng-template"),e.k0s(),e.DNE(25,Vn,1,1,"vdr-dt2-custom-field-column",12),e.j41(26,"vdr-order-total-column",13),e.nI1(27,"translate"),e.DNE(28,Un,8,12,"ng-template"),e.k0s()()),2&t&&(e.Y8G("items",o.order.lines)("order",o.order),e.R7$(),e.Y8G("heading",e.bMT(2,18,"common.id"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(5,20,"common.created-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(8,22,"common.updated-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(11,24,"common.image")),e.R7$(3),e.Y8G("heading",e.bMT(14,26,"order.product-name")),e.R7$(3),e.Y8G("heading",e.bMT(17,28,"order.product-sku"))("optional",!1),e.R7$(3),e.Y8G("heading",e.bMT(20,30,"order.unit-price")),e.R7$(3),e.Y8G("heading",e.bMT(23,32,"order.quantity"))("optional",!1),e.R7$(3),e.Y8G("ngForOf",o.orderLineCustomFields),e.R7$(),e.Y8G("heading",e.bMT(27,34,"order.total"))("optional",!1))},dependencies:[m.U4n,s.Sq,s.bT,b.Wk,a.Vr5,a.PsF,a.qLY,a.j$H,a.Y9G,a.TnO,N,R,A,S,g.D9,a.HlS,a.PU$,a.uc0],styles:["[_nghost-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}[_nghost-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}[_nghost-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}[_nghost-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}[_nghost-%COMP%]   .promotions-label[_ngcontent-%COMP%]{text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}[_nghost-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}[_nghost-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}  .line-promotion{display:flex;justify-content:space-between;padding:6px 12px}  .line-promotion .promotion-amount{margin-inline-start:12px}  .line-promotion .net-price{font-size:11px;color:var(--color-text-300)}"],changeDetection:0})}}class Z{constructor(n){this.dataService=n,this.addItem=new e.bkB,this.customFieldsFormGroup=new d.J3({}),this.selectedVariantId$=new G.B,this.quantity=1}ngOnInit(){this.selectedVariant$=this.selectedVariantId$.pipe((0,f.n)(n=>n?this.dataService.product.getProductVariant(n).mapSingle(({productVariant:t})=>t):[void 0]));for(const n of this.orderLineCustomFields)this.customFieldsFormGroup.addControl(n.name,new d.hs(""))}addItemClick(n){n&&(this.addItem.emit({productVariantId:n.id,quantity:this.quantity,customFields:this.orderLineCustomFields.length?this.customFieldsFormGroup.value:void 0}),this.selectedVariantId$.next(void 0),this.customFieldsFormGroup.reset())}static{this.\u0275fac=function(t){return new(t||Z)(e.rXU(a.uSP))}}static{this.\u0275cmp=e.VBU({type:Z,selectors:[["vdr-draft-order-variant-selector"]],inputs:{currencyCode:"currencyCode",orderLineCustomFields:"orderLineCustomFields"},outputs:{addItem:"addItem"},decls:8,vars:6,consts:[[1,"card"],[1,"card-block"],[1,"card-title"],[3,"productSelected"],["class","card-block",4,"ngIf"],[1,"variant-details"],[1,"mr-2",3,"src"],[1,"details"],[1,"small"],[1,"details","ml-4"],[1,"flex-spacer"],[1,"small",3,"title"],["type","number","min","0",3,"ngModelChange","disabled","ngModel"],[1,"btn","btn-small","btn-primary",3,"click","disabled"],[4,"ngIf"],["class","custom-field",4,"ngFor","ngForOf"],[1,"custom-field"],[3,"compact","readonly","customField","customFieldsFormGroup"]],template:function(t,o){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"h4",2),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"vdr-product-variant-selector",3),e.bIt("productSelected",function(l){return o.selectedVariantId$.next(l.productVariantId)}),e.k0s()(),e.DNE(6,zn,31,32,"div",4),e.nI1(7,"async"),e.k0s()),2&t&&(e.R7$(3),e.JRh(e.bMT(4,2,"order.add-item-to-order")),e.R7$(3),e.Y8G("ngIf",e.bMT(7,4,o.selectedVariant$)))},dependencies:[s.Sq,s.bT,d.me,d.Q0,d.BC,d.VZ,d.vS,a.Cd_,a.Vr5,a.hJF,s.Jj,g.D9,a.HlS,a.uc0],styles:[".variant-details[_ngcontent-%COMP%]{display:flex;align-items:center}.variant-details[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img);width:32px;height:32px}.variant-details[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{font-size:.65rem;line-height:.7rem}.variant-details[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:48px;margin:0 6px}.variant-details[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300)}"],changeDetection:0})}}class K extends a.wi7{constructor(n,t,o,i,l){super(),this.changeDetector=n,this.dataService=t,this.notificationService=o,this.modalService=i,this.orderTransitionService=l,this.customFields=this.getCustomFieldConfig("Order"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.detailForm=new d.J3({}),this.fetchHistory=new G.B,this.displayCouponCodeInput=!1}ngOnInit(){this.init(),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.eligibleShippingMethods$=this.entity$.pipe((0,f.n)(n=>this.dataService.order.getDraftOrderEligibleShippingMethods(n.id).mapSingle(({eligibleShippingMethodsForDraftOrder:t})=>t)))}ngOnDestroy(){this.destroy()}addItemToOrder(n){this.dataService.order.addItemToDraftOrder(this.id,n).subscribe(t=>{"Order"!==t.addItemToDraftOrder.__typename&&this.notificationService.error(t.addItemToDraftOrder.message)})}adjustOrderLine(n){this.dataService.order.adjustDraftOrderLine(this.id,{orderLineId:n.lineId,quantity:n.quantity}).subscribe(t=>{"Order"!==t.adjustDraftOrderLine.__typename&&this.notificationService.error(t.adjustDraftOrderLine.message)})}removeOrderLine(n){this.dataService.order.removeDraftOrderLine(this.id,n.lineId).subscribe(t=>{"Order"!==t.removeDraftOrderLine.__typename&&this.notificationService.error(t.removeDraftOrderLine.message)})}getOrderAddressLines(n){return n?Object.values(n).filter(t=>"OrderAddress"!==t).filter(t=>!!t):[]}setCustomer(){this.modalService.fromComponent(E).subscribe(n=>{if(this.hasId(n))this.dataService.order.setCustomerForDraftOrder(this.id,{customerId:n.id}).subscribe();else if(n){const{note:t,...o}=n;this.dataService.order.setCustomerForDraftOrder(this.id,{input:o}).subscribe()}})}setShippingAddress(){this.entity$.pipe((0,F.s)(1),(0,f.n)(n=>this.modalService.fromComponent(j,{locals:{customerId:n.customer?.id,currentAddress:n.shippingAddress??void 0}}))).subscribe(n=>{n&&this.dataService.order.setDraftOrderShippingAddress(this.id,n).subscribe()})}setBillingAddress(){this.entity$.pipe((0,F.s)(1),(0,f.n)(n=>this.modalService.fromComponent(j,{locals:{customerId:n.customer?.id,currentAddress:n.billingAddress??void 0}}))).subscribe(n=>{n&&this.dataService.order.setDraftOrderBillingAddress(this.id,n).subscribe()})}applyCouponCode(n){this.dataService.order.applyCouponCodeToDraftOrder(this.id,n).subscribe()}removeCouponCode(n){this.dataService.order.removeCouponCodeFromDraftOrder(this.id,n).subscribe()}setShippingMethod(){(0,Ye.z)(this.entity$,this.eligibleShippingMethods$).pipe((0,F.s)(1),(0,f.n)(([n,t])=>this.modalService.fromComponent(w,{locals:{eligibleShippingMethods:t,currencyCode:n.currencyCode,currentSelectionId:n.shippingLines?.[0]?.shippingMethod.id}}))).subscribe(n=>{n&&this.dataService.order.setDraftOrderShippingMethod(this.id,n).subscribe()})}updateCustomFields(n){this.dataService.order.updateOrderCustomFields({id:this.id,customFields:n}).subscribe()}deleteOrder(){this.dataService.order.deleteDraftOrder(this.id).subscribe(({deleteDraftOrder:n})=>{n.result===a.syg.DELETED?(this.notificationService.success((0,p.x)("common.notify-delete-success"),{entity:"Order"}),this.router.navigate(["/orders"])):n.message&&this.notificationService.error(n.message)})}completeOrder(){this.dataService.order.transitionToState(this.id,"ArrangingPayment").subscribe(({transitionOrderToState:n})=>{"Order"===n?.__typename?this.router.navigate(["/orders",this.id]):"OrderStateTransitionError"===n?.__typename&&this.notificationService.error(n.transitionError)})}hasId(n){return"object"==typeof n&&!!n.id}setFormValues(n){}static{this.\u0275fac=function(t){return new(t||K)(e.rXU(e.gRc),e.rXU(a.uSP),e.rXU(a.JEu),e.rXU(a.Bg8),e.rXU(x))}}static{this.\u0275cmp=e.VBU({type:K,selectors:[["vdr-draft-order-detail"]],features:[e.Vt3],decls:5,vars:6,consts:[[4,"ngIf"],[1,"flex","clr-align-items-center"],[3,"state"],["locationId","draft-order-detail"],[1,"btn","btn-primary",3,"click","disabled"],["shape","check"],["locationId","draft-order-detail",3,"alwaysShow"],["type","button","vdrDropdownItem","",3,"click"],["shape","trash",1,"is-danger"],[3,"title"],["vdrCardControls",""],["class","block mb-2",3,"customer",4,"ngIf"],[1,"button-small",3,"click"],["class","block mb-2",3,"address",4,"ngIf"],[1,"button-small","mr-2",3,"click"],[4,"ngFor","ngForOf"],["class","button-small",3,"click",4,"ngIf"],[3,"entity",4,"ngIf"],[3,"addItem","orderLineCustomFields","currencyCode"],[3,"adjust","remove","order","orderLineCustomFields","isDraft"],["locationId","draft-order-detail",3,"entity$","detailForm"],[3,"updateClick","customFieldsConfig","customFieldValues"],["shape","unknown-status","class","is-warning",4,"ngIf"],["shape","check","class","is-success",4,"ngIf"],["shape","unknown-status",1,"is-warning"],["shape","check",1,"is-success"],[1,"block","mb-2",3,"customer"],[1,"block","mb-2",3,"address"],[3,"addCouponCode","removeCouponCode","couponCodes"],[3,"entity"],[1,"table"]],template:function(t,o){1&t&&(e.j41(0,"vdr-page-block"),e.DNE(1,Wn,15,9,"vdr-action-bar",0),e.nI1(2,"async"),e.k0s(),e.DNE(3,fr,42,43,"vdr-page-detail-layout",0),e.nI1(4,"async")),2&t&&(e.R7$(),e.Y8G("ngIf",e.bMT(2,2,o.entity$)),e.R7$(2),e.Y8G("ngIf",e.bMT(4,4,o.entity$)))},dependencies:[m.U4n,m.aZZ,s.Sq,s.bT,a.nGW,a.wL$,a.TXc,a.lST,a.Eb9,a.Mrl,a.Fam,a.W2r,a.TcB,a.Loz,a.eH4,a.ERS,a.c5c,a.eCv,a.iby,a.aVo,Q,M,Z,P,s.Jj,s.m1,g.D9,a.uc0],changeDetection:0})}}class ee{constructor(n,t){this.dataService=n,this.changeDetector=t,this.fulfillmentHandlerControl=new d.hs,this.fulfillmentQuantities={}}ngOnInit(){this.dataService.settings.getGlobalSettings().single$.subscribe(({globalSettings:n})=>{this.fulfillmentQuantities=this.order.lines.reduce((t,o)=>{const i=this.getFulfillableCount(o,n.trackInventory);return{...t,[o.id]:{fulfillCount:i,max:i}}},{}),this.changeDetector.markForCheck()}),this.dataService.shippingMethod.getShippingMethodOperations().mapSingle(n=>n.fulfillmentHandlers).subscribe(n=>{this.fulfillmentHandlerDef=n.find(t=>t.code===this.order.shippingLines[0]?.shippingMethod?.fulfillmentHandlerCode)||n[0],this.fulfillmentHandler=(0,a.N9n)(this.fulfillmentHandlerDef),this.fulfillmentHandlerControl.patchValue(this.fulfillmentHandler),this.changeDetector.markForCheck()})}getFulfillableCount(n,t){const{trackInventory:o,stockOnHand:i}=n.productVariant,l=o===a.uQg.INHERIT?t:o===a.uQg.TRUE,c=this.getUnfulfilledCount(n);return l?Math.min(c,i):c}getUnfulfilledCount(n){const t=this.order.fulfillments?.filter(o=>"Cancelled"!==o.state).map(o=>o.lines).flat().filter(o=>o.orderLineId===n.id).reduce((o,i)=>o+i.quantity,0)??0;return n.quantity-t}canSubmit(){const n=Object.values(this.fulfillmentQuantities).reduce((i,{fulfillCount:l})=>i+l,0),t=Object.values(this.fulfillmentQuantities).every(({fulfillCount:i,max:l})=>i<=l);return(0,a.yav)(this.fulfillmentHandlerDef,this.fulfillmentHandlerControl.value)&&this.fulfillmentHandlerControl.valid&&0<n&&t}select(){const n=Object.entries(this.fulfillmentQuantities).map(([t,{fulfillCount:o}])=>({orderLineId:t,quantity:o}));this.resolveWith({lines:n,handler:(0,a.GfA)(this.fulfillmentHandler,this.fulfillmentHandlerControl.value)})}cancel(){this.resolveWith()}static{this.\u0275fac=function(t){return new(t||ee)(e.rXU(a.uSP),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:ee,selectors:[["vdr-fulfill-order-dialog"]],decls:34,vars:29,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-table"],[1,"table"],["class","order-line",3,"ignore",4,"ngFor","ngForOf"],[1,"shipping-details"],[3,"address"],[3,"operationDefinition","operation","formControl","removable"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"disabled","ngModel","max","ngModelChange",4,"ngIf"],[3,"src"],["type","number","min","0",3,"ngModelChange","disabled","ngModel","max"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.DNE(0,_r,2,3,"ng-template",0),e.j41(1,"div",1)(2,"div",2)(3,"table",3)(4,"thead")(5,"tr"),e.nrm(6,"th"),e.j41(7,"th"),e.EFF(8),e.nI1(9,"translate"),e.k0s(),e.j41(10,"th"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"th"),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"th"),e.EFF(17),e.nI1(18,"translate"),e.k0s(),e.j41(19,"th"),e.EFF(20),e.nI1(21,"translate"),e.k0s()()(),e.DNE(22,br,13,8,"tr",4),e.k0s()(),e.j41(23,"div",5),e.nrm(24,"vdr-formatted-address",6),e.j41(25,"h6"),e.EFF(26),e.nI1(27,"translate"),e.k0s(),e.EFF(28),e.j41(29,"strong"),e.EFF(30),e.nI1(31,"localeCurrency"),e.k0s(),e.nrm(32,"vdr-configurable-input",7),e.k0s()(),e.DNE(33,yr,6,7,"ng-template",8)),2&t&&(e.R7$(8),e.JRh(e.bMT(9,14,"order.product-name")),e.R7$(3),e.JRh(e.bMT(12,16,"order.product-sku")),e.R7$(3),e.JRh(e.bMT(15,18,"order.unfulfilled")),e.R7$(3),e.JRh(e.bMT(18,20,"catalog.stock-on-hand")),e.R7$(3),e.JRh(e.bMT(21,22,"order.fulfill")),e.R7$(2),e.Y8G("ngForOf",o.order.lines),e.R7$(2),e.Y8G("address",o.order.shippingAddress),e.R7$(2),e.JRh(e.bMT(27,24,"order.shipping-method")),e.R7$(2),e.SpI(" ",null==o.order.shippingLines[0]||null==o.order.shippingLines[0].shippingMethod?null:o.order.shippingLines[0].shippingMethod.name," "),e.R7$(2),e.JRh(e.i5U(31,26,o.order.shipping,o.order.currencyCode)),e.R7$(2),e.Y8G("operationDefinition",o.fulfillmentHandlerDef)("operation",o.fulfillmentHandler)("formControl",o.fulfillmentHandlerControl)("removable",!1))},dependencies:[s.Sq,s.bT,d.me,d.Q0,d.BC,d.VZ,d.zX,d.vS,d.l_,a.hfX,a.Vr5,a.bc3,a.MCd,a.W2r,g.D9,a.HlS,a.uc0],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}[_nghost-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}[_nghost-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}[_nghost-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}[_nghost-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}[_nghost-%COMP%]   .promotions-label[_ngcontent-%COMP%]{text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}[_nghost-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}[_nghost-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:24px}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:0;margin-inline-start:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]   clr-input-container[_ngcontent-%COMP%]{margin-top:24px}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}"],changeDetection:0})}}class k{static{this.\u0275fac=function(t){return new(t||k)}}static{this.\u0275cmp=e.VBU({type:k,selectors:[["vdr-simple-item-list"]],inputs:{items:"items"},decls:3,vars:1,consts:[[1,"items-list"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],["class","quantity",4,"ngIf"],["shape","times","size","12",4,"ngIf"],[1,"quantity"],["shape","times","size","12"]],template:function(t,o){1&t&&(e.j41(0,"div",0)(1,"ul"),e.DNE(2,Tr,4,4,"li",1),e.k0s()()),2&t&&(e.R7$(2),e.Y8G("ngForOf",o.items))},dependencies:[m.U4n,s.Sq,s.bT],styles:[".items-list[_ngcontent-%COMP%]{font-size:12px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:6px;list-style-type:none;margin-inline-start:2px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{line-height:14px;text-overflow:ellipsis;overflow:hidden}.items-list[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{min-width:16px;display:inline-block}"],changeDetection:0})}}class Y{constructor(n){this.serverConfigService=n,this.customFieldConfig=[],this.customFieldFormGroup=new d.J3({})}ngOnInit(){this.customFieldConfig=this.serverConfigService.getCustomFieldsFor("Fulfillment")}ngOnChanges(n){this.buildCustomFieldsFormGroup()}get fulfillment(){return this.order.fulfillments&&this.order.fulfillments.find(n=>n.id===this.fulfillmentId)}get items(){return this.fulfillment?.lines.map(n=>({name:this.order.lines.find(t=>t.id===n.orderLineId)?.productVariant.name??"",quantity:n.quantity}))??[]}buildCustomFieldsFormGroup(){const n=this.fulfillment.customFields;for(const t of this.serverConfigService.getCustomFieldsFor("Fulfillment"))this.customFieldFormGroup.addControl(t.name,new d.hs(n[t.name]))}customFieldIsObject(n){return Array.isArray(n)||(0,_.isObject)(n)}static{this.\u0275fac=function(t){return new(t||Y)(e.rXU(a.BBL))}}static{this.\u0275cmp=e.VBU({type:Y,selectors:[["vdr-fulfillment-detail"]],inputs:{fulfillmentId:"fulfillmentId",order:"order"},features:[e.OA$],decls:12,vars:17,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"items"],[4,"ngFor","ngForOf"],[3,"readonly","compact","customField","customFieldsFormGroup",4,"ngIf"],[3,"readonly","compact","customField","customFieldsFormGroup"]],template:function(t,o){1&t&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.nI1(3,"localeDate"),e.k0s(),e.j41(4,"vdr-labeled-data",0),e.nI1(5,"translate"),e.EFF(6),e.k0s(),e.DNE(7,Fr,3,4,"vdr-labeled-data",1),e.j41(8,"vdr-labeled-data",0),e.nI1(9,"translate"),e.nrm(10,"vdr-simple-item-list",2),e.k0s(),e.DNE(11,Or,2,1,"ng-container",3)),2&t&&(e.Y8G("label",e.bMT(1,8,"common.created-at")),e.R7$(2),e.SpI(" ",e.i5U(3,10,null==o.fulfillment?null:o.fulfillment.createdAt,"medium"),"\n"),e.R7$(2),e.Y8G("label",e.bMT(5,13,"order.fulfillment-method")),e.R7$(2),e.SpI(" ",null==o.fulfillment?null:o.fulfillment.method,"\n"),e.R7$(),e.Y8G("ngIf",null==o.fulfillment?null:o.fulfillment.trackingCode),e.R7$(),e.Y8G("label",e.bMT(9,15,"order.contents")),e.R7$(2),e.Y8G("items",o.items),e.R7$(),e.Y8G("ngForOf",o.customFieldConfig))},dependencies:[s.Sq,s.bT,a.Cd_,a.BPu,k,g.D9,a.PU$],changeDetection:0})}}class te{get chipColorType(){switch(this.state){case"Pending":case"Shipped":return"warning";case"Delivered":return"success";case"Cancelled":return"error"}}static{this.\u0275fac=function(t){return new(t||te)}}static{this.\u0275cmp=e.VBU({type:te,selectors:[["vdr-fulfillment-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(t,o){1&t&&(e.j41(0,"vdr-chip",0),e.nI1(1,"translate"),e.DNE(2,Rr,1,0,"clr-icon",1),e.EFF(3),e.nI1(4,"stateI18nToken"),e.nI1(5,"translate"),e.k0s()),2&t&&(e.Y8G("title",e.bMT(1,4,"order.payment-state"))("colorType",o.chipColorType),e.R7$(2),e.Y8G("ngIf","Delivered"===o.state),e.R7$(),e.SpI(" ",e.bMT(5,8,e.bMT(4,6,o.state)),"\n"))},dependencies:[m.U4n,s.bT,a.wux,g.D9,a.pzI],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0})}}class ne{constructor(){this.transitionState=new e.bkB}nextSuggestedState(){if(!this.fulfillment)return;const{nextStates:n}=this.fulfillment,t=o=>n.includes(o)?o:n[0];switch(this.fulfillment?.state){case"Pending":return t("Shipped");case"Shipped":return t("Delivered");default:return n.find(o=>"Cancelled"!==o)}}nextOtherStates(){if(!this.fulfillment)return[];const n=this.nextSuggestedState();return this.fulfillment.nextStates.filter(t=>t!==n)}static{this.\u0275fac=function(t){return new(t||ne)}}static{this.\u0275cmp=e.VBU({type:ne,selectors:[["vdr-fulfillment-card"]],inputs:{fulfillment:"fulfillment",order:"order"},outputs:{transitionState:"transitionState"},decls:10,vars:6,consts:[["cancel",""],[1,"card"],[1,"card-header","fulfillment-header"],[1,"fulfillment-state"],[3,"state"],[1,"card-block"],[3,"fulfillmentId","order",4,"ngIf"],["class","card-footer",4,"ngIf"],[3,"fulfillmentId","order"],[1,"card-footer"],[4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary",3,"click"],["type","button","vdrDropdownItem","",3,"click"],[4,"ngIf","ngIfElse"],["shape","step-forward-2"],["shape","error-standard",1,"is-error"]],template:function(t,o){1&t&&(e.j41(0,"div",1)(1,"div",2)(2,"div"),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",3),e.nrm(6,"vdr-fulfillment-state-label",4),e.k0s()(),e.j41(7,"div",5),e.DNE(8,Sr,1,2,"vdr-fulfillment-detail",6),e.k0s(),e.DNE(9,$r,7,2,"div",7),e.k0s()),2&t&&(e.R7$(3),e.JRh(e.bMT(4,4,"order.fulfillment")),e.R7$(3),e.Y8G("state",null==o.fulfillment?null:o.fulfillment.state),e.R7$(2),e.Y8G("ngIf",!!o.fulfillment),e.R7$(),e.Y8G("ngIf",null==o.fulfillment?null:o.fulfillment.nextStates.length))},dependencies:[m.U4n,s.Sq,s.bT,a.PsF,a.qLY,a.j$H,a.Mrl,Y,te,g.D9,a.pzI],styles:[".fulfillment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}"],changeDetection:0})}}class re{constructor(){this.addedItems=new Map,this.removedItems=new Map,this.modifiedItems=new Set}ngOnChanges(){const{added:n,removed:t,modified:o}=this.getModifiedLines();this.addedItems=n,this.removedItems=t,this.modifiedItems=o}getSurcharge(n){return this.order.surcharges.find(t=>t.id===n)}getAddedItems(){return[...this.addedItems.entries()].map(([n,t])=>({name:n.productVariant.name,quantity:t}))}getRemovedItems(){return[...this.removedItems.entries()].map(([n,t])=>({name:n.productVariant.name,quantity:t}))}getModifiedItems(){return[...this.modifiedItems].map(n=>({name:n.productVariant.name}))}getModifiedLines(){const n=new Map,t=new Map,o=new Set;for(const i of this.modification.lines||[]){const l=this.order.lines.find(c=>c.id===i.orderLineId);l&&(0===i.quantity?o.add(l):i.quantity<0?t.set(l,-i.quantity):n.set(l,i.quantity))}return{added:n,removed:t,modified:o}}static{this.\u0275fac=function(t){return new(t||re)}}static{this.\u0275cmp=e.VBU({type:re,selectors:[["vdr-modification-detail"]],inputs:{order:"order",modification:"modification"},features:[e.OA$],decls:8,vars:9,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],[3,"items"]],template:function(t,o){1&t&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s(),e.DNE(3,Pr,3,4,"vdr-labeled-data",1)(4,jr,4,8,"vdr-labeled-data",2)(5,Er,3,4,"vdr-labeled-data",1)(6,wr,3,4,"vdr-labeled-data",1)(7,Nr,3,4,"vdr-labeled-data",1)),2&t&&(e.Y8G("label",e.bMT(1,7,"common.ID")),e.R7$(2),e.JRh(o.modification.id),e.R7$(),e.Y8G("ngIf",o.modification.note),e.R7$(),e.Y8G("ngForOf",o.modification.surcharges),e.R7$(),e.Y8G("ngIf",o.getAddedItems().length),e.R7$(),e.Y8G("ngIf",o.getRemovedItems().length),e.R7$(),e.Y8G("ngIf",o.getModifiedItems().length))},dependencies:[s.Sq,s.bT,a.BPu,k,g.D9,a.uc0],changeDetection:0})}}const Te=72;class L{constructor(n){this.elementRef=n,this.active$=new ye.t(!1),this.activeTarget$=new ye.t(!1),this.isCancellable=!1,this.cancelledState="Cancelled"}ngOnChanges(n){this.isCancellable=!!this.node.to.find(t=>"Cancelled"===t.name),n.active&&this.active$.next(this.active)}getPos(n="top"){this.elementRef.nativeElement.getBoundingClientRect();const o=this.elementRef.nativeElement.querySelector(".node")?.getBoundingClientRect().height??0;return{x:10,y:this.index*Te+("bottom"===n?o:0)}}getStyle(){const n=this.getPos();return{"top.px":n.y,"left.px":n.x}}static{this.\u0275fac=function(t){return new(t||L)(e.rXU(e.aKT))}}static{this.\u0275cmp=e.VBU({type:L,selectors:[["vdr-order-process-node"]],inputs:{node:"node",index:"index",active:"active"},features:[e.OA$],decls:8,vars:15,consts:[[1,"node-wrapper",3,"ngStyle"],[1,"node"],["class","cancelled-wrapper",4,"ngIf"],[1,"cancelled-wrapper"],[1,"cancelled-edge"],["shape","dot-circle"],[1,"cancelled-node"]],template:function(t,o){1&t&&(e.j41(0,"div",0),e.nI1(1,"async"),e.j41(2,"div",1),e.nI1(3,"async"),e.EFF(4),e.nI1(5,"stateI18nToken"),e.nI1(6,"translate"),e.k0s(),e.DNE(7,Ar,7,5,"div",2),e.k0s()),2&t&&(e.AVh("active",e.bMT(1,7,o.active$)),e.Y8G("ngStyle",o.getStyle()),e.R7$(2),e.AVh("active-target",e.bMT(3,9,o.activeTarget$)),e.R7$(2),e.SpI(" ",e.bMT(6,13,e.bMT(5,11,o.node.name))," "),e.R7$(3),e.Y8G("ngIf",o.isCancellable))},dependencies:[m.U4n,s.bT,s.B3,s.Jj,g.D9,a.pzI],styles:["[_nghost-%COMP%]{display:block}.node-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:1;display:flex;align-items:center}.node[_ngcontent-%COMP%]{display:inline-block;border:2px solid var(--color-component-border-200);border-radius:3px;padding:3px 6px;z-index:1;background-color:var(--color-component-bg-100);opacity:.7;transition:opacity .2s,background-color .2s,color .2s;cursor:default}.node.active-target[_ngcontent-%COMP%]{border-color:var(--color-primary-500);opacity:.9}.cancelled-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--color-grey-300);transition:color .2s,opacity .2s;opacity:.7}.cancelled-edge[_ngcontent-%COMP%]{width:48px;height:2px;background-color:var(--color-component-bg-300);transition:background-color .2s}clr-icon[_ngcontent-%COMP%]{margin-inline-start:-1px}.cancelled-node[_ngcontent-%COMP%]{margin-inline-start:6px}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{opacity:1}.active[_ngcontent-%COMP%]   .node[_ngcontent-%COMP%]{opacity:1;background-color:var(--color-primary-600);border-color:var(--color-primary-600);color:var(--color-primary-100)}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{color:var(--color-error-500)}.active[_ngcontent-%COMP%]   .cancelled-edge[_ngcontent-%COMP%]{background-color:var(--color-error-500)}"],changeDetection:0})}}class oe{ngOnInit(){this.active$=this.from.active$.asObservable().pipe((0,U.M)(n=>this.to.activeTarget$.next(n)))}getStyle(){const n=this.from.index<this.to.index?"down":"up",t=this.from.getPos("down"===n?"bottom":"top"),o=this.to.getPos("down"===n?"top":"bottom"),i=Math.abs(t.x-o.x),l=Math.abs(t.y-o.y),c=Math.sqrt(i**2+l**2);return{"top.px":t.y,"left.px":t.x+("down"===n?10:40)+12*this.index,"height.px":c,"width.px":1,..."up"===n?{transform:"rotateZ(180deg)","transform-origin":"top"}:{}}}static{this.\u0275fac=function(t){return new(t||oe)}}static{this.\u0275cmp=e.VBU({type:oe,selectors:[["vdr-order-process-edge"]],inputs:{from:"from",to:"to",index:"index"},decls:3,vars:7,consts:[[1,"edge",3,"ngStyle"],["shape","arrow","flip","vertical",1,"arrow"]],template:function(t,o){1&t&&(e.j41(0,"div",0),e.nI1(1,"async"),e.nrm(2,"clr-icon",1),e.k0s()),2&t&&(e.AVh("active",e.bMT(1,5,o.active$)),e.Y8G("ngStyle",o.getStyle()),e.BMQ("data-from",o.from.node.name)("data-to",o.to.node.name))},dependencies:[m.U4n,s.B3,s.Jj],styles:[".edge[_ngcontent-%COMP%]{position:absolute;border:1px solid var(--color-component-border-200);background-color:var(--color-component-bg-300);opacity:.3;transition:border .2s,opacity .2s,background-color .2s}.edge.active[_ngcontent-%COMP%]{border-color:var(--color-primary-500);background-color:var(--color-primary-500);opacity:1}.edge.active[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:var(--color-primary-500)}.edge[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{position:absolute;bottom:-4px;left:-8px;color:var(--color-grey-300)}"],changeDetection:0})}}class ie{constructor(n){this.changeDetector=n,this.setActiveState$=new ye.t(void 0),this.nodes=[],this.edges=[]}get outerHeight(){return this.nodes.length*Te}ngOnInit(){this.setActiveState$.next(this.initialState),this.activeState$=this.setActiveState$.pipe((0,Ce.B)(150))}ngOnChanges(n){this.populateNodes()}ngAfterViewInit(){setTimeout(()=>this.populateEdges())}onMouseOver(n){this.setActiveState$.next(n)}onMouseOut(){this.setActiveState$.next(this.initialState)}getNodeFor(n){if(this.nodeComponents)return this.nodeComponents.find(t=>t.node.name===n)}populateNodes(){const n=new Map;for(const t of this.states)n.set(t.name,{name:t.name,to:[]});for(const[t,o]of n.entries()){const i=this.states.find(l=>l.name===t)?.to??[];for(const l of i){const c=n.get(l);c&&o.to.push(c)}}this.nodes=[...n.values()].filter(t=>"Cancelled"!==t.name)}populateEdges(){for(const n of this.nodes){const t=this.getNodeFor(n.name);let o=0;for(const i of n.to){const l=this.getNodeFor(i.name);t&&l&&t!==l&&(this.edges.push({to:l,from:t,index:o}),o++)}}this.edges=[...this.edges],this.changeDetector.markForCheck()}static{this.\u0275fac=function(t){return new(t||ie)(e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:ie,selectors:[["vdr-order-process-graph"]],viewQuery:function(t,o){if(1&t&&e.GBs(L,5),2&t){let i;e.mGM(i=e.lsd())&&(o.nodeComponents=i)}},hostVars:2,hostBindings:function(t,o){2&t&&e.xc7("height",o.outerHeight,"px")},inputs:{states:"states",initialState:"initialState"},features:[e.OA$],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"mouseenter","mouseleave","node","index","active"],[3,"from","to","index"]],template:function(t,o){1&t&&e.DNE(0,Yr,3,5,"ng-container",0)(1,Lr,2,3,"ng-container",0),2&t&&(e.Y8G("ngForOf",o.nodes),e.R7$(),e.Y8G("ngForOf",o.edges))},dependencies:[s.Sq,L,oe,s.Jj],styles:["[_nghost-%COMP%]{display:block;border:1px hotpink;margin:20px;padding:12px;position:relative}.state-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0})}}class ae{constructor(n){this.serverConfigService=n,this.states=[]}ngOnInit(){this.states=this.serverConfigService.getOrderProcessStates()}static{this.\u0275fac=function(t){return new(t||ae)(e.rXU(a.BBL))}}static{this.\u0275cmp=e.VBU({type:ae,selectors:[["vdr-order-process-graph-dialog"]],decls:2,vars:2,consts:[["vdrDialogTitle",""],[3,"states","initialState"]],template:function(t,o){1&t&&(e.DNE(0,Vr,2,3,"ng-template",0),e.nrm(1,"vdr-order-process-graph",1)),2&t&&(e.R7$(),e.Y8G("states",o.states)("initialState",o.activeState))},dependencies:[a.MCd,ie,g.D9],changeDetection:0})}}class V{constructor(){this.paymentSelected=new e.bkB}static{this.\u0275fac=function(t){return new(t||V)}}static{this.\u0275cmp=e.VBU({type:V,selectors:[["vdr-payment-for-refund-selector"]],inputs:{refundablePayments:"refundablePayments",order:"order"},outputs:{paymentSelected:"paymentSelected"},decls:1,vars:1,consts:[[3,"title","selected","unselected",4,"ngFor","ngForOf"],[3,"title"],["vdrCardControls",""],[1,"form-grid"],[3,"label"],[3,"readonly","currencyCode","formControl"],["size","small",3,"selectedChange","title","label","disabled","selected"]],template:function(t,o){1&t&&e.DNE(0,Br,21,35,"vdr-card",0),2&t&&e.Y8G("ngForOf",o.refundablePayments)},dependencies:[s.Sq,d.BC,d.l_,a.Juh,a.KSf,a.Vr5,a.EV5,a.BPu,a.iby,a.aVo,g.D9,a.uc0],styles:["[_nghost-%COMP%]{display:block}"]})}}class le{constructor(n){this.i18nService=n,this.lineQuantities={},this.refundablePayments=[],this.refundShippingLineIds=[],this.reasons=(0,a.WEc)().cancellationReasons??[(0,p.x)("order.refund-reason-customer-request"),(0,p.x)("order.refund-reason-not-available")],this.manuallySetRefundTotal=!1,this.refundTotal=0,this.reasons=this.reasons.map(t=>this.i18nService.translate(t))}get totalRefundableAmount(){return(0,_.summate)(this.refundablePayments,"refundableAmount")}get amountToRefundTotal(){return this.refundablePayments.reduce((n,t)=>n+t.amountToRefundControl.value,0)}lineCanBeRefundedOrCancelled(n){return(this.order.payments?.reduce((o,i)=>[...o,...i.refunds],[]).filter(o=>"Failed"!==o.state).reduce((o,i)=>[...o,...i.lines],[]).filter(o=>o.orderLineId===n.id).reduce((o,i)=>o+i.quantity,0)??0)<n.orderPlacedQuantity}ngOnInit(){this.lineQuantities=this.order.lines.reduce((n,t)=>({...n,[t.id]:{quantity:0,refund:!0,cancel:!1}}),{}),this.refundablePayments=Ie(this.order.payments)}updateRefundTotal(){if(!this.manuallySetRefundTotal){const o=this.order.lines.reduce((l,c)=>{const Fe=this.lineQuantities[c.id].quantity||0;return l+c.proratedUnitPriceWithTax*Fe},0),i=this.order.shippingLines.reduce((l,c)=>this.refundShippingLineIds.includes(c.id)?l+c.discountedPriceWithTax:l,0);this.refundTotal=o+i}const n=this.refundablePayments.filter(o=>o.selected);let t=0;for(const o of n){const i=Math.min(o.refundableAmount,this.refundTotal-t);o.amountToRefundControl.setValue(i),t+=i}}toggleShippingRefund(n){const t=this.refundShippingLineIds.indexOf(n);-1===t?this.refundShippingLineIds.push(n):this.refundShippingLineIds.splice(t,1),this.updateRefundTotal()}onRefundQuantityChange(n,t){this.manuallySetRefundTotal=!1;const o=this.lineQuantities[n];if(o){const i=o.quantity;0===t?o.cancel=!1:0===i&&t>0&&(o.cancel=!0),o.quantity=t,this.updateRefundTotal()}}onPaymentSelected(n,t){if(t){const o=this.refundTotal-this.refundablePayments.filter(i=>i.id!==n.id).reduce((i,l)=>i+l.amountToRefundControl.value,0);0<o&&n.amountToRefundControl.setValue(Math.min(o,n.refundableAmount))}else n.amountToRefundControl.setValue(0)}isRefunding(){return Object.values(this.lineQuantities).reduce((t,o)=>t||0<o.quantity,!1)}isCancelling(){return Object.values(this.lineQuantities).reduce((t,o)=>t||0<o.quantity&&o.cancel,!1)}canSubmit(){return 0<this.refundTotal&&this.amountToRefundTotal===this.refundTotal&&!!this.reason}select(){const n=this.getOrderLineInput(()=>!0),t=this.getOrderLineInput(o=>o.cancel);this.resolveWith({refunds:this.refundablePayments.filter(o=>o.selected&&0<o.amountToRefundControl.value).map(o=>({lines:n,reason:this.reason,paymentId:o.id,amount:o.amountToRefundControl.value,shipping:0,adjustment:0})),cancel:{lines:t,orderId:this.order.id,reason:this.reason,cancelShipping:this.refundShippingLineIds.length>0}})}cancel(){this.resolveWith()}getOrderLineInput(n){return Object.entries(this.lineQuantities).filter(([t,o])=>0<o.quantity&&n(o)).map(([t,o])=>({orderLineId:t,quantity:o.quantity}))}static{this.\u0275fac=function(t){return new(t||le)(e.rXU(a.W40))}}static{this.\u0275cmp=e.VBU({type:le,selectors:[["vdr-refund-order-dialog"]],decls:50,vars:60,consts:[["imagePlaceholder",""],["vdrDialogTitle",""],[1,"refund-wrapper"],["id","refund-order",3,"items"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","image",3,"heading"],["id","product-name",3,"heading","optional"],["id","product-sku",3,"heading"],["id","unit-price",3,"heading","hiddenByDefault"],["id","prorated-unit-price",3,"heading"],["id","quantity",3,"heading"],["id","refund-quantity",3,"heading","optional"],["id","cancel",3,"heading","optional"],[1,"refund-details","mt-4"],["class","flex mb-2",4,"ngFor","ngForOf"],[1,"mb-2",3,"label"],["bindLabel","name","autofocus","","bindValue","id",3,"ngModelChange","items","placeholder","addTag","ngModel"],[3,"readOnlyToggleChange","label","readOnlyToggle"],[3,"ngModelChange","readonly","currencyCode","ngModel"],[1,""],[3,"paymentSelected","refundablePayments","order"],["vdrDialogButtons",""],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],[3,"src"],[1,"placeholder"],["shape","image","size","48"],[4,"ngIf"],["vdrDropdownTrigger","",1,"promotions-label"],[1,"icon-button"],["shape","info"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-amount"],[3,"line","payments"],["type","number","min","0",3,"ngModel","max","ngModelChange",4,"ngIf"],["type","number","min","0",3,"ngModelChange","ngModel","max"],[1,"cancel-checkbox-wrapper"],[1,"flex","center"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange",4,"ngIf"],[1,"ml-1"],["type","checkbox","clrCheckbox","",3,"ngModelChange","disabled","ngModel"],[1,"flex","mb-2"],["type","checkbox","clrCheckbox","",3,"change"],[1,"errors"],[3,"clrAlertType","clrAlertClosable",4,"ngIf"],[1,"modal-buttons"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],[3,"clrAlertType","clrAlertClosable"]],template:function(t,o){1&t&&(e.DNE(0,Hr,2,3,"ng-template",1),e.j41(1,"div",2)(2,"vdr-data-table-2",3)(3,"vdr-dt2-column",4),e.nI1(4,"translate"),e.DNE(5,Jr,1,1,"ng-template"),e.k0s(),e.j41(6,"vdr-dt2-column",5),e.nI1(7,"translate"),e.DNE(8,zr,2,4,"ng-template"),e.k0s(),e.j41(9,"vdr-dt2-column",6),e.nI1(10,"translate"),e.DNE(11,Wr,2,4,"ng-template"),e.k0s(),e.j41(12,"vdr-dt2-column",7),e.nI1(13,"translate"),e.DNE(14,Kr,4,2,"ng-template"),e.k0s(),e.j41(15,"vdr-dt2-column",8),e.nI1(16,"translate"),e.DNE(17,eo,1,1,"ng-template"),e.k0s(),e.j41(18,"vdr-dt2-column",9),e.nI1(19,"translate"),e.DNE(20,to,1,1,"ng-template"),e.k0s(),e.j41(21,"vdr-dt2-column",10),e.nI1(22,"translate"),e.DNE(23,no,2,4,"ng-template"),e.k0s(),e.j41(24,"vdr-dt2-column",11),e.nI1(25,"translate"),e.DNE(26,ao,3,5,"ng-template"),e.k0s(),e.j41(27,"vdr-dt2-column",12),e.nI1(28,"translate"),e.DNE(29,lo,2,3,"ng-template"),e.k0s(),e.j41(30,"vdr-dt2-column",13),e.nI1(31,"translate"),e.DNE(32,co,1,1,"ng-template"),e.k0s(),e.j41(33,"vdr-dt2-column",14),e.nI1(34,"translate"),e.DNE(35,mo,6,4,"ng-template"),e.k0s()(),e.j41(36,"div",15)(37,"div")(38,"vdr-card"),e.DNE(39,uo,10,8,"label",16),e.j41(40,"vdr-form-field",17),e.nI1(41,"translate"),e.j41(42,"ng-select",18),e.nI1(43,"translate"),e.mxI("ngModelChange",function(l){return e.DH7(o.reason,l)||(o.reason=l),l}),e.k0s()(),e.j41(44,"vdr-form-field",19),e.nI1(45,"translate"),e.bIt("readOnlyToggleChange",function(l){return o.manuallySetRefundTotal=!l}),e.j41(46,"vdr-currency-input",20),e.mxI("ngModelChange",function(l){return e.DH7(o.refundTotal,l)||(o.refundTotal=l),l}),e.bIt("ngModelChange",function(){return o.updateRefundTotal()}),e.k0s()()()(),e.j41(47,"div",21)(48,"vdr-payment-for-refund-selector",22),e.bIt("paymentSelected",function(l){return o.onPaymentSelected(l.payment,l.selected)}),e.k0s()()()(),e.DNE(49,ho,13,16,"ng-template",23)),2&t&&(e.R7$(2),e.Y8G("items",o.order.lines),e.R7$(),e.Y8G("heading",e.bMT(4,32,"common.id"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(7,34,"common.created-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(10,36,"common.updated-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(13,38,"common.image")),e.R7$(3),e.Y8G("heading",e.bMT(16,40,"order.product-name"))("optional",!1),e.R7$(3),e.Y8G("heading",e.bMT(19,42,"order.product-sku")),e.R7$(3),e.Y8G("heading",e.bMT(22,44,"order.unit-price"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(25,46,"order.prorated-unit-price")),e.R7$(3),e.Y8G("heading",e.bMT(28,48,"order.quantity")),e.R7$(3),e.Y8G("heading",e.bMT(31,50,"order.refund"))("optional",!1),e.R7$(3),e.Y8G("heading",e.bMT(34,52,"order.return-to-stock"))("optional",!1),e.R7$(6),e.Y8G("ngForOf",o.order.shippingLines),e.R7$(),e.Y8G("label",e.bMT(41,54,"order.refund-cancellation-reason")),e.R7$(2),e.Y8G("items",o.reasons)("placeholder",e.bMT(43,56,"order.refund-cancellation-reason-required"))("addTag",!0),e.R50("ngModel",o.reason),e.R7$(2),e.Y8G("label",e.bMT(45,58,"order.refund-total"))("readOnlyToggle",!0),e.R7$(2),e.Y8G("readonly",!o.manuallySetRefundTotal)("currencyCode",o.order.currencyCode),e.R50("ngModel",o.refundTotal),e.R7$(2),e.Y8G("refundablePayments",o.refundablePayments)("order",o.order))},dependencies:[m.k8k,m.Bw1,m.U4n,m.aZZ,m.Jej,s.Sq,s.bT,d.me,d.Q0,d.Zm,d.BC,d.VZ,d.zX,d.vS,I.vr,a.Juh,a.KSf,a.Vr5,a.bc3,a.MCd,a.PsF,a.qLY,a.j$H,a.IMU,a.Y9G,a.iby,R,V,s.QX,s.oe,g.D9,a.HlS,a.PU$,a.uc0],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column;min-height:64vh}.refund-wrapper[_ngcontent-%COMP%]{flex:1;flex-direction:column}.refund-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.refund-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.refund-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}  .refund-wrapper .table-wrapper{max-width:initial!important}.quantity-col[_ngcontent-%COMP%]{background-color:var(--color-warning-100)}.cancel-checkbox-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}clr-checkbox-wrapper[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px;display:block}.refund-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:var(--space-unit);gap:calc(var(--space-unit) * 2);justify-content:space-between}@media screen and (min-width: 992px){.refund-details[_ngcontent-%COMP%]{flex-direction:row}}.refund-details[_ngcontent-%COMP%]   vdr-card.unselected[_ngcontent-%COMP%]{opacity:.8}.refund-details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1}.errors[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:calc(var(--space-unit) * 2);margin:calc(var(--space-unit) * 2) 0}.prorated-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.line-promotion[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:12px;padding:3px 6px}.line-promotion[_ngcontent-%COMP%]   .promotion-amount[_ngcontent-%COMP%]{margin-inline-start:12px}vdr-card.faded[_ngcontent-%COMP%]{opacity:.8}.modal-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.6rem;gap:var(--clr-modal-footer-gap, .6rem)}"],changeDetection:0})}}class de{constructor(){this.transactionId=""}submit(){this.resolveWith(this.transactionId)}cancel(){this.resolveWith()}static{this.\u0275fac=function(t){return new(t||de)}}static{this.\u0275cmp=e.VBU({type:de,selectors:[["vdr-settle-refund-dialog"]],decls:10,vars:10,consts:[["vdrDialogTitle",""],[1,"instruction"],["clrInput","","name","transactionId",3,"ngModelChange","ngModel"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.DNE(0,bo,2,3,"ng-template",0),e.j41(1,"p",1),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"clr-input-container")(5,"label"),e.EFF(6),e.nI1(7,"translate"),e.k0s(),e.j41(8,"input",2),e.mxI("ngModelChange",function(l){return e.DH7(o.transactionId,l)||(o.transactionId=l),l}),e.k0s()(),e.DNE(9,yo,6,7,"ng-template",3)),2&t&&(e.R7$(2),e.SpI(" ",e.i5U(3,3,"order.settle-refund-manual-instructions",e.eq3(8,vo,o.refund.method)),"\n"),e.R7$(4),e.JRh(e.bMT(7,6,"order.transaction-id")),e.R7$(2),e.R50("ngModel",o.transactionId))},dependencies:[m.aZZ,m.icl,m.Xu5,d.me,d.BC,d.vS,a.Vr5,a.bc3,a.MCd,g.D9],styles:["[_nghost-%COMP%]{padding-bottom:32px}.instruction[_ngcontent-%COMP%]{margin-top:0;margin-bottom:24px}"],changeDetection:0})}}class se{get chipColorType(){switch(this.state){case"Authorized":return"warning";case"Settled":return"success";case"Declined":case"Cancelled":return"error"}}static{this.\u0275fac=function(t){return new(t||se)}}static{this.\u0275cmp=e.VBU({type:se,selectors:[["vdr-payment-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(t,o){1&t&&(e.j41(0,"vdr-chip",0),e.nI1(1,"translate"),e.DNE(2,Co,1,0,"clr-icon",1),e.EFF(3),e.nI1(4,"stateI18nToken"),e.nI1(5,"translate"),e.k0s()),2&t&&(e.Y8G("title",e.bMT(1,4,"order.payment-state"))("colorType",o.chipColorType),e.R7$(2),e.Y8G("ngIf","Settled"===o.state),e.R7$(),e.SpI(" ",e.bMT(5,8,e.bMT(4,6,o.state)),"\n"))},dependencies:[m.U4n,s.bT,a.wux,g.D9,a.pzI],styles:["[_nghost-%COMP%]{display:flex;font-size:14px}"],changeDetection:0})}}class ce{get chipColorType(){switch(this.state){case"Pending":return"warning";case"Settled":return"success";case"Failed":return"error"}}static{this.\u0275fac=function(t){return new(t||ce)}}static{this.\u0275cmp=e.VBU({type:ce,selectors:[["vdr-refund-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(t,o){1&t&&(e.j41(0,"vdr-chip",0),e.nI1(1,"translate"),e.DNE(2,Io,1,0,"clr-icon",1),e.EFF(3),e.nI1(4,"stateI18nToken"),e.nI1(5,"translate"),e.k0s()),2&t&&(e.Y8G("title",e.bMT(1,4,"order.payment-state"))("colorType",o.chipColorType),e.R7$(2),e.Y8G("ngIf","Settled"===o.state),e.R7$(),e.SpI(" ",e.bMT(5,8,e.bMT(4,6,o.state)),"\n"))},dependencies:[m.U4n,s.bT,a.wux,g.D9,a.pzI],styles:["[_nghost-%COMP%]{display:flex;font-size:14px}"],changeDetection:0})}}class X{static{this.\u0275fac=function(t){return new(t||X)}}static{this.\u0275cmp=e.VBU({type:X,selectors:[["vdr-payment-detail"]],inputs:{payment:"payment",currencyCode:"currencyCode"},decls:12,vars:17,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"value"]],template:function(t,o){1&t&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.k0s(),e.j41(3,"vdr-labeled-data",0),e.nI1(4,"translate"),e.EFF(5),e.nI1(6,"localeCurrency"),e.k0s(),e.DNE(7,To,3,4,"vdr-labeled-data",1)(8,Fo,3,4,"vdr-labeled-data",1),e.j41(9,"vdr-labeled-data",0),e.nI1(10,"translate"),e.nrm(11,"vdr-object-tree",2),e.k0s()),2&t&&(e.Y8G("label",e.bMT(1,8,"order.payment-method")),e.R7$(2),e.SpI(" ",o.payment.method,"\n"),e.R7$(),e.Y8G("label",e.bMT(4,10,"order.amount")),e.R7$(2),e.SpI(" ",e.i5U(6,12,o.payment.amount,o.currencyCode),"\n"),e.R7$(2),e.Y8G("ngIf",o.payment.errorMessage),e.R7$(),e.Y8G("ngIf",o.payment.transactionId),e.R7$(),e.Y8G("label",e.bMT(10,15,"order.payment-metadata")),e.R7$(2),e.Y8G("value",o.payment.metadata))},dependencies:[s.bT,a.BPu,a.TJf,g.D9,a.uc0],changeDetection:0})}}class pe{constructor(){this.settlePayment=new e.bkB,this.transitionPaymentState=new e.bkB,this.settleRefund=new e.bkB}refundHasMetadata(n){return!!n&&Object.keys(n.metadata).length>0}nextOtherStates(){return this.payment?this.payment.nextStates.filter(n=>"Settled"!==n&&"Error"!==n):[]}static{this.\u0275fac=function(t){return new(t||pe)}}static{this.\u0275cmp=e.VBU({type:pe,selectors:[["vdr-order-payment-card"]],inputs:{payment:"payment",currencyCode:"currencyCode"},outputs:{settlePayment:"settlePayment",transitionPaymentState:"transitionPaymentState",settleRefund:"settleRefund"},decls:12,vars:9,consts:[["cancel",""],[1,"card"],[1,"card-header","payment-header"],[4,"ngIf"],[1,"payment-state"],[3,"state"],[1,"card-block"],[3,"payment","currencyCode"],[4,"ngFor","ngForOf"],["class","card-footer",4,"ngIf"],[1,"refund-wrapper","card-block"],[1,"card-header","payment-header","refund-header"],["shape","redo","dir","down",1,"refund-icon"],[1,"clr-flex-fill"],[3,"label"],[3,"label",4,"ngIf"],[3,"value"],[1,"card-footer"],[1,"btn","btn-sm","btn-primary",3,"click"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],[4,"ngIf","ngIfElse"],["shape","step-forward-2"],["shape","error-standard",1,"is-error"]],template:function(t,o){1&t&&(e.j41(0,"div",1)(1,"div",2)(2,"div"),e.EFF(3),e.nI1(4,"translate"),e.DNE(5,xo,3,4,"ng-container",3),e.k0s(),e.j41(6,"div",4),e.nrm(7,"vdr-payment-state-label",5),e.k0s()(),e.j41(8,"div",6),e.nrm(9,"vdr-payment-detail",7),e.k0s(),e.DNE(10,ko,21,23,"ng-container",8)(11,jo,7,2,"div",9),e.k0s()),2&t&&(e.R7$(3),e.SpI(" ",e.bMT(4,7,"order.payment")," "),e.R7$(2),e.Y8G("ngIf",o.payment.amount),e.R7$(2),e.Y8G("state",o.payment.state),e.R7$(2),e.Y8G("payment",o.payment)("currencyCode",o.currencyCode),e.R7$(),e.Y8G("ngForOf",o.payment.refunds),e.R7$(),e.Y8G("ngIf",o.payment.nextStates.length))},dependencies:[m.U4n,s.Sq,s.bT,$e.ig,a.PsF,a.qLY,a.j$H,a.Mrl,a.BPu,a.TJf,se,ce,X,g.D9,a.pzI,a.PU$,a.uc0],styles:["[_nghost-%COMP%]{display:block}.payment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;line-break:anywhere}.refund-icon[_ngcontent-%COMP%]{margin-inline-end:6px;color:var(--color-grey-400)}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}.refund-wrapper[_ngcontent-%COMP%]{font-size:var(--font-size-xs)}"],changeDetection:0})}}class me{constructor(n){this.historyEntryComponentService=n,this.expandClick=new e.bkB}ngOnInit(){const n=this.historyEntryComponentService.getComponent(this.entry.type),t=this.portalRef.createComponent(n);t.instance.entry=this.entry,t.instance.order=this.order,this.instance=t.instance,this.componentRef=t}ngOnDestroy(){this.componentRef?.destroy()}static{this.\u0275fac=function(t){return new(t||me)(e.rXU(a.HMZ))}}static{this.\u0275cmp=e.VBU({type:me,selectors:[["vdr-order-history-entry-host"]],viewQuery:function(t,o){if(1&t&&e.GBs(Eo,7,e.c1b),2&t){let i;e.mGM(i=e.lsd())&&(o.portalRef=i.first)}},inputs:{entry:"entry",order:"order",expanded:"expanded"},outputs:{expandClick:"expandClick"},exportAs:["historyEntry"],decls:3,vars:6,consts:[["portal",""],[3,"expandClick","displayType","iconShape","createdAt","name","featured","collapsed"]],template:function(t,o){if(1&t){const i=e.RV6();e.j41(0,"vdr-timeline-entry",1),e.bIt("expandClick",function(){return e.eBV(i),e.Njj(o.expandClick.emit())}),e.nrm(1,"div",null,0),e.k0s()}2&t&&e.Y8G("displayType",o.instance.getDisplayType(o.entry))("iconShape",o.instance.getIconShape&&o.instance.getIconShape(o.entry))("createdAt",o.entry.createdAt)("name",o.instance.getName&&o.instance.getName(o.entry))("featured",o.instance.isFeatured(o.entry))("collapsed",!o.expanded&&!o.instance.isFeatured(o.entry))},dependencies:[a.rjt],encapsulation:2})}}class ue{constructor(n){this.historyEntryComponentService=n,this.addNote=new e.bkB,this.updateNote=new e.bkB,this.deleteNote=new e.bkB,this.note="",this.noteIsPrivate=!0,this.expanded=!1,this.type=a.Htj}hasCustomComponent(n){return!!this.historyEntryComponentService.getComponent(n)}getDisplayType(n){if(n.type===a.Htj.ORDER_STATE_TRANSITION){if("Delivered"===n.data.to)return"success";if("Cancelled"===n.data.to)return"error"}return n.type===a.Htj.ORDER_FULFILLMENT_TRANSITION&&"Delivered"===n.data.to?"success":n.type!==a.Htj.ORDER_PAYMENT_TRANSITION||"Declined"!==n.data.to&&"Cancelled"!==n.data.to?n.type===a.Htj.ORDER_CANCELLATION||n.type===a.Htj.ORDER_REFUND_TRANSITION?"warning":"default":"error"}getTimelineIcon(n){if(n.type===a.Htj.ORDER_STATE_TRANSITION){if("Delivered"===n.data.to)return["success-standard","is-solid"];if("Cancelled"===n.data.to)return"ban"}return n.type===a.Htj.ORDER_PAYMENT_TRANSITION&&"Settled"===n.data.to||n.type===a.Htj.ORDER_REFUND_TRANSITION&&"Settled"===n.data.to?"credit-card":n.type===a.Htj.ORDER_NOTE?"note":n.type===a.Htj.ORDER_MODIFIED?"pencil":n.type===a.Htj.ORDER_CUSTOMER_UPDATED?"switch":n.type!==a.Htj.ORDER_FULFILLMENT_TRANSITION||"Shipped"!==n.data.to&&"Delivered"!==n.data.to?void 0:"truck"}isFeatured(n){switch(n.type){case a.Htj.ORDER_STATE_TRANSITION:return"Delivered"===n.data.to||"Cancelled"===n.data.to||"Settled"===n.data.to;case a.Htj.ORDER_REFUND_TRANSITION:return"Settled"===n.data.to;case a.Htj.ORDER_PAYMENT_TRANSITION:return"Settled"===n.data.to||"Cancelled"===n.data.to;case a.Htj.ORDER_FULFILLMENT_TRANSITION:return"Delivered"===n.data.to||"Shipped"===n.data.to;case a.Htj.ORDER_NOTE:case a.Htj.ORDER_MODIFIED:case a.Htj.ORDER_CUSTOMER_UPDATED:return!0;default:return!1}}getFulfillment(n){if((n.type===a.Htj.ORDER_FULFILLMENT||n.type===a.Htj.ORDER_FULFILLMENT_TRANSITION)&&this.order.fulfillments)return this.order.fulfillments.find(t=>t.id===n.data.fulfillmentId)}getPayment(n){if(n.type===a.Htj.ORDER_PAYMENT_TRANSITION&&this.order.payments)return this.order.payments.find(t=>t.id===n.data.paymentId)}getRefund(n){if(n.type===a.Htj.ORDER_REFUND_TRANSITION&&this.order.payments)return this.order.payments.reduce((o,i)=>o.concat(i.refunds),[]).find(o=>o.id===n.data.refundId)}getCancelledQuantity(n){return n.data.lines.reduce((t,o)=>t+o.quantity,0)}getCancelledItems(n){const t=new Map;for(const o of this.order.lines){const i=n.find(l=>l.orderLineId===o.id);if(i){t.get(o.productVariant.name);t.set(o.productVariant.name,i.quantity)}}return Array.from(t.entries()).map(([o,i])=>({name:o,quantity:i}))}getModification(n){return this.order.modifications.find(t=>t.id===n)}getName(n){const{administrator:t}=n;if(t)return`${t.firstName} ${t.lastName}`;{const o=this.order.customer;if(o)return`${o.firstName} ${o.lastName}`}return""}addNoteToOrder(){this.addNote.emit({note:this.note,isPublic:!this.noteIsPrivate}),this.note="",this.noteIsPrivate=!0}static{this.\u0275fac=function(t){return new(t||ue)(e.rXU(a.HMZ))}}static{this.\u0275cmp=e.VBU({type:ue,selectors:[["vdr-order-history"]],inputs:{order:"order",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:20,vars:22,consts:[["defaultComponents",""],["regularPaymentTransition",""],["regularRefundTransition",""],[1,"entry-list"],["iconShape","note","displayType","muted",3,"featured","isFirst"],[1,"note-entry"],["name","note",1,"note",3,"ngModelChange","ngModel"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"visibility-select"],["type","checkbox","clrCheckbox","",3,"ngModelChange","ngModel"],["class","private",4,"ngIf"],["class","public",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"isLast","createdAt","featured"],[1,"title"],[1,"private"],[1,"public"],[3,"order","entry","expanded","expandClick",4,"ngIf","ngIfElse"],[3,"expandClick","order","entry","expanded"],[3,"expandClick","displayType","iconShape","createdAt","name","featured","collapsed"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","title",4,"ngIf"],[3,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"flex","items-center"],["colorType","success","class","mx-1",4,"ngIf"],["colorType","error","class","mx-1",4,"ngIf"],[3,"order","modification"],["colorType","success",1,"mx-1"],["colorType","error",1,"mx-1"],[4,"ngIf","ngIfElse"],["class","mr-1",4,"ngIf"],[4,"ngIf"],[1,"mr-1"],[3,"payment","currencyCode"],["colorType","warning",1,"mr-1"],[3,"label"],[3,"items"],[3,"fulfillmentId","order"],[1,"flex"],[1,"note-text"],["class","note-visibility public",4,"ngIf"],["class","note-visibility private",4,"ngIf"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"button-small","ml-1"],["shape","ellipsis-vertical","size","12"],["vdrPosition","bottom-right"],["vdrDropdownItem","",3,"click","disabled"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"],[1,"note-visibility","public"],[1,"note-visibility","private"],[3,"routerLink"],[1,"cancelled-coupon-code"],["class","button-ghost",3,"routerLink",4,"ngIf"],[1,"button-ghost",3,"routerLink"],["shape","user",1,"is-solid"],["shape","arrow right"],[3,"value"]],template:function(t,o){1&t&&(e.j41(0,"div",3)(1,"vdr-timeline-entry",4)(2,"div",5)(3,"textarea",6),e.mxI("ngModelChange",function(l){return e.DH7(o.note,l)||(o.note=l),l}),e.k0s(),e.j41(4,"button",7),e.bIt("click",function(){return o.addNoteToOrder()}),e.EFF(5),e.nI1(6,"translate"),e.k0s()(),e.j41(7,"div",8)(8,"clr-checkbox-wrapper")(9,"input",9),e.mxI("ngModelChange",function(l){return e.DH7(o.noteIsPrivate,l)||(o.noteIsPrivate=l),l}),e.k0s(),e.j41(10,"label"),e.EFF(11),e.nI1(12,"translate"),e.k0s()(),e.DNE(13,Ao,3,3,"span",10)(14,Yo,3,3,"span",11),e.k0s()(),e.DNE(15,xi,4,2,"ng-container",12),e.j41(16,"vdr-timeline-entry",13)(17,"div",14),e.EFF(18),e.nI1(19,"translate"),e.k0s()()()),2&t&&(e.AVh("expanded",o.expanded),e.R7$(),e.Y8G("featured",!0)("isFirst",!0),e.R7$(2),e.R50("ngModel",o.note),e.R7$(),e.Y8G("disabled",!o.note),e.R7$(),e.SpI(" ",e.bMT(6,16,"common.add-note")," "),e.R7$(4),e.R50("ngModel",o.noteIsPrivate),e.R7$(2),e.JRh(e.bMT(12,18,"order.note-is-private")),e.R7$(2),e.Y8G("ngIf",o.noteIsPrivate),e.R7$(),e.Y8G("ngIf",!o.noteIsPrivate),e.R7$(),e.Y8G("ngForOf",o.history),e.R7$(),e.Y8G("isLast",!0)("createdAt",o.order.createdAt)("featured",!0),e.R7$(2),e.SpI(" ",e.bMT(19,20,"order.history-order-created")," "))},dependencies:[m.U4n,m.aZZ,m.Jej,m.eAx,s.Sq,s.bT,s.ux,s.e1,s.fG,d.me,d.Zm,d.BC,d.vS,b.Wk,a.wux,a.Vr5,a.PsF,a.qLY,a.j$H,a.Mrl,a.BPu,a.TJf,a.rjt,a.f4U,Y,X,k,re,me,g.D9,a.Ex,a.uc0],styles:["[_nghost-%COMP%]{display:block}.entry-list[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 2)}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.visibility-select[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}.visibility-select[_ngcontent-%COMP%]   .public[_ngcontent-%COMP%]{color:var(--color-warning-700)}.visibility-select[_ngcontent-%COMP%]   .private[_ngcontent-%COMP%]{color:var(--color-success-700)}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-inline-end:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-grey-800);white-space:pre-wrap;max-width:580px}.cancelled-coupon-code[_ngcontent-%COMP%]{text-decoration:line-through}.note-visibility[_ngcontent-%COMP%]{text-transform:lowercase}.note-visibility.public[_ngcontent-%COMP%]{color:var(--color-warning-700)}.note-visibility.private[_ngcontent-%COMP%]{color:var(--color-success-700)}"],changeDetection:0})}}const we=O.J1`
    query GetSellerOrders($orderId: ID!) {
        order(id: $orderId) {
            id
            sellerOrders {
                id
                code
                state
                orderPlacedAt
                currencyCode
                totalWithTax
                channels {
                    id
                    code
                    seller {
                        id
                        name
                    }
                }
            }
        }
    }
`;class ge{constructor(n,t,o){this.router=n,this.dataService=t,this.channelService=o}ngOnInit(){this.sellerOrders$=this.dataService.query(we,{orderId:this.orderId}).mapSingle(({order:n})=>n?.sellerOrders??[])}getSeller(n){return n.channels.find(o=>o.code!==ze.ky)?.seller}navigateToSellerOrder(n){this.router.navigate(["/orders",n.id])}static{this.\u0275fac=function(t){return new(t||ge)(e.rXU(b.Ix),e.rXU(a.uSP),e.rXU(a.lhn))}}static{this.\u0275cmp=e.VBU({type:ge,selectors:[["vdr-seller-orders-card"]],inputs:{orderId:"orderId"},decls:5,vars:6,consts:[[3,"title"],[1,"form-grid"],[4,"ngFor","ngForOf"],[1,"button-ghost","mb-1",3,"routerLink"],["shape","arrow right"],[3,"label"],[3,"state"],[3,"label",4,"ngIf"]],template:function(t,o){1&t&&(e.j41(0,"vdr-card",0),e.nI1(1,"translate"),e.j41(2,"div",1),e.DNE(3,Mi,9,10,"div",2),e.nI1(4,"async"),e.k0s()()),2&t&&(e.Y8G("title",e.bMT(1,2,"order.seller-orders")),e.R7$(3),e.Y8G("ngForOf",e.bMT(4,4,o.sellerOrders$)))},dependencies:[m.U4n,s.Sq,s.bT,b.Wk,a.Fam,a.BPu,a.iby,s.Jj,g.D9,a.uc0],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}}const hl=O.J1`
    query OrderDetailQuery($id: ID!) {
        order(id: $id) {
            ...OrderDetail
        }
    }
    ${a.kQx}
`,vl=O.J1`
    mutation SetOrderCustomer($input: SetOrderCustomerInput!) {
        setOrderCustomer(input: $input) {
            id
            customer {
                id
                firstName
                lastName
                emailAddress
            }
        }
    }
`;class fe extends a.wi7{constructor(n,t,o,i,l,c){super(),this.changeDetector=n,this.dataService=t,this.notificationService=o,this.modalService=i,this.orderTransitionService=l,this.formBuilder=c,this.customFields=this.getCustomFieldConfig("Order"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.detailForm=new d.gE({customFields:this.formBuilder.group((0,a.HCD)(this.customFields))}),this.fetchHistory=new G.B,this.defaultStates=["AddingItems","ArrangingPayment","PaymentAuthorized","PaymentSettled","PartiallyShipped","Shipped","PartiallyDelivered","Delivered","Cancelled","Modifying","ArrangingAdditionalPayment"]}ngOnInit(){this.init(),this.entity$.pipe((0,F.s)(1)).subscribe(n=>{"Modifying"===n.state&&this.router.navigate(["./","modify"],{relativeTo:this.route})}),this.history$=this.fetchHistory.pipe((0,Se.Z)(null),(0,f.n)(()=>this.dataService.order.getOrderHistory(this.id,{sort:{createdAt:a.xBQ.DESC}}).mapStream(n=>n.order?.history.items))),this.nextStates$=this.entity$.pipe((0,v.T)(n=>this.defaultStates.includes(n.state)?n.nextStates.filter(o=>!this.defaultStates.includes(o)):n.nextStates))}ngOnDestroy(){this.destroy()}openStateDiagram(){this.entity$.pipe((0,F.s)(1),(0,f.n)(n=>this.modalService.fromComponent(ae,{closable:!0,locals:{activeState:n.state}}))).subscribe()}setOrderCustomer(){this.modalService.fromComponent(E,{locals:{canCreateNew:!1,includeNoteInput:!0,title:(0,p.x)("order.assign-order-to-another-customer")}}).pipe((0,f.n)(n=>function t(o){return"object"==typeof o&&!!o.id}(n)?this.dataService.mutate(a.GO4,{input:{customerId:n.id,orderId:this.id,note:n.note}}):T.w),(0,f.n)(n=>this.refetchOrder(n))).subscribe(n=>{n&&this.notificationService.success((0,p.x)("order.set-customer-success"))})}transitionToState(n){this.dataService.order.transitionToState(this.id,n).subscribe(({transitionOrderToState:t})=>{switch(t?.__typename){case"Order":this.notificationService.success((0,p.x)("order.transitioned-to-state-success"),{state:n}),this.fetchHistory.next();break;case"OrderStateTransitionError":this.notificationService.error(t.transitionError)}})}manuallyTransitionToState(n){this.orderTransitionService.manuallyTransitionToState({orderId:n.id,nextStates:n.nextStates,cancellable:!0,message:(0,p.x)("order.manually-transition-to-state-message"),retry:0}).subscribe()}transitionToModifying(){this.dataService.order.transitionToState(this.id,"Modifying").subscribe(({transitionOrderToState:n})=>{switch(n?.__typename){case"Order":this.router.navigate(["./modify"],{relativeTo:this.route});break;case"OrderStateTransitionError":this.notificationService.error(n.transitionError)}})}updateCustomFields(){this.dataService.order.updateOrderCustomFields({id:this.id,customFields:this.detailForm.value.customFields}).subscribe(()=>{this.notificationService.success((0,p.x)("common.notify-update-success"),{entity:"Order"})})}getOrderAddressLines(n){return n?Object.values(n).filter(t=>"OrderAddress"!==t).filter(t=>!!t):[]}settlePayment(n){this.dataService.order.settlePayment(n.id).subscribe(({settlePayment:t})=>{switch(t.__typename){case"Payment":"Settled"===t.state?this.notificationService.success((0,p.x)("order.settle-payment-success")):this.notificationService.error((0,p.x)("order.settle-payment-error")),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next();break;case"OrderStateTransitionError":case"PaymentStateTransitionError":case"SettlePaymentError":this.notificationService.error(t.message)}})}transitionPaymentState({payment:n,state:t}){"Cancelled"===t?this.dataService.order.cancelPayment(n.id).subscribe(({cancelPayment:o})=>{switch(o.__typename){case"Payment":this.notificationService.success((0,p.x)("order.transitioned-payment-to-state-success"),{state:t}),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next();break;case"PaymentStateTransitionError":this.notificationService.error(o.transitionError);break;case"CancelPaymentError":this.notificationService.error(o.paymentErrorMessage)}}):this.dataService.order.transitionPaymentToState(n.id,t).subscribe(({transitionPaymentToState:o})=>{switch(o.__typename){case"Payment":this.notificationService.success((0,p.x)("order.transitioned-payment-to-state-success"),{state:t}),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next();break;case"PaymentStateTransitionError":this.notificationService.error(o.message)}})}canAddFulfillment(n){const t=(n.fulfillments??[]).filter(i=>"Cancelled"!==i.state).reduce((i,l)=>[...i,...l.lines],[]);let o=!0;for(const i of n.lines)t.filter(c=>c.orderLineId===i.id).reduce((c,D)=>c+D.quantity,0)<i.quantity&&(o=!1);return!o&&!this.hasUnsettledModifications(n)&&0===this.outstandingPaymentAmount(n)&&(n.nextStates.includes("Shipped")||n.nextStates.includes("PartiallyShipped")||n.nextStates.includes("Delivered"))}hasUnsettledModifications(n){return 0<n.modifications.filter(t=>!t.isSettled).length}getOutstandingModificationAmount(n){return(0,_.summate)(n.modifications.filter(t=>!t.isSettled),"priceChange")}outstandingPaymentAmount(n){const t=i=>"Cancelled"!==i.state&&"Declined"!==i.state&&"Error"!==i.state;let o=0;for(const i of n.payments?.filter(t)??[]){const l=i.refunds.filter(D=>"Failed"!==D.state)??[],c=(0,_.summate)(l,"total");o+=i.amount-c}return n.totalWithTax-o}addManualPayment(n){const t=n.state;this.modalService.fromComponent(J,{closable:!0,locals:{outstandingAmount:this.outstandingPaymentAmount(n),currencyCode:n.currencyCode}}).pipe((0,f.n)(o=>o?this.dataService.order.addManualPaymentToOrder({orderId:this.id,transactionId:o.transactionId,method:o.method,metadata:o.metadata||{}}):T.w),(0,f.n)(({addManualPaymentToOrder:o})=>{switch(o.__typename){case"Order":return this.notificationService.success((0,p.x)("order.add-payment-to-order-success")),"ArrangingAdditionalPayment"===t?this.orderTransitionService.transitionToPreModifyingState(n.id,n.nextStates):(0,h.of)("PaymentSettled");case"ManualPaymentStateError":return this.notificationService.error(o.message),T.w;default:return T.w}})).subscribe(o=>{o&&this.refetchOrder({result:o})})}fulfillOrder(){this.entity$.pipe((0,F.s)(1),(0,f.n)(n=>this.modalService.fromComponent(ee,{size:"xl",locals:{order:n}})),(0,f.n)(n=>n?this.dataService.order.createFulfillment(n):(0,h.of)(void 0)),(0,f.n)(n=>this.refetchOrder(n).pipe((0,De.u)(n)))).subscribe(n=>{if(n){const{addFulfillmentToOrder:t}=n;switch(t.__typename){case"Fulfillment":this.notificationService.success((0,p.x)("order.create-fulfillment-success"));break;case"EmptyOrderLineSelectionError":case"InsufficientStockOnHandError":case"ItemsAlreadyFulfilledError":case"InvalidFulfillmentHandlerError":this.notificationService.error(t.message);break;case"FulfillmentStateTransitionError":this.notificationService.error(t.transitionError);break;case"CreateFulfillmentError":this.notificationService.error(t.fulfillmentHandlerError);break;case void 0:this.notificationService.error(JSON.stringify(t));break;default:(0,_.assertNever)(t)}}})}transitionFulfillment(n,t){this.dataService.order.transitionFulfillmentToState(n,t).pipe((0,f.n)(o=>this.refetchOrder(o))).subscribe(()=>{this.notificationService.success((0,p.x)("order.successfully-updated-fulfillment"))})}cancelOrRefund(n){const t=this.orderHasSettledPayments(n);"PaymentAuthorized"!==n.state&&!0!==n.active&&t?this.refundOrder(n):this.cancelOrder(n)}settleRefund(n){this.modalService.fromComponent(de,{size:"md",locals:{refund:n}}).pipe((0,f.n)(t=>t?this.dataService.order.settleRefund({transactionId:t,id:n.id},this.id):(0,h.of)(void 0))).subscribe(t=>{t&&this.notificationService.success((0,p.x)("order.settle-refund-success"))})}addNote(n){const{note:t,isPublic:o}=n;this.dataService.order.addNoteToOrder({id:this.id,note:t,isPublic:o}).pipe((0,f.n)(i=>this.refetchOrder(i))).subscribe(i=>{this.notificationService.success((0,p.x)("common.notify-create-success"),{entity:"Note"})})}updateNote(n){this.modalService.fromComponent(a.MR8,{closable:!0,locals:{displayPrivacyControls:!0,note:n.data.note,noteIsPrivate:!n.isPublic}}).pipe((0,f.n)(t=>t?this.dataService.order.updateOrderNote({noteId:n.id,isPublic:!t.isPrivate,note:t.note}):T.w)).subscribe(t=>{this.fetchHistory.next(),this.notificationService.success((0,p.x)("common.notify-update-success"),{entity:"Note"})})}deleteNote(n){return this.modalService.dialog({title:(0,p.x)("common.confirm-delete-note"),body:n.data.note,buttons:[{type:"secondary",label:(0,p.x)("common.cancel")},{type:"danger",label:(0,p.x)("common.delete"),returnValue:!0}]}).pipe((0,f.n)(t=>t?this.dataService.order.deleteOrderNote(n.id):T.w)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success((0,p.x)("common.notify-delete-success"),{entity:"Note"})})}orderHasSettledPayments(n){return!!n.payments?.find(t=>"Settled"===t.state)}cancelOrder(n){this.modalService.fromComponent(z,{size:"xl",locals:{order:n}}).pipe((0,f.n)(t=>t?this.dataService.order.cancelOrder(t):(0,h.of)(void 0)),(0,f.n)(t=>this.refetchOrder(t))).subscribe(t=>{t&&this.notificationService.success((0,p.x)("order.cancelled-order-success"))})}refundOrder(n){this.modalService.fromComponent(le,{size:"xl",locals:{order:n}}).pipe((0,f.n)(t=>t?t.cancel.lines?.length?this.dataService.order.cancelOrder(t.cancel).pipe((0,v.T)(o=>{const i=o.cancelOrder;switch(i.__typename){case"Order":return this.refetchOrder(i).subscribe(),this.notificationService.success((0,p.x)("order.cancelled-order-items-success"),{count:(0,_.summate)(t.cancel.lines,"quantity")}),t;case"CancelActiveOrderError":case"QuantityTooGreatError":case"MultipleOrderError":case"OrderStateTransitionError":case"EmptyOrderLineSelectionError":return void this.notificationService.error(i.message)}})):[t]:(0,h.of)(void 0)),(0,f.n)(t=>t?t.refunds.length?(0,Le.p)(t.refunds.map(o=>this.dataService.order.refundOrder(o).pipe((0,v.T)(i=>i.refundOrder)))):[void 0]:(0,h.of)(void 0))).subscribe(t=>{for(const o of t??[])if(o)switch(o.__typename){case"Refund":"Failed"===o.state?this.notificationService.error((0,p.x)("order.refund-order-failed")):this.notificationService.success((0,p.x)("order.refund-order-success"));break;case"AlreadyRefundedError":case"NothingToRefundError":case"PaymentOrderMismatchError":case"RefundOrderStateError":case"RefundStateTransitionError":this.notificationService.error(o.message)}this.refetchOrder(t?.[0]).subscribe()})}refetchOrder(n){return this.fetchHistory.next(),n?this.dataService.order.getOrder(this.id).single$:(0,h.of)(void 0)}setFormValues(n){this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n)}static{this.\u0275fac=function(t){return new(t||fe)(e.rXU(e.gRc),e.rXU(a.uSP),e.rXU(a.JEu),e.rXU(a.Bg8),e.rXU(x),e.rXU(d.ok))}}static{this.\u0275cmp=e.VBU({type:fe,selectors:[["vdr-order-detail"]],features:[e.Vt3],decls:5,vars:6,consts:[["cancelOnly",""],[4,"ngIf"],["locationId","order-detail"],["class","button primary mr-1",3,"click",4,"ngIf"],["class","button primary mr-1",3,"disabled","click",4,"ngIf"],["locationId","order-detail",3,"alwaysShow"],["type","button","vdrDropdownItem","",3,"click",4,"ngIf"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"click"],["shape","step-forward-2",1,"is-warning"],[1,"button","primary","mr-1",3,"click"],[1,"button","primary","mr-1",3,"click","disabled"],["shape","pencil"],["shape","error-standard",1,"is-error"],[4,"ngIf","ngIfElse"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["shape","step-forward-2"],[3,"title"],["vdrCardControls",""],[3,"state"],[3,"customer"],["class","mt-2",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],[3,"title",4,"ngIf"],[3,"entity",4,"ngIf"],["class","mb-2",3,"orderId",4,"ngIf"],[3,"paddingX"],[3,"order","orderLineCustomFields"],[3,"title","paddingX"],[1,"table"],[4,"ngFor","ngForOf"],["locationId","order-detail",3,"entity$","detailForm"],[3,"addNote","updateNote","deleteNote","order","history"],[1,"button-small",3,"click","title"],["shape","list"],["class","button-small",3,"title","click",4,"vdrIfPermissions"],["shape","switch"],[1,"mt-2",3,"label"],[1,"mt-1",3,"address"],[3,"label"],[3,"currencyCode","payment","settlePayment","transitionPaymentState","settleRefund",4,"ngFor","ngForOf"],[3,"settlePayment","transitionPaymentState","settleRefund","currencyCode","payment"],[3,"fulfillment","order","transitionState",4,"ngFor","ngForOf"],[3,"transitionState","fulfillment","order"],[3,"entity"],[1,"mb-2",3,"orderId"],["entityName","Order",3,"customFields","customFieldsFormGroup","readonly"],[1,"button","primary",3,"click","disabled"]],template:function(t,o){1&t&&(e.j41(0,"vdr-page-block"),e.DNE(1,Yi,17,12,"vdr-action-bar",1),e.nI1(2,"async"),e.k0s(),e.DNE(3,ea,46,46,"vdr-page-detail-layout",1),e.nI1(4,"async")),2&t&&(e.R7$(),e.Y8G("ngIf",e.bMT(2,2,o.entity$)),e.R7$(2),e.Y8G("ngIf",e.bMT(4,4,o.entity$)))},dependencies:[m.U4n,s.Sq,s.bT,a.nGW,a.wL$,a.TXc,a.lST,a.Eb9,a.Mrl,a.Fam,a.W2r,a.BPu,a.pFL,a.TcB,a.W4C,a.Loz,a.eH4,a.ERS,a.c5c,a.eCv,a.iby,a.aVo,pe,ue,ne,M,ge,s.Jj,s.m1,g.D9,a.Ex,a.pzI,a.uc0],styles:[".shipping-address[_ngcontent-%COMP%]{list-style-type:none;line-height:1.3em}.order-cards[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:6px;color:var(--color-text-200)}vdr-order-payment-card[_ngcontent-%COMP%] + vdr-order-payment-card[_ngcontent-%COMP%]{margin-top:calc(var(--space-unit) * 2)}"],changeDetection:0})}}class B{get adjustedLines(){return(this.modifyOrderInput.adjustOrderLines||[]).map(n=>{const t=this.orderSnapshot.lines.find(o=>o.id===n.orderLineId);if(t){const o=n.quantity-t.quantity;return o?`${0===o?"":o>0?"+":"-"}${Math.abs(o)} ${t.productVariant.name}`:t.productVariant.name}}).filter(_.notNullOrUndefined)}getModifiedFields(n){return n.dirty?Object.entries(n.controls).map(([t,o])=>{if(o.dirty)return t}).filter(_.notNullOrUndefined).join(", "):""}getUpdatedShippingMethodLines(){return Object.entries(this.updatedShippingMethods||{}).map(([n,t])=>{const o=this.orderSnapshot.shippingLines.find(c=>c.id===n);if(!o)return;return`${o.shippingMethod.name||o.shippingMethod.code} -> ${t.name||t.code}`}).filter(_.notNullOrUndefined)}get couponCodeChanges(){const n=this.orderSnapshot.couponCodes||[],t=this.couponCodesControl.value||[];return[...t.filter(l=>!n.includes(l)).map(l=>`+ ${l}`),...n.filter(l=>!t.includes(l)).map(l=>`- ${l}`)]}static{this.\u0275fac=function(t){return new(t||B)}}static{this.\u0275cmp=e.VBU({type:B,selectors:[["vdr-order-modification-summary"]],inputs:{orderSnapshot:"orderSnapshot",modifyOrderInput:"modifyOrderInput",addedLines:"addedLines",shippingAddressForm:"shippingAddressForm",billingAddressForm:"billingAddressForm",updatedShippingMethods:"updatedShippingMethods",couponCodesControl:"couponCodesControl"},decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[4,"ngIf"],[3,"label"],["class","mb-1",4,"ngFor","ngForOf"],[1,"mb-1"],[4,"ngFor","ngForOf"]],template:function(t,o){1&t&&e.DNE(0,na,3,7,"vdr-labeled-data",0)(1,oa,3,7,"vdr-labeled-data",0)(2,aa,3,7,"vdr-labeled-data",0)(3,la,3,4,"vdr-labeled-data",0)(4,da,3,4,"vdr-labeled-data",0)(5,ca,3,4,"vdr-labeled-data",0)(6,ua,2,1,"ng-container",1),2&t&&(e.Y8G("ngIf",null==o.modifyOrderInput.adjustOrderLines?null:o.modifyOrderInput.adjustOrderLines.length),e.R7$(),e.Y8G("ngIf",null==o.modifyOrderInput.addItems?null:o.modifyOrderInput.addItems.length),e.R7$(),e.Y8G("ngIf",null==o.modifyOrderInput.surcharges?null:o.modifyOrderInput.surcharges.length),e.R7$(),e.Y8G("ngIf",o.getModifiedFields(o.shippingAddressForm)),e.R7$(),e.Y8G("ngIf",o.getModifiedFields(o.billingAddressForm)),e.R7$(),e.Y8G("ngIf",o.couponCodeChanges.length),e.R7$(),e.Y8G("ngIf",o.getUpdatedShippingMethodLines()))},dependencies:[s.Sq,s.bT,a.BPu,g.D9,a.uc0],changeDetection:0})}}var y,r;(r=y||(y={}))[r.Refund=0]="Refund",r[r.Payment=1]="Payment",r[r.PriceUnchanged=2]="PriceUnchanged",r[r.Cancel=3]="Cancel";class _e{get priceDifference(){return this.order.totalWithTax-this.orderSnapshot.totalWithTax}get amountToRefundTotal(){return this.refundablePayments.reduce((n,t)=>n+t.amountToRefundControl.value,0)}ngOnInit(){this.refundNote=this.modifyOrderInput.note||"",this.refundablePayments=Ie(this.order.payments||[]),this.refundablePayments.forEach(n=>{n.amountToRefundControl.addValidators(d.k0.max(-1*this.priceDifference))}),this.priceDifference<0&&this.refundablePayments.length&&this.onPaymentSelected(this.refundablePayments[0],!0)}onPaymentSelected(n,t){if(t){const o=-1*this.priceDifference-this.refundablePayments.filter(i=>i.id!==n.id).reduce((i,l)=>i+l.amountToRefundControl.value,0);0<o&&n.amountToRefundControl.setValue(Math.min(o,n.refundableAmount))}else n.amountToRefundControl.setValue(0)}refundsCoverDifference(){return-1*this.priceDifference===this.amountToRefundTotal}cancel(){this.resolveWith({result:y.Cancel})}submit(){0<this.priceDifference?this.resolveWith({result:y.Payment}):this.priceDifference<0?this.resolveWith({result:y.Refund,refunds:this.refundablePayments.filter(n=>n.selected&&0<n.amountToRefundControl.value).map(n=>({reason:this.refundNote||this.modifyOrderInput.note,paymentId:n.id,amount:n.amountToRefundControl.value}))}):this.resolveWith({result:y.PriceUnchanged})}static{this.\u0275fac=function(t){return new(t||_e)}}static{this.\u0275cmp=e.VBU({type:_e,selectors:[["vdr-order-edits-preview-dialog"]],decls:14,vars:18,consts:[["vdrDialogTitle",""],[1,"order-edits-preview-table",3,"order","orderLineCustomFields"],[1,"payments-wrapper","mb-2"],[1,"flex-spacer"],["class","",3,"refundablePayments","order","paymentSelected",4,"ngIf"],[3,"title"],[3,"orderSnapshot","modifyOrderInput","addedLines","shippingAddressForm","billingAddressForm","couponCodesControl","updatedShippingMethods"],[3,"label"],[3,"label",4,"ngIf"],["vdrDialogButtons",""],[1,"",3,"paymentSelected","refundablePayments","order"],["name","refundNote","required","",3,"ngModelChange","ngModel"],[1,"errors"],["class","mb-1",3,"clrAlertType","clrAlertClosable",4,"ngIf"],[1,"modal-buttons"],[1,"",3,"clrAlertType","clrAlertClosable"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],[1,"mb-1",3,"clrAlertType","clrAlertClosable"]],template:function(t,o){1&t&&(e.DNE(0,ga,2,3,"ng-template",0),e.nrm(1,"vdr-order-table",1),e.j41(2,"div",2)(3,"div",3),e.DNE(4,fa,1,2,"vdr-payment-for-refund-selector",4),e.k0s(),e.j41(5,"div",3)(6,"vdr-card",5),e.nI1(7,"translate"),e.nrm(8,"vdr-order-modification-summary",6),e.j41(9,"vdr-labeled-data",7),e.nI1(10,"translate"),e.EFF(11),e.k0s(),e.DNE(12,_a,3,4,"vdr-form-field",8),e.k0s()()(),e.DNE(13,va,15,18,"ng-template",9)),2&t&&(e.R7$(),e.Y8G("order",o.order)("orderLineCustomFields",o.orderLineCustomFields),e.R7$(3),e.Y8G("ngIf",o.priceDifference<0),e.R7$(2),e.Y8G("title",e.bMT(7,14,"order.modify-order")),e.R7$(2),e.Y8G("orderSnapshot",o.orderSnapshot)("modifyOrderInput",o.modifyOrderInput)("addedLines",o.addedLines)("shippingAddressForm",o.shippingAddressForm)("billingAddressForm",o.billingAddressForm)("couponCodesControl",o.couponCodesControl)("updatedShippingMethods",o.updatedShippingMethods),e.R7$(),e.Y8G("label",e.bMT(10,16,"order.note")),e.R7$(2),e.SpI(" ",o.modifyOrderInput.note||"-"," "),e.R7$(),e.Y8G("ngIf",o.priceDifference<0))},dependencies:[m.k8k,m.Bw1,s.bT,d.me,d.BC,d.YS,d.vS,a.KSf,a.Vr5,a.bc3,a.MCd,a.BPu,a.iby,M,V,B,g.D9,a.uc0],styles:[".order-edits-preview-table .table-wrapper{max-width:initial!important}.payments-wrapper[_ngcontent-%COMP%]{display:flex;gap:calc(var(--space-unit) * 2)}.modal-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.6rem;gap:var(--clr-modal-footer-gap, .6rem)}"],changeDetection:0})}}class he extends a.wi7{constructor(n,t,o,i,l){super(),this.dataService=n,this.notificationService=t,this.modalService=o,this.orderTransitionService=i,this.changeDetectorRef=l,this.detailForm=new d.J3({}),this.couponCodesControl=new d.MJ([]),this.modifyOrderInput={dryRun:!0,orderId:"",addItems:[],adjustOrderLines:[],surcharges:[],note:"",refunds:[],updateShippingAddress:{},updateBillingAddress:{}},this.surchargeForm=new d.gE({description:new d.MJ("",d.k0.minLength(1)),sku:new d.MJ(""),price:new d.MJ(0),priceIncludesTax:new d.MJ(!0),taxRate:new d.MJ(0),taxDescription:new d.MJ("")}),this.shippingAddressForm=new d.gE({fullName:new d.MJ(""),company:new d.MJ(""),streetLine1:new d.MJ(""),streetLine2:new d.MJ(""),city:new d.MJ(""),province:new d.MJ(""),postalCode:new d.MJ(""),countryCode:new d.MJ(""),phoneNumber:new d.MJ("")}),this.billingAddressForm=new d.gE({fullName:new d.MJ(""),company:new d.MJ(""),streetLine1:new d.MJ(""),streetLine2:new d.MJ(""),city:new d.MJ(""),province:new d.MJ(""),postalCode:new d.MJ(""),countryCode:new d.MJ(""),phoneNumber:new d.MJ("")}),this.note="",this.recalculateShipping=!0,this.editingShippingAddress=!1,this.editingBillingAddress=!1,this.updatedShippingMethods={},this.addedVariants=new Map}ngOnInit(){this.init(),this.addressCustomFields=this.getCustomFieldConfig("Address"),this.modifyOrderInput.orderId=this.route.snapshot.paramMap.get("id"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.entity$.pipe((0,F.s)(1)).subscribe(n=>{this.orderSnapshot=this.createOrderSnapshot(n),n.couponCodes.length&&this.couponCodesControl.setValue(n.couponCodes),this.surchargeForm.reset();for(const[t,o]of Object.entries(this.shippingAddressForm.controls))o.setValue(n.shippingAddress?.[t]);this.addAddressCustomFieldsFormGroup(this.shippingAddressForm,n.shippingAddress);for(const[t,o]of Object.entries(this.billingAddressForm.controls))o.setValue(n.billingAddress?.[t]);this.addAddressCustomFieldsFormGroup(this.billingAddressForm,n.billingAddress),this.orderLineCustomFieldsFormArray=new d.Bm([]);for(const t of n.lines){const o=new d.J3({});for(const{name:i}of this.orderLineCustomFields)o.addControl(i,new d.hs(t.customFields[i]));o.valueChanges.pipe((0,Ge.Q)(this.destroy$)).subscribe(i=>{let l=this.modifyOrderInput.adjustOrderLines.find(c=>c.orderLineId===t.id);l||(l={orderLineId:t.id,quantity:t.quantity},this.modifyOrderInput.adjustOrderLines.push(l)),this.orderLineCustomFields.length&&(l.customFields=i)}),this.orderLineCustomFieldsFormArray.push(o)}}),this.addItemCustomFieldsFormArray=new d.Bm([]),this.addItemCustomFieldsForm=new d.J3({});for(const n of this.orderLineCustomFields)this.addItemCustomFieldsForm.addControl(n.name,new d.hs);this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(n=>n.countries.items).pipe((0,Ue.t)(1)),this.dataService.order.getOrderHistory(this.id,{take:1,sort:{createdAt:a.xBQ.DESC},filter:{type:{eq:a.Htj.ORDER_STATE_TRANSITION}}}).single$.subscribe(({order:n})=>{this.previousState=n?.history.items[0].data.from}),this.uiLanguage$=this.dataService.client.uiState().stream$.pipe((0,v.T)(({uiState:n})=>n.language))}ngOnDestroy(){this.destroy()}get addedLines(){const n=t=>"SinglePrice"===t.__typename?t.value:0;return(this.modifyOrderInput.addItems||[]).map(t=>{const o=this.addedVariants.get(t.productVariantId);if(o)return{id:this.getIdForAddedItem(t),featuredAsset:o.productAsset,productVariant:{id:o.productVariantId,name:o.productVariantName,sku:o.sku},unitPrice:n(o.price),unitPriceWithTax:n(o.priceWithTax),quantity:t.quantity}}).filter(_.notNullOrUndefined)}getIdForAddedItem(n){return`added-${n.productVariantId}-${JSON.stringify(n.customFields||{})}`}transitionToPriorState(n){this.orderTransitionService.transitionToPreModifyingState(n.id,n.nextStates).subscribe(t=>{this.router.navigate([".."],{relativeTo:this.route})})}hasModifications(){const{addItems:n,adjustOrderLines:t,surcharges:o}=this.modifyOrderInput;return!!n?.length||!!o?.length||!!t?.length||this.shippingAddressForm.dirty&&this.shippingAddressForm.valid||this.billingAddressForm.dirty&&this.billingAddressForm.valid||this.couponCodesControl.dirty||Object.entries(this.updatedShippingMethods).length>0}isLineModified(n){return!!this.modifyOrderInput.adjustOrderLines?.find(t=>t.orderLineId===n.id&&t.quantity!==n.quantity)}getInitialLineQuantity(n){const t=this.modifyOrderInput.adjustOrderLines?.find(l=>l.orderLineId===n);if(t)return t.quantity;const o=this.modifyOrderInput.addItems?.find(l=>this.getIdForAddedItem(l)===n);if(o)return o.quantity??1;const i=this.orderSnapshot.lines.find(l=>l.id===n);return i?i.quantity:1}updateLineQuantity(n,t){const{adjustOrderLines:o}=this.modifyOrderInput;if(this.isAddedLine(n)){const i=this.modifyOrderInput.addItems?.find(l=>l.productVariantId===n.productVariant.id);i&&(i.quantity=+t)}else{let i=o?.find(l=>l.orderLineId===n.id);i&&+t===n.quantity&&o?.splice(o?.indexOf(i),1),i||(i={orderLineId:n.id,quantity:+t},o?.push(i)),i.quantity=+t}}isAddedLine(n){return n.id.startsWith("added-")}updateAddedItemQuantity(n,t){const o=this.modifyOrderInput.addItems?.find(i=>i.productVariantId===n.productVariant.id);o&&(o.quantity=+t)}trackByProductVariantId(n,t){return t.productVariant.id}getSelectedItemPrice(n){return"SinglePrice"===n?.priceWithTax.__typename?n.priceWithTax.value:0}addItemToOrder(n){if(!n)return;const t=this.orderLineCustomFields.length?this.addItemCustomFieldsForm.value:void 0;let o=this.modifyOrderInput.addItems?.find(i=>this.isMatchingAddItemRow(i,n,t));if(o?o.quantity++:(o={productVariantId:n.productVariantId,quantity:1},t&&(o.customFields=t),this.modifyOrderInput.addItems?.push(o)),t){const i=new d.J3({});for(const[l,c]of Object.entries(t))i.addControl(l,new d.hs(c));this.addItemCustomFieldsFormArray.push(i),i.valueChanges.pipe((0,Ge.Q)(this.destroy$)).subscribe(l=>{o&&(o.customFields=l)})}this.addItemCustomFieldsForm.reset({}),this.addItemSelectedVariant=void 0,this.addedVariants.set(n.productVariantId,n)}getShippingLineDetails(n){const t=this.updatedShippingMethods[n.id];return t?{name:t.name||t.code,price:t.priceWithTax}:{name:n.shippingMethod.name||n.shippingMethod.code,price:n.discountedPriceWithTax}}setShippingMethod(n){const t=this.updatedShippingMethods[n]??this.entity?.shippingLines.find(o=>o.id===n)?.shippingMethod;t&&this.dataService.order.getDraftOrderEligibleShippingMethods(this.id).mapSingle(({eligibleShippingMethodsForDraftOrder:o})=>o).pipe((0,f.n)(o=>this.modalService.fromComponent(w,{locals:{eligibleShippingMethods:o,currencyCode:this.entity?.currencyCode,currentSelectionId:t.id}}).pipe((0,v.T)(i=>{if(i)return o.find(l=>l.id===i)})))).subscribe(o=>{o&&(this.updatedShippingMethods[n]=o,this.changeDetectorRef.markForCheck())})}isMatchingAddItemRow(n,t,o){return n.productVariantId===t.productVariantId&&JSON.stringify(n.customFields)===JSON.stringify(o)}removeAddedItem(n){this.modifyOrderInput.addItems=this.modifyOrderInput.addItems?.filter(t=>this.getIdForAddedItem(t)!==n)}getSurchargePrices(n){const t=n.priceIncludesTax?n.price:Math.round(n.price*((100+(n.taxRate||0))/100));return{price:n.priceIncludesTax?Math.round(n.price/((100+(n.taxRate||0))/100)):n.price,priceWithTax:t}}addSurcharge(n){this.modifyOrderInput.surcharges?.push(n),this.surchargeForm.reset({price:0,priceIncludesTax:!0,taxRate:0})}removeSurcharge(n){this.modifyOrderInput.surcharges?.splice(n,1)}previewAndModify(n){const o={...{...this.modifyOrderInput,adjustOrderLines:this.modifyOrderInput.adjustOrderLines.map(i=>(0,a.xo)((0,We.q)(i),this.orderLineCustomFields))},...this.billingAddressForm.dirty?{updateBillingAddress:this.billingAddressForm.value}:{},...this.shippingAddressForm.dirty?{updateShippingAddress:this.shippingAddressForm.value}:{},dryRun:!0,couponCodes:this.couponCodesControl.dirty?this.couponCodesControl.value:void 0,note:this.note??"",options:{recalculateShipping:this.recalculateShipping}};Object.entries(this.updatedShippingMethods).length&&(o.shippingMethodIds=n.shippingLines.map(i=>this.updatedShippingMethods[i.id]?this.updatedShippingMethods[i.id].id:i.shippingMethod.id)),this.dataService.order.modifyOrder(o).pipe((0,f.n)(({modifyOrder:i})=>{switch(i.__typename){case"Order":return this.modalService.fromComponent(_e,{size:"xl",closable:!1,locals:{order:i,orderSnapshot:this.orderSnapshot,orderLineCustomFields:this.orderLineCustomFields,modifyOrderInput:o,addedLines:this.addedLines,shippingAddressForm:this.shippingAddressForm,billingAddressForm:this.billingAddressForm,couponCodesControl:this.couponCodesControl,updatedShippingMethods:this.updatedShippingMethods}});case"InsufficientStockError":case"NegativeQuantityError":case"NoChangesSpecifiedError":case"OrderLimitError":case"OrderModificationStateError":case"PaymentMethodMissingError":case"RefundPaymentIdMissingError":case"CouponCodeLimitError":case"CouponCodeExpiredError":case"IneligibleShippingMethodError":case"CouponCodeInvalidError":return this.notificationService.error(i.message),(0,h.of)(!1);case null:case void 0:return(0,h.of)(!1);default:(0,_.assertNever)(i)}}),(0,f.n)(i=>{if(!i||i.result===y.Cancel)return this.dataService.order.getOrder(this.id).mapSingle(()=>!1);{const l={...o,dryRun:!1};return i.result===y.Refund&&(l.refunds=i.refunds),this.dataService.order.modifyOrder(l).pipe((0,f.n)(({modifyOrder:c})=>{if("Order"===c.__typename){const Fe=0<c.totalWithTax-this.orderSnapshot.totalWithTax?"ArrangingAdditionalPayment":this.previousState;return this.dataService.order.transitionToState(n.id,Fe).pipe((0,De.u)(!0))}return this.notificationService.error(c.message),T.w}))}})).subscribe(i=>{i&&this.router.navigate(["../"],{relativeTo:this.route})})}addAddressCustomFieldsFormGroup(n,t){if(t&&this.addressCustomFields.length){const o=new d.J3({});for(const i of this.addressCustomFields){const l=i.name,c=t.customFields?.[l];o.addControl(l,new d.hs(c))}n.addControl("customFields",o)}}createOrderSnapshot(n){return{totalWithTax:n.totalWithTax,currencyCode:n.currencyCode,couponCodes:n.couponCodes,lines:[...n.lines].map(t=>({...t})),shippingLines:[...n.shippingLines].map(t=>({...t}))}}setFormValues(n,t){}static{this.\u0275fac=function(t){return new(t||he)(e.rXU(a.uSP),e.rXU(a.JEu),e.rXU(a.Bg8),e.rXU(x),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:he,selectors:[["vdr-order-editor"]],features:[e.Vt3],decls:4,vars:4,consts:[["imagePlaceholder",""],[4,"ngIf"],[1,"flex","clr-align-items-center"],[1,"btn","btn-secondary",3,"click"],[3,"title"],[3,"orderSnapshot","modifyOrderInput","addedLines","shippingAddressForm","billingAddressForm","couponCodesControl","updatedShippingMethods"],["class","no-modifications",4,"ngIf"],[1,"summary-controls"],[3,"label"],["name","note","required","",3,"ngModelChange","ngModel","disabled"],[1,"flex","items-center"],["type","checkbox",3,"ngModelChange","ngModel","disabled"],[1,"ml-1"],[1,"btn","btn-primary","mt-2",3,"click","disabled"],[3,"control"],["vdrCardControls",""],[3,"address",4,"ngIf"],[3,"formGroup","availableCountries","customFields",4,"ngIf"],[3,"paddingX"],["id","modify-order",1,"order-table",3,"items"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","image",3,"heading"],["id","product-name",3,"heading","optional"],["id","product-sku",3,"heading"],["id","unit-price",3,"heading"],["id","quantity",3,"heading","optional"],[3,"id","heading","hiddenByDefault",4,"ngFor","ngForOf"],[1,"mb-4",3,"productSelected"],[1,"flex"],["class","flex mb-4",4,"ngIf"],["class","form-grid",4,"ngIf"],[1,"flex-spacer"],["class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["class","flex items-center",4,"ngFor","ngForOf"],[3,"submit","formGroup"],[1,"form-grid"],["for","description",3,"label"],["id","description","type","text","formControlName","description"],["for","sku",3,"label"],["id","sku","type","text","formControlName","sku"],["for","price",3,"label"],["id","price","formControlName","price",3,"currencyCode"],["for","priceIncludesTax",3,"label"],["id","priceIncludesTax","type","checkbox","clrCheckbox","","formControlName","priceIncludesTax"],["for","taxRate",3,"label"],["suffix","%"],["id","taxRate","type","number","min","0","max","100","formControlName","taxRate"],["for","taxDescription",3,"label"],["id","taxDescription","type","text","formControlName","taxDescription"],[1,"btn","btn-secondary","mt-2",3,"disabled"],[1,"no-modifications"],[1,"button-small",3,"click","title"],["shape","edit"],[3,"address"],[3,"formGroup","availableCountries","customFields"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],[3,"src"],[1,"placeholder"],["shape","image","size","48"],[1,"text-center"],[1,"net-price",3,"title"],["type","number","min","0",1,"draft-qty","mr-1",3,"input","value"],["class","button-small",3,"click",4,"ngIf"],[3,"line","payments"],[3,"line","allOrderFulfillments","orderState"],[1,"button-small",3,"click"],["shape","trash"],[3,"id","heading","hiddenByDefault"],[3,"compact","entityName","customField","customFieldsFormGroup"],[1,"flex","mb-4"],["class","mr-4 add-item-thumb",3,"src",4,"ngIf"],[1,"mr-4"],[1,"mr-4","add-item-thumb",3,"src"],[4,"ngFor","ngForOf"],["entityName","OrderLine",3,"readonly","customField","customFieldsFormGroup","compact"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"mx-1"]],template:function(t,o){1&t&&(e.j41(0,"vdr-page-block"),e.DNE(1,ya,7,3,"vdr-action-bar",1),e.nI1(2,"async"),e.k0s(),e.DNE(3,Ja,98,111,"vdr-page-detail-layout",1)),2&t&&(e.R7$(),e.Y8G("ngIf",e.bMT(2,2,o.entity$)),e.R7$(2),e.Y8G("ngIf",o.entity))},dependencies:[m.U4n,m.aZZ,m.Jej,s.Sq,s.bT,d.qT,d.me,d.Q0,d.Zm,d.BC,d.cb,d.YS,d.VZ,d.zX,d.vS,d.j4,d.JD,a.nGW,a.wL$,a.TXc,a.Rj_,a.Juh,a.Cd_,a.KSf,a.Vr5,a.W2r,a.hJF,a.O6k,a.IMU,a.Y9G,a.eH4,a.c5c,a.eCv,a.iby,a.aVo,N,R,P,B,s.Jj,g.D9,a._yO,a.HlS,a.PU$,a.uc0],styles:[".order-table[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}.order-table[_ngcontent-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}.order-table[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}.order-table[_ngcontent-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}.order-table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}.order-table[_ngcontent-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}.order-table[_ngcontent-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}.order-table[_ngcontent-%COMP%]   .promotions-label[_ngcontent-%COMP%]{text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}.order-table[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}.order-table[_ngcontent-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}.order-table[_ngcontent-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}.order-table[_ngcontent-%COMP%]   tr.modified[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-warning-100)}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{text-align:start}.add-item-thumb[_ngcontent-%COMP%]{max-width:50px}.no-modifications[_ngcontent-%COMP%]{color:var(--color-grey-400)}.summary-controls[_ngcontent-%COMP%]{border-top:1px solid var(--color-weight-200);margin-top:calc(var(--space-unit) * 2);padding-top:calc(var(--space-unit) * 1)}"],changeDetection:0})}}class ve extends a.B8I{constructor(n,t){super(),this.serverConfigService=n,this.channelService=t,this.dataTableListId="order-list",this.orderStates=this.serverConfigService.getOrderProcessStates().map(o=>o.name),this.OrderType=a.ZNd,this.customFields=this.getCustomFieldConfig("Order"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilter({name:"active",type:{kind:"boolean"},label:(0,p.x)("order.filter-is-active"),filterField:"active"}).addFilter({name:"totalWithTax",type:{kind:"number",inputType:"currency",currencyCode:"USD"},label:(0,p.x)("order.total"),filterField:"totalWithTax"}).addFilter({name:"state",type:{kind:"select",options:this.orderStates.map(o=>({value:o,label:(0,a.oS5)(o)}))},label:(0,p.x)("order.state"),filterField:"state"}).addFilter({name:"type",type:{kind:"select",options:[{value:a.ZNd.Regular,label:(0,p.x)("order.order-type-regular")},{value:a.ZNd.Aggregate,label:(0,p.x)("order.order-type-aggregate")},{value:a.ZNd.Seller,label:(0,p.x)("order.order-type-seller")}]},label:(0,p.x)("order.order-type"),filterField:"type"}).addFilter({name:"orderPlacedAt",type:{kind:"dateRange"},label:(0,p.x)("order.placed-at"),filterField:"orderPlacedAt"}).addFilter({name:"customerLastName",type:{kind:"text"},label:(0,p.x)("customer.last-name"),filterField:"customerLastName"}).addFilter({name:"transactionId",type:{kind:"text"},label:(0,p.x)("order.transaction-id"),filterField:"transactionId"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("updatedAt","DESC").addSort({name:"id"}).addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"orderPlacedAt"}).addSort({name:"customerLastName"}).addSort({name:"state"}).addSort({name:"totalWithTax"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),this.canCreateDraftOrder=!1,this.activeChannelIsDefaultChannel=!1,super.configure({document:a.GQq,getItems:o=>o.orders,setVariables:(o,i)=>this.createQueryOptions(o,i,this.searchTermControl.value),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]}),this.canCreateDraftOrder=!!this.serverConfigService.getOrderProcessStates().find(o=>"Created"===o.name)?.to.includes("Draft")}ngOnInit(){super.ngOnInit();const n=this.channelService.defaultChannelIsActive$.pipe((0,U.M)(t=>this.activeChannelIsDefaultChannel=t));super.refreshListOnChanges(this.filters.valueChanges,this.sorts.valueChanges,n)}createQueryOptions(n,t,o){let i=this.filters.createFilterInput();return this.activeChannelIsDefaultChannel&&(i={...i??{}}),o&&(i={code:{contains:o},customerLastName:{contains:o},transactionId:{contains:o}}),{options:{skip:n,take:t,filter:{...i??{}},filterOperator:o?a.umn.OR:a.umn.AND,sort:this.sorts.createSortInput()}}}getShippingNames(n){return n.shippingLines.length?n.shippingLines.map(t=>t.shippingMethod.name).join(", "):""}static{this.\u0275fac=function(t){return new(t||ve)(e.rXU(a.BBL),e.rXU(a.lhn))}}static{this.\u0275cmp=e.VBU({type:ve,selectors:[["vdr-order-list"]],features:[e.Vt3],decls:45,vars:61,consts:[["locationId","order-list"],[4,"ngIf"],[1,"mt-2",3,"pageChange","itemsPerPageChange","visibleColumnsChange","id","items","itemsPerPage","totalItems","currentPage","filters"],["locationId","order-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault","sort"],["id","created-at",3,"heading","hiddenByDefault"],["id","code",3,"heading","optional"],["id","customer",3,"heading","sort"],["id","order-type",3,"heading","hiddenByDefault"],["id","state",3,"heading","sort"],["id","total",3,"heading","sort"],["id","updated-at",3,"heading"],["id","placed-at",3,"heading","sort"],["id","shipping",3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],["class","btn",3,"routerLink",4,"vdrIfPermissions"],[1,"btn",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"click","customer"],[3,"state"],[3,"customField","sorts"]],template:function(t,o){1&t&&(e.j41(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-right"),e.nrm(3,"vdr-action-bar-items",0),e.DNE(4,el,2,2,"ng-container",1),e.nrm(5,"vdr-action-bar-dropdown-menu",0),e.k0s()()(),e.j41(6,"vdr-data-table-2",2),e.nI1(7,"async"),e.nI1(8,"async"),e.nI1(9,"async"),e.nI1(10,"async"),e.bIt("pageChange",function(l){return o.setPageNumber(l)})("itemsPerPageChange",function(l){return o.setItemsPerPage(l)})("visibleColumnsChange",function(l){return o.setVisibleColumns(l)}),e.nrm(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.nI1(13,"translate"),e.j41(14,"vdr-dt2-column",5),e.nI1(15,"translate"),e.DNE(16,tl,1,1,"ng-template"),e.k0s(),e.j41(17,"vdr-dt2-column",6),e.nI1(18,"translate"),e.DNE(19,nl,2,4,"ng-template"),e.k0s(),e.j41(20,"vdr-dt2-column",7),e.nI1(21,"translate"),e.DNE(22,rl,4,6,"ng-template"),e.k0s(),e.j41(23,"vdr-dt2-column",8),e.nI1(24,"translate"),e.DNE(25,ol,1,1,"ng-template"),e.k0s(),e.j41(26,"vdr-dt2-column",9),e.nI1(27,"translate"),e.DNE(28,dl,3,3,"ng-template"),e.k0s(),e.j41(29,"vdr-dt2-column",10),e.nI1(30,"translate"),e.DNE(31,sl,1,1,"ng-template"),e.k0s(),e.j41(32,"vdr-dt2-column",11),e.nI1(33,"translate"),e.DNE(34,cl,2,4,"ng-template"),e.k0s(),e.j41(35,"vdr-dt2-column",12),e.nI1(36,"translate"),e.DNE(37,pl,2,3,"ng-template"),e.k0s(),e.j41(38,"vdr-dt2-column",13),e.nI1(39,"translate"),e.DNE(40,ml,2,4,"ng-template"),e.k0s(),e.j41(41,"vdr-dt2-column",14),e.nI1(42,"translate"),e.DNE(43,ul,1,1,"ng-template"),e.k0s(),e.DNE(44,gl,1,2,"vdr-dt2-custom-field-column",15),e.k0s()),2&t&&(e.R7$(4),e.Y8G("ngIf",o.canCreateDraftOrder),e.R7$(2),e.Y8G("id",o.dataTableListId)("items",e.bMT(7,31,o.items$))("itemsPerPage",e.bMT(8,33,o.itemsPerPage$))("totalItems",e.bMT(9,35,o.totalItems$))("currentPage",e.bMT(10,37,o.currentPage$))("filters",o.filters),e.R7$(5),e.Y8G("hostComponent",o)("selectionManager",o.selectionManager),e.R7$(),e.Y8G("searchTermControl",o.searchTermControl)("searchTermPlaceholder",e.bMT(13,39,"order.search-by-order-filters")),e.R7$(2),e.Y8G("heading",e.bMT(15,41,"common.id"))("hiddenByDefault",!0)("sort",o.sorts.get("id")),e.R7$(3),e.Y8G("heading",e.bMT(18,43,"common.created-at"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(21,45,"common.code"))("optional",!1),e.R7$(3),e.Y8G("heading",e.bMT(24,47,"order.customer"))("sort",o.sorts.get("customerLastName")),e.R7$(3),e.Y8G("heading",e.bMT(27,49,"order.order-type"))("hiddenByDefault",!0),e.R7$(3),e.Y8G("heading",e.bMT(30,51,"order.state"))("sort",o.sorts.get("state")),e.R7$(3),e.Y8G("heading",e.bMT(33,53,"order.total"))("sort",o.sorts.get("totalWithTax")),e.R7$(3),e.Y8G("heading",e.bMT(36,55,"common.updated-at")),e.R7$(3),e.Y8G("heading",e.bMT(39,57,"order.placed-at"))("sort",o.sorts.get("orderPlacedAt")),e.R7$(3),e.Y8G("heading",e.bMT(42,59,"order.shipping")),e.R7$(3),e.Y8G("ngForOf",o.customFields))},dependencies:[m.U4n,s.Sq,s.bT,b.Wk,a.nGW,a.TXc,a.lST,a.wux,a.Eb9,a.Fam,a.pFL,a.TcB,a.T0b,a.IMU,a.Y9G,a.E8Q,a.TnO,a.eH4,s.Jj,g.D9,a.nnP,a.PU$,a.uc0],styles:[".search-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:baseline;width:100%;max-width:100vw;margin-bottom:6px}.filter-presets[_ngcontent-%COMP%]{max-width:90vw;overflow-x:auto}.search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}.custom-filters[_ngcontent-%COMP%]{overflow:hidden;max-height:0;padding-bottom:6px}.custom-filters.expanded[_ngcontent-%COMP%]{max-height:initial}.custom-filters[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.custom-filters[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%}ng-select[_ngcontent-%COMP%]{flex:1;min-width:200px;height:36px}ng-select[_ngcontent-%COMP%]     .ng-select-container{height:36px}"],changeDetection:0})}}class be{static{this.\u0275fac=function(t){return new(t||be)}}static{this.\u0275cmp=e.VBU({type:be,selectors:[["vdr-refund-detail"]],inputs:{refund:"refund",currencyCode:"currencyCode"},decls:8,vars:12,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"value"]],template:function(t,o){1&t&&(e.j41(0,"vdr-labeled-data",0),e.nI1(1,"translate"),e.EFF(2),e.nI1(3,"localeCurrency"),e.k0s(),e.DNE(4,fl,3,4,"vdr-labeled-data",1),e.j41(5,"vdr-labeled-data",0),e.nI1(6,"translate"),e.nrm(7,"vdr-object-tree",2),e.k0s()),2&t&&(e.Y8G("label",e.bMT(1,5,"order.amount")),e.R7$(2),e.SpI(" ",e.i5U(3,7,o.refund.total,o.currencyCode),"\n"),e.R7$(2),e.Y8G("ngIf",o.refund.transactionId),e.R7$(),e.Y8G("label",e.bMT(6,10,"order.payment-metadata")),e.R7$(2),e.Y8G("value",o.refund.metadata))},dependencies:[s.bT,a.BPu,a.TJf,g.D9,a.uc0],changeDetection:0})}}const bl=O.J1`
    query GetCustomerAddresses($customerId: ID!) {
        customer(id: $customerId) {
            id
            addresses {
                ...Address
            }
        }
    }
    ${a.QZS}
`,Ne=O.J1`
    query GetOrderState($id: ID!) {
        order(id: $id) {
            id
            state
        }
    }
`;class C{constructor(n,t){this.dataService=n,this.router=t}canActivate(n,t){const o=t.url.includes("orders/draft"),i=t.url.includes("/modify"),l=n.paramMap.get("id");return o?"create"!==l||this.dataService.order.createDraftOrder().pipe((0,v.T)(({createDraftOrder:c})=>this.router.parseUrl(`/orders/draft/${c.id}`))):this.dataService.query(Ne,{id:l}).single$.pipe((0,v.T)(({order:c})=>!("Modifying"===c?.state&&!i)||this.router.parseUrl(`/orders/${l}/modify`)))}static{this.\u0275fac=function(t){return new(t||C)(e.KVO(a.uSP),e.KVO(b.Ix))}}static{this.\u0275prov=e.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}}const Ae=r=>[{path:"",component:a.H1b,pathMatch:"full",data:{locationId:"order-list",breadcrumb:(0,p.x)("breadcrumb.orders")},children:r.getPageTabRoutes("order-list")},{path:"draft/:id",component:a.H1b,canActivate:[C],data:{locationId:"draft-order-detail",breadcrumb:{label:(0,p.x)("breadcrumb.orders"),link:["../"]}},children:r.getPageTabRoutes("draft-order-detail")},{path:":id",component:a.H1b,canActivate:[C],data:{locationId:"order-detail",breadcrumb:{label:(0,p.x)("breadcrumb.orders"),link:["../"]}},children:r.getPageTabRoutes("order-detail")},{path:":aggregateOrderId/seller-orders/:id",component:a.H1b,canActivate:[C],data:{locationId:"order-detail",breadcrumb:{label:(0,p.x)("breadcrumb.orders"),link:["../"]}},children:r.getPageTabRoutes("order-detail")},{path:":id/modify",component:a.H1b,canActivate:[C],data:{locationId:"modify-order",breadcrumb:{label:(0,p.x)("breadcrumb.orders"),link:["../"]}},children:r.getPageTabRoutes("modify-order")}];class q{static{this.hasRegisteredTabsAndBulkActions=!1}constructor(n){q.hasRegisteredTabsAndBulkActions||(n.registerPageTab({priority:0,location:"order-list",tab:(0,p.x)("order.orders"),route:"",component:ve}),n.registerPageTab({priority:0,location:"order-detail",tab:(0,p.x)("order.order"),route:"",component:(0,a.HL6)({component:fe,query:a.dRq,entityKey:"order",getBreadcrumbs:t=>t?.type===a.ZNd.Seller&&t?.aggregateOrder?[{label:`${t?.aggregateOrder?.code}`,link:["/orders/",t?.aggregateOrder?.id]},{label:(0,p.x)("breadcrumb.seller-orders"),link:["/orders/",t?.aggregateOrder?.id]},{label:`${t?.code}`,link:[t?.id]}]:[{label:`${t?.code}`,link:[t?.id]}]})}),n.registerPageTab({priority:0,location:"draft-order-detail",tab:(0,p.x)("order.order"),route:"",component:(0,a.HL6)({component:K,query:a.dRq,entityKey:"order",getBreadcrumbs:t=>[{label:(0,p.x)("order.draft-order"),link:[t?.id]}]})}),n.registerPageTab({priority:0,location:"modify-order",tab:(0,p.x)("order.order"),route:"",component:(0,a.HL6)({component:he,query:a.dRq,entityKey:"order",getBreadcrumbs:t=>[{label:t?.code||"order",link:["/orders/",t?.id]},{label:(0,p.x)("breadcrumb.modifying-order"),link:[t?.id]}]})}),q.hasRegisteredTabsAndBulkActions=!0)}static{this.\u0275fac=function(t){return new(t||q)(e.KVO(a.bPm))}}static{this.\u0275mod=e.$C({type:q})}static{this.\u0275inj=e.G2t({providers:[{provide:b.bw,useFactory:n=>Ae(n),multi:!0,deps:[a.bPm]}],imports:[a.GgS,b.iI.forChild([])]})}}}}]);
//# sourceMappingURL=870.872d8c865c7c7f4f.js.map